{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://skillstore.io/schemas/skill-report.schema.json",
  "title": "Skill Report",
  "description": "Schema for AI-generated skill-report.json containing security audit and content",
  "type": "object",
  "required": ["meta", "security_audit", "content"],
  "properties": {
    "meta": {
      "type": "object",
      "required": ["generated_at", "model"],
      "properties": {
        "generated_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of report generation"
        },
        "model": {
          "type": "string",
          "description": "AI model used for analysis (e.g., gpt-4-turbo)"
        },
        "source_url": {
          "type": "string",
          "format": "uri",
          "description": "Original source repository URL"
        },
        "source_ref": {
          "type": "string",
          "description": "Git commit SHA or tag of analyzed version"
        },
        "analysis_version": {
          "type": "string",
          "description": "Version of the analysis pipeline"
        }
      }
    },
    "security_audit": {
      "type": "object",
      "required": ["risk_level", "safe_to_publish"],
      "properties": {
        "risk_level": {
          "type": "string",
          "enum": ["safe", "low", "medium", "high", "critical", "blocked"],
          "description": "Overall security risk assessment"
        },
        "is_blocked": {
          "type": "boolean",
          "default": false,
          "description": "Whether publication is blocked due to security concerns"
        },
        "safe_to_publish": {
          "type": "boolean",
          "description": "Final recommendation for publication"
        },
        "summary": {
          "type": "string",
          "maxLength": 1000,
          "description": "Human-readable security summary"
        },
        "critical_findings": {
          "type": "array",
          "items": { "$ref": "#/$defs/finding" },
          "description": "Critical security issues that block publication"
        },
        "high_findings": {
          "type": "array",
          "items": { "$ref": "#/$defs/finding" },
          "description": "High severity security issues"
        },
        "medium_findings": {
          "type": "array",
          "items": { "$ref": "#/$defs/finding" },
          "description": "Medium severity security issues"
        },
        "low_findings": {
          "type": "array",
          "items": { "$ref": "#/$defs/finding" },
          "description": "Low severity security issues or suggestions"
        },
        "files_scanned": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of files analyzed"
        },
        "total_lines": {
          "type": "integer",
          "minimum": 0,
          "description": "Total lines of code analyzed"
        },
        "dangerous_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of detected dangerous code patterns"
        }
      }
    },
    "content": {
      "type": "object",
      "description": "AI-generated marketing and documentation content",
      "properties": {
        "user_title": {
          "type": "string",
          "maxLength": 100,
          "description": "User-facing title (benefit-focused)"
        },
        "value_statement": {
          "type": "string",
          "maxLength": 500,
          "description": "Value proposition statement"
        },
        "seo_keywords": {
          "type": "array",
          "items": { "type": "string" },
          "maxItems": 20,
          "description": "SEO-optimized keywords"
        },
        "actual_capabilities": {
          "type": "array",
          "items": { "type": "string" },
          "description": "What the skill can actually do"
        },
        "limitations": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Known limitations"
        },
        "use_cases": {
          "type": "array",
          "items": { "$ref": "#/$defs/useCase" },
          "description": "Example use cases with prompts"
        },
        "prompt_templates": {
          "type": "array",
          "items": { "$ref": "#/$defs/promptTemplate" },
          "description": "Ready-to-use prompt templates"
        },
        "output_examples": {
          "type": "array",
          "items": { "$ref": "#/$defs/outputExample" },
          "description": "Example inputs and outputs"
        },
        "best_practices": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Best practices for using the skill"
        },
        "anti_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "What NOT to do with this skill"
        },
        "faq": {
          "type": "array",
          "items": { "$ref": "#/$defs/faqItem" },
          "description": "Frequently asked questions"
        }
      }
    }
  },
  "$defs": {
    "finding": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "Brief issue title"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the issue"
        },
        "file": {
          "type": "string",
          "description": "File path where issue was found"
        },
        "line": {
          "type": "integer",
          "minimum": 1,
          "description": "Line number of the issue"
        },
        "recommendation": {
          "type": "string",
          "description": "How to fix the issue"
        }
      }
    },
    "useCase": {
      "type": "object",
      "required": ["title", "description"],
      "properties": {
        "title": {
          "type": "string",
          "maxLength": 100
        },
        "description": {
          "type": "string",
          "maxLength": 500
        },
        "example_prompt": {
          "type": "string",
          "description": "Example prompt to trigger this use case"
        }
      }
    },
    "promptTemplate": {
      "type": "object",
      "required": ["title", "template"],
      "properties": {
        "title": {
          "type": "string",
          "maxLength": 100
        },
        "template": {
          "type": "string",
          "description": "Prompt template with {variable} placeholders"
        },
        "variables": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of variable names in the template"
        }
      }
    },
    "outputExample": {
      "type": "object",
      "required": ["scenario", "input", "output"],
      "properties": {
        "scenario": {
          "type": "string",
          "description": "Description of the scenario"
        },
        "input": {
          "type": "string",
          "description": "User input/prompt"
        },
        "output": {
          "type": "string",
          "description": "Expected output from Claude"
        }
      }
    },
    "faqItem": {
      "type": "object",
      "required": ["question", "answer"],
      "properties": {
        "question": {
          "type": "string",
          "maxLength": 200
        },
        "answer": {
          "type": "string",
          "maxLength": 1000
        }
      }
    }
  }
}
