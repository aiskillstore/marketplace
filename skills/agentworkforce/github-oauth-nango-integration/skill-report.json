{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T14:45:44.141Z",
    "slug": "agentworkforce-github-oauth-nango-integration",
    "source_url": "https://github.com/AgentWorkforce/relay/tree/main/.claude/skills/github-oauth-nango-integration",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "ad9149ccad44301bb58069143ccf78abe2fd558595d0c232700160f58a4c35f0",
    "tree_hash": "9727e6a0b44c7b79ec0a3e74b774a52cef9d9a1742a8ead8793e5b6aea5dc16b"
  },
  "skill": {
    "name": "github-oauth-nango-integration",
    "description": "Use when implementing GitHub OAuth + GitHub App authentication with Nango - provides two-connection pattern for user login and repo access with webhook handling",
    "summary": "Use when implementing GitHub OAuth + GitHub App authentication with Nango - provides two-connection ...",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "AgentWorkforce",
    "license": "MIT",
    "category": "security",
    "tags": [
      "github",
      "oauth",
      "authentication",
      "nango",
      "webhooks"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "filesystem",
      "env_access",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation skill containing TypeScript code examples for GitHub OAuth implementation. Static scanner flagged 87 false positives including template literal backticks as shell execution, SHA-256 as weak crypto, and metadata fields as C2 keywords. All findings dismissed. Skill teaches secure OAuth patterns with proper webhook signature verification.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          },
          {
            "file": "SKILL.md",
            "line_start": 302,
            "line_end": 302
          },
          {
            "file": "SKILL.md",
            "line_start": 323,
            "line_end": 323
          },
          {
            "file": "SKILL.md",
            "line_start": 408,
            "line_end": 408
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 133,
            "line_end": 133
          },
          {
            "file": "skill-report.json",
            "line_start": 163,
            "line_end": 163
          },
          {
            "file": "SKILL.md",
            "line_start": 389,
            "line_end": 389
          },
          {
            "file": "SKILL.md",
            "line_start": 273,
            "line_end": 273
          },
          {
            "file": "SKILL.md",
            "line_start": 387,
            "line_end": 387
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 10,
            "line_end": 10
          },
          {
            "file": "SKILL.md",
            "line_start": 10,
            "line_end": 10
          },
          {
            "file": "SKILL.md",
            "line_start": 24,
            "line_end": 24
          },
          {
            "file": "SKILL.md",
            "line_start": 30,
            "line_end": 30
          },
          {
            "file": "SKILL.md",
            "line_start": 38,
            "line_end": 41
          },
          {
            "file": "SKILL.md",
            "line_start": 41,
            "line_end": 45
          },
          {
            "file": "SKILL.md",
            "line_start": 45,
            "line_end": 46
          },
          {
            "file": "SKILL.md",
            "line_start": 46,
            "line_end": 54
          },
          {
            "file": "SKILL.md",
            "line_start": 54,
            "line_end": 54
          },
          {
            "file": "SKILL.md",
            "line_start": 54,
            "line_end": 55
          },
          {
            "file": "SKILL.md",
            "line_start": 55,
            "line_end": 55
          },
          {
            "file": "SKILL.md",
            "line_start": 55,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 60
          },
          {
            "file": "SKILL.md",
            "line_start": 60,
            "line_end": 60
          },
          {
            "file": "SKILL.md",
            "line_start": 60,
            "line_end": 60
          },
          {
            "file": "SKILL.md",
            "line_start": 60,
            "line_end": 61
          },
          {
            "file": "SKILL.md",
            "line_start": 61,
            "line_end": 67
          },
          {
            "file": "SKILL.md",
            "line_start": 67,
            "line_end": 98
          },
          {
            "file": "SKILL.md",
            "line_start": 98,
            "line_end": 102
          },
          {
            "file": "SKILL.md",
            "line_start": 102,
            "line_end": 108
          },
          {
            "file": "SKILL.md",
            "line_start": 108,
            "line_end": 112
          },
          {
            "file": "SKILL.md",
            "line_start": 112,
            "line_end": 141
          },
          {
            "file": "SKILL.md",
            "line_start": 141,
            "line_end": 145
          },
          {
            "file": "SKILL.md",
            "line_start": 145,
            "line_end": 171
          },
          {
            "file": "SKILL.md",
            "line_start": 171,
            "line_end": 175
          },
          {
            "file": "SKILL.md",
            "line_start": 175,
            "line_end": 262
          },
          {
            "file": "SKILL.md",
            "line_start": 262,
            "line_end": 266
          },
          {
            "file": "SKILL.md",
            "line_start": 266,
            "line_end": 295
          },
          {
            "file": "SKILL.md",
            "line_start": 295,
            "line_end": 299
          },
          {
            "file": "SKILL.md",
            "line_start": 299,
            "line_end": 324
          },
          {
            "file": "SKILL.md",
            "line_start": 324,
            "line_end": 343
          },
          {
            "file": "SKILL.md",
            "line_start": 343,
            "line_end": 347
          },
          {
            "file": "SKILL.md",
            "line_start": 347,
            "line_end": 370
          },
          {
            "file": "SKILL.md",
            "line_start": 370,
            "line_end": 376
          },
          {
            "file": "SKILL.md",
            "line_start": 376,
            "line_end": 376
          },
          {
            "file": "SKILL.md",
            "line_start": 376,
            "line_end": 377
          },
          {
            "file": "SKILL.md",
            "line_start": 377,
            "line_end": 378
          },
          {
            "file": "SKILL.md",
            "line_start": 378,
            "line_end": 378
          },
          {
            "file": "SKILL.md",
            "line_start": 378,
            "line_end": 379
          },
          {
            "file": "SKILL.md",
            "line_start": 379,
            "line_end": 380
          },
          {
            "file": "SKILL.md",
            "line_start": 380,
            "line_end": 385
          },
          {
            "file": "SKILL.md",
            "line_start": 385,
            "line_end": 394
          },
          {
            "file": "SKILL.md",
            "line_start": 394,
            "line_end": 398
          },
          {
            "file": "SKILL.md",
            "line_start": 398,
            "line_end": 401
          },
          {
            "file": "SKILL.md",
            "line_start": 401,
            "line_end": 401
          },
          {
            "file": "SKILL.md",
            "line_start": 401,
            "line_end": 403
          },
          {
            "file": "SKILL.md",
            "line_start": 403,
            "line_end": 406
          },
          {
            "file": "SKILL.md",
            "line_start": 406,
            "line_end": 406
          },
          {
            "file": "SKILL.md",
            "line_start": 406,
            "line_end": 408
          },
          {
            "file": "SKILL.md",
            "line_start": 408,
            "line_end": 410
          },
          {
            "file": "SKILL.md",
            "line_start": 410,
            "line_end": 410
          },
          {
            "file": "SKILL.md",
            "line_start": 410,
            "line_end": 410
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 590,
    "audit_model": "claude",
    "audited_at": "2026-01-16T14:45:44.141Z"
  },
  "content": {
    "user_title": "Implement GitHub OAuth with Nango",
    "value_statement": "Building apps that need both user login and repository access requires two different GitHub authentication mechanisms. This skill provides the two-connection OAuth pattern using Nango for secure login while maintaining granular repo permissions through GitHub App installations.",
    "seo_keywords": [
      "GitHub OAuth",
      "Nango integration",
      "GitHub App authentication",
      "Claude Code authentication",
      "OAuth two-connection pattern",
      "webhook handling",
      "user login",
      "repo access",
      "claude code",
      "codex"
    ],
    "actual_capabilities": [
      "Implement dual-connection OAuth pattern with Nango for GitHub login and repo access",
      "Handle GitHub App installation webhooks for permission management",
      "Reconcile OAuth user identity with GitHub App installations",
      "Set up webhook signature verification for secure authentication",
      "Create login and repo connection flows with proper session management"
    ],
    "limitations": [
      "Does not include Nango server setup or deployment configuration",
      "Requires existing Nango account and GitHub App credentials",
      "Does not cover database implementation details beyond schema examples",
      "Frontend code examples are for reference only"
    ],
    "use_cases": [
      {
        "target_user": "Full-stack developers",
        "title": "Build authenticated GitHub apps",
        "description": "Create applications where users can sign in with GitHub and grant repository access through a GitHub App installation"
      },
      {
        "target_user": "Platform engineers",
        "title": "Implement secure OAuth flows",
        "description": "Set up production-ready authentication with proper webhook handling, signature verification, and session management"
      },
      {
        "target_user": "SaaS developers",
        "title": "Connect user identity to permissions",
        "description": "Bridge the gap between OAuth user identity and GitHub App repository permissions for granular access control"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic setup",
        "scenario": "Getting started with GitHub OAuth",
        "prompt": "How do I set up GitHub OAuth login with Nango using the two-connection pattern for user login and repo access?"
      },
      {
        "title": "Webhook handling",
        "scenario": "Processing Nango webhooks",
        "prompt": "How do I handle Nango auth and sync webhooks for GitHub including signature verification and payload parsing?"
      },
      {
        "title": "App OAuth flow",
        "scenario": "GitHub App installation",
        "prompt": "Implement the GitHub App OAuth flow where users authenticate then authorize repo access through app installation"
      },
      {
        "title": "Production security",
        "scenario": "Securing OAuth implementation",
        "prompt": "What are the security best practices for implementing GitHub OAuth with Nango including webhook signature verification and environment variables?"
      }
    ],
    "output_examples": [
      {
        "input": "How do I implement GitHub OAuth login with Nango?",
        "output": [
          "Use two Nango integrations: github for user login and github-app-oauth for repository access",
          "Create a login flow with GET /auth/nango-session that returns a connect session token",
          "Handle the auth webhook at POST /api/webhooks/nango with signature verification",
          "Store the nangoConnectionId in your users table for permanent login credentials",
          "For repo access, use a separate authenticated flow that links repos to the user via ownerId"
        ]
      },
      {
        "input": "How do I verify webhook signatures in production?",
        "output": [
          "Extract the X-Nango-Signature header from the webhook request",
          "Use the raw request body for HMAC calculation, not parsed JSON",
          "Compute expected signature using HMAC-SHA256 with your NANGO_SECRET_KEY",
          "Compare signatures using timing-safe comparison to prevent timing attacks"
        ]
      }
    ],
    "best_practices": [
      "Always verify webhook signatures using HMAC-SHA256 with your NANGO_SECRET_KEY",
      "Store login connection (nangoConnectionId) separately from temporary polling connections",
      "Handle org approval pending states gracefully when GitHub App installation requires admin approval"
    ],
    "anti_patterns": [
      "Using the same connection for both login and repo access",
      "Skipping webhook signature verification in production",
      "Not handling the 403 case for pending GitHub App organization approval"
    ],
    "faq": [
      {
        "question": "What is the difference between GitHub OAuth and GitHub App authentication?",
        "answer": "OAuth provides user identity for login while GitHub App provides granular repo permissions through installations"
      },
      {
        "question": "What are the rate limits for Nango GitHub integration?",
        "answer": "Nango handles rate limiting automatically but design your app to handle sync webhook delays gracefully"
      },
      {
        "question": "How do I integrate this with my existing authentication system?",
        "answer": "Store the nangoConnectionId in your users table and link it to your JWT or session system after webhook verification"
      },
      {
        "question": "Is my GitHub OAuth client secret stored securely?",
        "answer": "Credentials are stored in Nango Dashboard; only use webhook secret keys in your environment variables"
      },
      {
        "question": "Why is my webhook verification failing?",
        "answer": "Ensure you use the raw body for HMAC verification, not parsed JSON, and check your NANGO_SECRET_KEY matches"
      },
      {
        "question": "How does this compare to using GitHub directly without Nango?",
        "answer": "Nango provides unified OAuth handling, automatic token refresh, pre-built sync schedules, and webhook infrastructure"
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 411
    }
  ]
}
