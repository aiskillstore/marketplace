{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T14:52:30.948Z",
    "slug": "abejitsu-pdf-page-extract",
    "source_url": "https://github.com/AbeJitsu/Game-Settings-Panel/tree/main/.claude/skills/calypso/pdf-page-extract",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "f55561487794c139c9767713509d65deb2f6666640679c1af136b0c9cbfd646a",
    "tree_hash": "bbcd8efb5d09bf2e702f52f7c89c7bb6301753382c4935d844873e124aae3cfe"
  },
  "skill": {
    "name": "pdf-page-extract",
    "description": "Extract rich data from PDF pages including text spans with metadata, rendered PNG images, and page mapping. Creates persistent artifacts for downstream processing.",
    "summary": "Extract rich data from PDF pages including text spans with metadata, rendered PNG images, and page m...",
    "icon": "ðŸ“„",
    "version": "1.0.0",
    "author": "AbeJitsu",
    "license": "MIT",
    "category": "data",
    "tags": [
      "pdf",
      "extraction",
      "document-processing",
      "text-analysis"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a pure documentation skill with no executable code. The SKILL.md contains only instructions for running external Python scripts (PyMuPDF, pdfplumber) for PDF extraction. All 53 static findings are false positives: hash values flagged as weak crypto, Python script invocations flagged as shell execution, relative paths flagged as path traversal, and file checks flagged as reconnaissance. Commands use hardcoded paths with no user input - no injection risk. Legitimate document processing tool.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 25,
            "line_end": 205
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 476,
    "audit_model": "claude",
    "audited_at": "2026-01-16T14:52:30.948Z"
  },
  "content": {
    "user_title": "Extract PDF text spans and rendered images",
    "value_statement": "Extract detailed text and visual data from PDF pages. This skill captures font metadata, text positions, and rendered images to enable accurate AI-driven HTML generation workflows.",
    "seo_keywords": [
      "pdf page extraction",
      "text span extraction",
      "pdf metadata",
      "claude code",
      "claude",
      "codex",
      "document processing",
      "font metadata extraction",
      "pdf to png",
      "pdfplumber"
    ],
    "actual_capabilities": [
      "Extract text spans with font metadata (size, style, position)",
      "Render PDF pages as high-resolution PNG images",
      "Create page mapping between PDF indices and book pages",
      "Detect and extract embedded images from PDF pages",
      "Identify page structure (headings, paragraphs, tables)",
      "Save all artifacts to persistent files for downstream processing"
    ],
    "limitations": [
      "Requires PyMuPDF and pdfplumber Python libraries",
      "Processes one chapter at a time (configurable page range)",
      "Image-only PDFs require OCR for text extraction",
      "Output directories must exist before extraction"
    ],
    "use_cases": [
      {
        "target_user": "Content Conversion Specialists",
        "title": "Convert PDF documents to HTML",
        "description": "Extract structured data from PDF documents to enable AI-powered HTML generation for web publishing."
      },
      {
        "target_user": "Technical Writers",
        "title": "Preserve document formatting",
        "description": "Capture font sizes, styles, and layouts from PDFs to recreate document formatting in other formats."
      },
      {
        "target_user": "Data Analysts",
        "title": "Analyze PDF document structure",
        "description": "Extract text and metadata from PDFs for content analysis, auditing, or data extraction pipelines."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic extraction",
        "scenario": "Extract one chapter from PDF",
        "prompt": "Extract all pages from chapter 3 of the PDF. Run rich_extractor.py to get text spans with font metadata, render each page to PNG at 300 DPI, and create the page mapping."
      },
      {
        "title": "Specific page range",
        "scenario": "Extract pages 15-28 from PDF",
        "prompt": "Extract pages 15 through 28 from the PDF. Use read_page_footers.py first to establish the page mapping, then run rich_extractor.py for the specified range, and render each page to PNG."
      },
      {
        "title": "Image extraction",
        "scenario": "Extract embedded images from pages",
        "prompt": "Extract all embedded images from pages 5-10 in chapter 2. Run extract_images.py for each page and save the images with their metadata to the output directory."
      },
      {
        "title": "Complete chapter pipeline",
        "scenario": "Full extraction workflow",
        "prompt": "Run the complete extraction pipeline for chapter 4: first establish page mapping using read_page_footers.py, then run rich_extractor.py to extract all text spans with metadata, render each page to high-resolution PNG, and extract any embedded images. Verify all output files are valid."
      }
    ],
    "output_examples": [
      {
        "input": "Extract chapter 2 from the PDF, pages 15-28",
        "output": [
          "Created rich_extraction.json with 150 text spans across 14 pages",
          "Generated 14 PNG images at 300 DPI resolution",
          "Page mapping saved to analysis/page_mapping.json with 14 entries",
          "Extracted 3 embedded images from pages 17, 22, and 25",
          "All artifacts saved to output/chapter_02/page_artifacts/"
        ]
      },
      {
        "input": "Extract embedded images from chapter 3, pages 5-10",
        "output": [
          "Found and extracted 8 embedded images across 6 pages",
          "Saved images to output/chapter_03/images/ with metadata",
          "Identified 2 pages as image-only requiring OCR",
          "Font analysis found 5 unique font styles in text regions"
        ]
      }
    ],
    "best_practices": [
      "Verify PDF file path and accessibility before starting extraction",
      "Run page mapping first to ensure correct PDF-to-book page correlation",
      "Check output directories exist before running extraction commands",
      "Validate JSON and PNG files after extraction for completeness"
    ],
    "anti_patterns": [
      "Running extraction without first establishing page mapping",
      "Skipping validation of output files after extraction",
      "Extracting without specifying the correct output directory structure"
    ],
    "faq": [
      {
        "question": "What Python libraries are required?",
        "answer": "PyMuPDF (fitz) and pdfplumber are required. Install with pip install pymupdf pdfplumber."
      },
      {
        "question": "Can this process encrypted PDFs?",
        "answer": "No. The PDF must be readable and not password protected for text extraction to work."
      },
      {
        "question": "How does page mapping work?",
        "answer": "read_page_footers.py scans footer text to create a mapping between PDF indices and book page numbers."
      },
      {
        "question": "Is the extracted data safe?",
        "answer": "Yes. All extraction runs locally on your machine. No data is sent to external services."
      },
      {
        "question": "What if text extraction returns empty results?",
        "answer": "The page may be image-only. The skill marks such pages with page_type: image_only for OCR processing."
      },
      {
        "question": "How is this different from pdf-text-extract skill?",
        "answer": "This skill extracts rich metadata including font sizes, positions, and renders PNG images for visual reference."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 297
    }
  ]
}
