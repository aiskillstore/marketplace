{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-21T16:23:52.092Z",
    "slug": "aayushbaniya2006-auth-handler",
    "source_url": "https://github.com/AayushBaniya2006/blinkfund/tree/main/.claude/skills/auth-handler",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "dddad1d62994c5cfbe321ee79bbef87ad79ddb7bb9d9ffa39c03fd82aeec6751",
    "tree_hash": "3e50afe06322b5c8b1f9d315f0e2bdb00ea505ca4422789ad17f88ec060f2652"
  },
  "skill": {
    "name": "auth-handler",
    "description": "Manage authentication, authorization, and user sessions in Next.js applications using NextAuth v5 with best practices for API protection and secure data access.",
    "summary": "Manage authentication, authorization, and user sessions with NextAuth v5 best practices",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "AayushBaniya2006",
    "license": "MIT",
    "category": "security",
    "tags": [
      "authentication",
      "authorization",
      "nextauth",
      "security",
      "sessions"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill provides documentation and guidance for implementing authentication in Next.js applications. All static findings are false positives. The external command patterns are TypeScript code examples in markdown documentation, not executable code. The network and filesystem references are metadata in JSON files. No actual security risks detected.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 505,
    "audit_model": "claude",
    "audited_at": "2026-01-21T16:23:52.092Z"
  },
  "content": {
    "user_title": "Manage Next.js Authentication with NextAuth v5",
    "value_statement": "Authentication implementation can be complex and error-prone, leading to security vulnerabilities. This skill provides clear guidelines for implementing secure authentication, authorization, and session management in Next.js applications using NextAuth v5 with defense-in-depth protection patterns.",
    "seo_keywords": [
      "Claude",
      "Codex",
      "Claude Code",
      "NextAuth",
      "authentication",
      "Next.js security",
      "API route protection",
      "session management",
      "authorization middleware",
      "user authentication"
    ],
    "actual_capabilities": [
      "Implement API route protection with NextAuth v5 wrapper functions",
      "Configure authentication for standard routes, super admin routes, and cron jobs",
      "Set up client-side authentication with SWR-based useUser hook",
      "Implement server-side authentication checks and user data fetching",
      "Configure NextAuth providers, adapters, and database schema",
      "Apply defense-in-depth security patterns for authentication"
    ],
    "limitations": [
      "Focused specifically on Next.js applications with NextAuth v5",
      "Assumes use of specific project structure with src directory",
      "Does not cover authentication for other frameworks or libraries",
      "References project-specific files that may not exist in all codebases"
    ],
    "use_cases": [
      {
        "title": "API Route Protection",
        "description": "Protect API routes by implementing authentication wrappers for standard routes, super admin routes, and cron jobs with defense-in-depth security patterns.",
        "target_user": "Backend developers building secure Next.js APIs"
      },
      {
        "title": "Frontend Authentication State",
        "description": "Implement client-side authentication state management using SWR-based useUser hook to access current user data in React components.",
        "target_user": "Frontend developers building authenticated user interfaces"
      },
      {
        "title": "Server-Side User Data Access",
        "description": "Fetch user data and check authentication status on the server side using NextAuth session management and user plan retrieval functions.",
        "target_user": "Full-stack developers implementing server-side rendering with authentication"
      }
    ],
    "prompt_templates": [
      {
        "title": "Protect an API Route",
        "prompt": "Protect this API route with authentication using withAuthRequired",
        "scenario": "Adding authentication to a new API endpoint"
      },
      {
        "title": "Add Client Authentication",
        "prompt": "Add user authentication to this React component using the useUser hook",
        "scenario": "Displaying user-specific data in a frontend component"
      },
      {
        "title": "Implement Super Admin Check",
        "prompt": "Protect this admin route with super admin authentication using withSuperAdminAuthRequired",
        "scenario": "Creating admin-only functionality"
      },
      {
        "title": "Configure NextAuth Provider",
        "prompt": "Add a new OAuth provider to the NextAuth configuration in auth.ts",
        "scenario": "Extending authentication to support additional login methods"
      }
    ],
    "output_examples": [
      {
        "input": "Protect this API route with authentication using withAuthRequired",
        "output": "I will protect your API route with NextAuth authentication. The route will be wrapped with withAuthRequired to ensure only authenticated users can access it. The wrapper provides session data and a getUser function for accessing user details."
      },
      {
        "input": "Add user authentication to this React component using the useUser hook",
        "output": "I will add the useUser hook to your component to access the current user data. This hook uses SWR for efficient caching and revalidation. The component will display loading states while fetching and handle unauthenticated users appropriately."
      },
      {
        "input": "Add a new OAuth provider to the NextAuth configuration",
        "output": "I will add the new OAuth provider to your auth.ts configuration file. This includes setting up the provider credentials, configuring the callback URLs, and adding the necessary environment variables to your project documentation."
      }
    ],
    "best_practices": [
      "Always implement route-level authentication wrappers in addition to middleware for defense-in-depth security",
      "Use the useUser hook for client components instead of useSession from next-auth react library",
      "Configure environment variables for AUTH_SECRET, provider credentials, and SUPER_ADMIN_EMAILS before deployment"
    ],
    "anti_patterns": [
      "Relying solely on middleware for authentication without individual route protection",
      "Using useSession from next-auth react instead of the project-specific useUser hook",
      "Assuming session.user contains complete user data instead of fetching with getUserPlan"
    ],
    "faq": [
      {
        "question": "What is the difference between withAuthRequired and withSuperAdminAuthRequired?",
        "answer": "withAuthRequired protects routes for any authenticated user while withSuperAdminAuthRequired restricts access to users listed in the SUPER_ADMIN_EMAILS environment variable."
      },
      {
        "question": "Why should I use useUser instead of useSession from next-auth?",
        "answer": "The useUser hook is a project-specific wrapper that uses SWR for better caching and revalidation. It provides a consistent interface for accessing user data across client components."
      },
      {
        "question": "How do I protect cron job endpoints?",
        "answer": "Use the cronAuthRequired wrapper function specifically designed for automated task endpoints that need authentication without user sessions."
      },
      {
        "question": "What is defense-in-depth for authentication?",
        "answer": "Defense-in-depth means implementing multiple layers of security. Use both middleware for initial route filtering and individual route wrappers for guaranteed protection at the endpoint level."
      },
      {
        "question": "Where do I configure OAuth providers like Google?",
        "answer": "Configure OAuth providers in the src/auth.ts file. You will need to add provider credentials and set environment variables like GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET."
      },
      {
        "question": "How do I access full user data in API routes?",
        "answer": "The session.user object contains minimal data. Use getUserPlan with the user ID to fetch complete user information including subscription plan details from the database."
      }
    ]
  },
  "file_structure": [
    {
      "name": "reference.md",
      "type": "file",
      "path": "reference.md",
      "lines": 23
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 32
    }
  ]
}
