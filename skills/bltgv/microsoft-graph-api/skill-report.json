{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T19:02:39.054Z",
    "slug": "bltgv-microsoft-graph-api",
    "source_url": "https://github.com/BLTGV/agent-skills/tree/master/skills/microsoft-graph",
    "source_ref": "master",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "ab89f22136609b892b733c680f5d4d292cc2ee53383038afe06fb8f715335c03",
    "tree_hash": "24e31f60471f53215bf980a65052984588ad86623a0049342f1e70c2686e9fa3"
  },
  "skill": {
    "name": "microsoft-graph-api",
    "description": "This skill should be used when the user asks to \"read my emails\", \"send an email\", \"compose email\", \"check my calendar\", \"get calendar events\", \"create a meeting\", \"schedule an event\", \"add calendar event\", \"search emails\", \"list mail folders\", \"show unread messages\", \"what meetings do I have\", \"fetch emails from Microsoft\", \"access Outlook\", or mentions Microsoft Graph, Office 365 email, or Outlook calendar integration.",
    "summary": "This skill should be used when the user asks to \"read my emails\", \"send an email\", \"compose email\", ...",
    "icon": "ðŸ“§",
    "version": "0.3.0",
    "author": "BLTGV",
    "license": "MIT",
    "category": "office",
    "tags": [
      "microsoft",
      "email",
      "calendar",
      "office-365",
      "productivity"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "network",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "The static analyzer flagged 317 issues, but upon evaluation, ALL findings are FALSE POSITIVES. The code is a legitimate Microsoft Graph API integration using standard OAuth 2.0 device code flow. The 'backtick execution' detections are template literals in documentation and code, not shell commands. 'Hardcoded URL' findings are public Microsoft API endpoints, not secrets. 'C2 keywords' are the official Microsoft Graph Explorer client ID. All credential handling follows standard OAuth patterns with the @azure/msal-node library.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 74,
            "line_end": 210
          },
          {
            "file": "scripts/auth.ts",
            "line_start": 56,
            "line_end": 210
          },
          {
            "file": "scripts/emails.ts",
            "line_start": 65,
            "line_end": 349
          },
          {
            "file": "scripts/calendar.ts",
            "line_start": 66,
            "line_end": 420
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "scripts/lib/graph-client.ts",
            "line_start": 155,
            "line_end": 155
          },
          {
            "file": "scripts/lib/device-code.ts",
            "line_start": 38,
            "line_end": 175
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/lib/credentials.ts",
            "line_start": 6,
            "line_end": 7
          },
          {
            "file": "scripts/lib/pending-auth.ts",
            "line_start": 29,
            "line_end": 34
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 12,
    "total_lines": 2677,
    "audit_model": "claude",
    "audited_at": "2026-01-16T19:02:39.054Z"
  },
  "content": {
    "user_title": "Access Microsoft 365 email and calendar",
    "value_statement": "Users need to read and manage their Microsoft 365 emails and calendar events without leaving their AI assistant. This skill provides direct integration with Microsoft Graph API to list, read, search, and send emails as well as view and create calendar events using OAuth authentication.",
    "seo_keywords": [
      "Microsoft Graph API",
      "Office 365 email",
      "Outlook calendar",
      "Microsoft 365 integration",
      "email automation",
      "calendar management",
      "Claude",
      "Codex",
      "Claude Code"
    ],
    "actual_capabilities": [
      "List, read, search, and send emails via Microsoft Graph API",
      "View, search, and create calendar events and meetings",
      "Manage multiple credential profiles for different accounts",
      "Handle OAuth device code flow authentication automatically",
      "List mail folders and filter emails by sender, subject, or date",
      "Create calendar events with attendees, locations, and all-day support"
    ],
    "limitations": [
      "Requires Microsoft account with appropriate Graph API permissions",
      "Access tokens expire after approximately 90 days of inactivity",
      "Cannot access shared mailboxes or delegation without separate setup",
      "Rate limited by Microsoft Graph API quotas"
    ],
    "use_cases": [
      {
        "target_user": "Remote workers",
        "title": "Check email and schedule",
        "description": "Quickly check inbox for important emails and view today's calendar meetings"
      },
      {
        "target_user": "Administrative assistants",
        "title": "Schedule meetings",
        "description": "Create calendar events and send meeting invitations to attendees"
      },
      {
        "target_user": "Project managers",
        "title": "Find communications",
        "description": "Search email threads and calendar events for project-related discussions"
      }
    ],
    "prompt_templates": [
      {
        "title": "List recent emails",
        "scenario": "Read inbox messages",
        "prompt": "List my recent emails from the inbox"
      },
      {
        "title": "Check calendar",
        "scenario": "View today's schedule",
        "prompt": "What meetings do I have today"
      },
      {
        "title": "Send email",
        "scenario": "Compose and send message",
        "prompt": "Send an email to team@example.com about the project update"
      },
      {
        "title": "Create meeting",
        "scenario": "Schedule event",
        "prompt": "Create a team meeting for tomorrow at 2pm with john@example.com and jane@example.com"
      }
    ],
    "output_examples": [
      {
        "input": "List my recent emails",
        "output": [
          "Recent emails from inbox:",
          "- Subject: Project Update, From: john@company.com, 10:30 AM",
          "- Subject: Meeting Tomorrow, From: jane@company.com, 9:15 AM",
          "- Subject: Newsletter, From: team@newsletter.com, Yesterday"
        ]
      },
      {
        "input": "What meetings do I have today",
        "output": [
          "Today's calendar:",
          "- 10:00 AM: Team Standup (1 hour) - Conference Room A",
          "- 2:00 PM: Project Review (30 min) - Video Call"
        ]
      },
      {
        "input": "Send an email about the project update",
        "output": [
          "Email sent successfully:",
          "To: team@example.com",
          "Subject: Project Update",
          "The email has been delivered."
        ]
      }
    ],
    "best_practices": [
      "Use specific profiles when managing multiple Microsoft accounts to keep credentials separate",
      "Run the auth.ts script first to complete device code authentication before using email or calendar features",
      "Request only the necessary scopes (Mail.Read, Calendars.Read) rather than full access when possible"
    ],
    "anti_patterns": [
      "Using the same profile for personal and work accounts - create separate profiles instead",
      "Sharing credential files between users - each user should authenticate their own account",
      "Ignoring auth_required responses - always complete the device code flow when prompted"
    ],
    "faq": [
      {
        "question": "How do I authenticate for the first time?",
        "answer": "Run any email or calendar command. If not authenticated, the skill returns auth_required with a code. Open the displayed URL, enter the code, and sign in with Microsoft."
      },
      {
        "question": "How long do tokens remain valid?",
        "answer": "Access tokens expire after 1 hour but refresh automatically. Refresh tokens last approximately 90 days before requiring re-authentication."
      },
      {
        "question": "Can I use this with my work Microsoft account?",
        "answer": "Yes, the skill works with both work and personal Microsoft accounts. Use --profile to manage different accounts separately."
      },
      {
        "question": "Where are credentials stored?",
        "answer": "OAuth tokens are stored in ~/.config/api-skills/credentials.json with standard file permissions."
      },
      {
        "question": "What permissions does the app require?",
        "answer": "By default, it requests Mail.Read, Mail.Send, Calendars.Read, Calendars.ReadWrite, and User.Read scopes for full functionality."
      },
      {
        "question": "Can I use my own Azure AD app registration?",
        "answer": "Yes, run auth.ts with --client-id and --tenant-id options to use a custom app registration for production use."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "graph-api.md",
          "type": "file",
          "path": "references/graph-api.md",
          "lines": 306
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "lib",
          "type": "dir",
          "path": "scripts/lib",
          "children": [
            {
              "name": "auth-handler.ts",
              "type": "file",
              "path": "scripts/lib/auth-handler.ts",
              "lines": 255
            },
            {
              "name": "credentials.ts",
              "type": "file",
              "path": "scripts/lib/credentials.ts",
              "lines": 75
            },
            {
              "name": "device-code.ts",
              "type": "file",
              "path": "scripts/lib/device-code.ts",
              "lines": 176
            },
            {
              "name": "graph-client.ts",
              "type": "file",
              "path": "scripts/lib/graph-client.ts",
              "lines": 180
            },
            {
              "name": "pending-auth.ts",
              "type": "file",
              "path": "scripts/lib/pending-auth.ts",
              "lines": 95
            },
            {
              "name": "types.ts",
              "type": "file",
              "path": "scripts/lib/types.ts",
              "lines": 77
            }
          ]
        },
        {
          "name": "auth.ts",
          "type": "file",
          "path": "scripts/auth.ts",
          "lines": 210
        },
        {
          "name": "calendar.ts",
          "type": "file",
          "path": "scripts/calendar.ts",
          "lines": 421
        },
        {
          "name": "emails.ts",
          "type": "file",
          "path": "scripts/emails.ts",
          "lines": 350
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 224
    }
  ]
}
