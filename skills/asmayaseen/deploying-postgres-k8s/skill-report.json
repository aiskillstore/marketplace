{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-21T16:25:50.130Z",
    "slug": "asmayaseen-deploying-postgres-k8s",
    "source_url": "https://github.com/Asmayaseen/hackathon-2/tree/main/.claude/skills/deploying-postgres-k8s",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "00964e753bc25c6620d5a9e26fdc2563072faa823f2776a674ff752e8538a9bd",
    "tree_hash": "de418fb6fe006073178e625d152237de95a25926a4f025b4e0800bfe46a09784"
  },
  "skill": {
    "name": "deploying-postgres-k8s",
    "description": "Deploys PostgreSQL on Kubernetes using the CloudNativePG operator with automated failover.\nUse when setting up PostgreSQL for production workloads, high availability, or local K8s development.\nCovers operator installation, cluster creation, connection secrets, and backup configuration.\nNOT when using managed Postgres (Neon, RDS, Cloud SQL) or simple Docker containers.\n",
    "summary": "Deploys PostgreSQL on Kubernetes using the CloudNativePG operator with automated failover.\nUse when ...",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "Asmayaseen",
    "license": "MIT",
    "tags": [
      "postgresql",
      "kubernetes",
      "cloudnativepg",
      "database",
      "devops"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Static scanner flagged patterns related to shell commands and environment access. Evaluation confirms all are legitimate infrastructure documentation. The skill provides standard kubectl commands and Kubernetes secret patterns for PostgreSQL deployment. No malicious code or exfiltration patterns detected. The critical heuristic alert is a false positive triggered by standard K8s documentation patterns.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 16,
            "line_end": 38
          },
          {
            "file": "SKILL.md",
            "line_start": 45,
            "line_end": 51
          },
          {
            "file": "SKILL.md",
            "line_start": 55,
            "line_end": 63
          },
          {
            "file": "SKILL.md",
            "line_start": 161,
            "line_end": 165
          },
          {
            "file": "SKILL.md",
            "line_start": 178,
            "line_end": 184
          },
          {
            "file": "SKILL.md",
            "line_start": 217,
            "line_end": 223
          },
          {
            "file": "SKILL.md",
            "line_start": 227,
            "line_end": 235
          },
          {
            "file": "SKILL.md",
            "line_start": 294,
            "line_end": 298
          },
          {
            "file": "SKILL.md",
            "line_start": 344,
            "line_end": 354
          }
        ]
      },
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "scripts/verify.py",
            "line_start": 1,
            "line_end": 39
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "External command documentation",
        "description": "SKILL.md contains shell command examples using kubectl for Kubernetes operations. These are legitimate documentation for PostgreSQL deployment and do not pose security risks.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 16,
            "line_end": 38
          },
          {
            "file": "SKILL.md",
            "line_start": 44,
            "line_end": 51
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 1352,
    "audit_model": "claude",
    "audited_at": "2026-01-21T16:25:50.130Z"
  },
  "content": {
    "user_title": "Deploy PostgreSQL on Kubernetes",
    "value_statement": "Setting up production-ready PostgreSQL on Kubernetes requires understanding operator deployment, high availability configuration, and secret management. This skill provides ready-to-use commands and configurations for deploying CloudNativePG clusters with automated failover.",
    "seo_keywords": [
      "PostgreSQL Kubernetes",
      "CloudNativePG",
      "Kubernetes database",
      "PostgreSQL operator",
      "Claude",
      "Codex",
      "Claude Code",
      "K8s PostgreSQL",
      "HA PostgreSQL",
      "PostgreSQL deployment"
    ],
    "actual_capabilities": [
      "Install CloudNativePG operator on Kubernetes cluster using kubectl or Helm",
      "Create production-ready PostgreSQL clusters with high availability configuration",
      "Configure connection secrets for secure database access",
      "Set up S3 backup storage with Barman for disaster recovery",
      "Generate monitoring configurations with Prometheus metrics"
    ],
    "limitations": [
      "Does not provision Kubernetes clusters themselves",
      "Does not support managed PostgreSQL services like Neon, RDS, or Cloud SQL",
      "Does not handle multi-region or geo-distributed deployments",
      "Requires existing kubectl access to a Kubernetes cluster"
    ],
    "use_cases": [
      {
        "title": "Set up development PostgreSQL",
        "description": "Deploy a single-instance PostgreSQL cluster for local development with minimal configuration.",
        "target_user": "Developers building applications that need a local database"
      },
      {
        "title": "Configure production HA database",
        "description": "Deploy a three-replica PostgreSQL cluster with automated failover and monitoring.",
        "target_user": "DevOps engineers setting up production infrastructure"
      },
      {
        "title": "Configure backup and recovery",
        "description": "Set up S3-based backups with retention policies for disaster recovery.",
        "target_user": "Site reliability engineers implementing data protection"
      }
    ],
    "prompt_templates": [
      {
        "title": "Quick PostgreSQL deployment",
        "prompt": "Deploy a PostgreSQL cluster on my Kubernetes cluster using the CloudNativePG operator.",
        "scenario": "Quick deployment request without specific requirements"
      },
      {
        "title": "Production HA setup",
        "prompt": "Create a production-ready PostgreSQL cluster with 3 replicas, 100Gi storage, and resource limits. Include monitoring and S3 backup configuration.",
        "scenario": "Production deployment with specific resource requirements"
      },
      {
        "title": "Connection secrets",
        "prompt": "Show me how to configure connection secrets for my PostgreSQL cluster and how to use them in my application deployments.",
        "scenario": "Setting up database credentials for applications"
      },
      {
        "title": "Backup configuration",
        "prompt": "Configure daily backups to S3 with 30-day retention for my PostgreSQL cluster. Include the required secret configuration.",
        "scenario": "Setting up disaster recovery backup system"
      }
    ],
    "output_examples": [
      {
        "input": "Deploy a PostgreSQL cluster for development",
        "output": [
          "## Deploying PostgreSQL for Development",
          "",
          "### 1. Install CloudNativePG operator",
          "kubectl apply --server-side -f https://raw.githubusercontent.com/cloudnative-pg/cloudnative-pg/release-1.28/releases/cnpg-1.28.0.yaml",
          "",
          "### 2. Create development cluster",
          "kubectl apply -f - <<EOF",
          "apiVersion: postgresql.cnpg.io/v1",
          "kind: Cluster",
          "metadata:",
          "  name: pg-dev",
          "spec:",
          "  instances: 1",
          "  storage:",
          "    size: 5Gi",
          "EOF"
        ]
      },
      {
        "input": "How do I connect to my PostgreSQL cluster from an application?",
        "output": [
          "## Connecting to Your PostgreSQL Cluster",
          "",
          "CloudNativePG automatically creates connection secrets:",
          "",
          "| Secret | Contents |",
          "|--------|----------|",
          "| `pg-cluster-app` | App credentials (recommended) |",
          "| `pg-cluster-superuser` | Superuser credentials |",
          "",
          "### Use in Kubernetes Deployment",
          "env:",
          "  - name: DATABASE_URL",
          "    valueFrom:",
          "      secretKeyRef:",
          "        name: pg-cluster-app",
          "        key: uri"
        ]
      }
    ],
    "best_practices": [
      "Use the app credentials secret for application connections, not superuser credentials",
      "Always configure resource limits and requests to prevent resource contention",
      "Set up regular backups to S3 with appropriate retention policies",
      "Use namespace-scoped operator installation for enhanced security"
    ],
    "anti_patterns": [
      "Using superuser credentials in application code",
      "Deploying without resource limits causing node resource exhaustion",
      "Storing database credentials in plain text config maps instead of secrets",
      "Skipping backup configuration for production databases"
    ],
    "faq": [
      {
        "question": "What is CloudNativePG?",
        "answer": "CloudNativePG is a Kubernetes operator that manages PostgreSQL clusters. It handles deployment, failover, backups, and monitoring automatically."
      },
      {
        "question": "How many replicas should I use?",
        "answer": "Use 1 replica for development, 3 replicas for production high availability. More replicas increase availability but also resource usage."
      },
      {
        "question": "Does this work with any Kubernetes cluster?",
        "answer": "Yes, CloudNativePG works with any standard Kubernetes cluster including GKE, EKS, AKS, and self-managed clusters."
      },
      {
        "question": "How do I upgrade my PostgreSQL version?",
        "answer": "CloudNativePG supports rolling upgrades. Update the `imageName` in your cluster spec and the operator will perform the upgrade."
      },
      {
        "question": "What storage class should I use?",
        "answer": "Use a storage class with reclaim policy Delete or Retain based on your data protection needs. Consult your cloud provider documentation."
      },
      {
        "question": "How do I monitor my PostgreSQL cluster?",
        "answer": "Enable `enablePodMonitor: true` in your cluster spec to expose Prometheus metrics. The skill includes common metrics like connection counts and replication lag."
      }
    ]
  },
  "file_structure": [
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "verify.py",
          "type": "file",
          "path": "scripts/verify.py",
          "lines": 39
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 364
    }
  ]
}
