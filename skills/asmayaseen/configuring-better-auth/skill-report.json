{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T17:45:57.210Z",
    "slug": "asmayaseen-configuring-better-auth",
    "source_url": "https://github.com/Asmayaseen/hackathon-2/tree/main/.claude/skills/configuring-better-auth",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "39c8c6c4687db6f94006ce166b786f0c831c1d10ebcb72880a37b1648fc3734c",
    "tree_hash": "2d3abba09b53c00c5abeb6307fdf4aec1abd1cc3835d7824b05edf1a78f35386"
  },
  "skill": {
    "name": "configuring-better-auth",
    "description": "Implement OAuth 2.1 / OIDC authentication using Better Auth with MCP assistance. Use when setting\nup a centralized auth server (SSO provider), implementing SSO clients in Next.js apps, configuring\nPKCE flows, or managing tokens with JWKS verification. Uses Better Auth MCP for guided setup.\nNOT when using simple session-only auth without OAuth/OIDC requirements.\n",
    "summary": "Implement OAuth 2.1 / OIDC authentication using Better Auth with MCP assistance. Use when setting\nup...",
    "icon": "ğŸ”",
    "version": "1.0.0",
    "author": "Asmayaseen",
    "license": "MIT",
    "category": "security",
    "tags": [
      "oauth",
      "oidc",
      "authentication",
      "sso",
      "better-auth"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "network",
      "filesystem",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "All static findings are FALSE POSITIVES. This is legitimate OAuth/OIDC authentication documentation for Better Auth framework. The scanner flagged standard OAuth patterns (network calls for token exchange, environment config, PKCE code verifiers in sessionStorage) as suspicious, but these are required for OAuth/OIDC flows. Uses industry-standard RS256 cryptography, proper httpOnly cookies, and PKCE security measures.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "references/auth-server-setup.md",
            "line_start": 37,
            "line_end": 78
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 78,
            "line_end": 82
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 82,
            "line_end": 114
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 114,
            "line_end": 119
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 119,
            "line_end": 131
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 131,
            "line_end": 135
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 135,
            "line_end": 140
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 140,
            "line_end": 141
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 141,
            "line_end": 157
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 157,
            "line_end": 161
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 161,
            "line_end": 163
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 163,
            "line_end": 219
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 219,
            "line_end": 222
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 222,
            "line_end": 231
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 231,
            "line_end": 238
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 238,
            "line_end": 259
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 259,
            "line_end": 262
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 262,
            "line_end": 295
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 295,
            "line_end": 297
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 297,
            "line_end": 300
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 300,
            "line_end": 313
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 313,
            "line_end": 319
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 319,
            "line_end": 388
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 388,
            "line_end": 402
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 402,
            "line_end": 407
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 407,
            "line_end": 410
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 410,
            "line_end": 421
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 421,
            "line_end": 429
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 429,
            "line_end": 451
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 451,
            "line_end": 460
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 460,
            "line_end": 468
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 468,
            "line_end": 474
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 474,
            "line_end": 480
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 480,
            "line_end": 493
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 493,
            "line_end": 509
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 509,
            "line_end": 511
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 511,
            "line_end": 518
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 518,
            "line_end": 524
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 524,
            "line_end": 532
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 532,
            "line_end": 538
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 538,
            "line_end": 548
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 548,
            "line_end": 549
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 549,
            "line_end": 550
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 550,
            "line_end": 551
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 551,
            "line_end": 552
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 552,
            "line_end": 553
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 553,
            "line_end": 557
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 557,
            "line_end": 572
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 572,
            "line_end": 575
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 575,
            "line_end": 577
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 577,
            "line_end": 579
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 20,
            "line_end": 31
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 31,
            "line_end": 35
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 35,
            "line_end": 42
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 42,
            "line_end": 48
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 48,
            "line_end": 91
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 91,
            "line_end": 99
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 99,
            "line_end": 113
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 113,
            "line_end": 117
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 117,
            "line_end": 132
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 132,
            "line_end": 151
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 151,
            "line_end": 157
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 157,
            "line_end": 213
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 213,
            "line_end": 217
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 217,
            "line_end": 224
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 224,
            "line_end": 254
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 254,
            "line_end": 258
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 258,
            "line_end": 319
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 319,
            "line_end": 326
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 326,
            "line_end": 384
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 384,
            "line_end": 388
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 388,
            "line_end": 401
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 401,
            "line_end": 423
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 423,
            "line_end": 427
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 427,
            "line_end": 433
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 433,
            "line_end": 450
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 450,
            "line_end": 486
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 486,
            "line_end": 490
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 490,
            "line_end": 508
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 508,
            "line_end": 567
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 567,
            "line_end": 592
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 592,
            "line_end": 596
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 596,
            "line_end": 603
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 603,
            "line_end": 607
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 607,
            "line_end": 626
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 626,
            "line_end": 636
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 636,
            "line_end": 637
          },
          {
            "file": "SKILL.md",
            "line_start": 18,
            "line_end": 20
          },
          {
            "file": "SKILL.md",
            "line_start": 20,
            "line_end": 22
          },
          {
            "file": "SKILL.md",
            "line_start": 22,
            "line_end": 24
          },
          {
            "file": "SKILL.md",
            "line_start": 24,
            "line_end": 33
          },
          {
            "file": "SKILL.md",
            "line_start": 33,
            "line_end": 49
          },
          {
            "file": "SKILL.md",
            "line_start": 49,
            "line_end": 60
          },
          {
            "file": "SKILL.md",
            "line_start": 60,
            "line_end": 66
          },
          {
            "file": "SKILL.md",
            "line_start": 66,
            "line_end": 68
          },
          {
            "file": "SKILL.md",
            "line_start": 68,
            "line_end": 72
          },
          {
            "file": "SKILL.md",
            "line_start": 72,
            "line_end": 94
          },
          {
            "file": "SKILL.md",
            "line_start": 94,
            "line_end": 98
          },
          {
            "file": "SKILL.md",
            "line_start": 98,
            "line_end": 105
          },
          {
            "file": "SKILL.md",
            "line_start": 105,
            "line_end": 113
          },
          {
            "file": "SKILL.md",
            "line_start": 113,
            "line_end": 115
          },
          {
            "file": "SKILL.md",
            "line_start": 115,
            "line_end": 119
          },
          {
            "file": "SKILL.md",
            "line_start": 119,
            "line_end": 122
          },
          {
            "file": "SKILL.md",
            "line_start": 122,
            "line_end": 126
          },
          {
            "file": "SKILL.md",
            "line_start": 126,
            "line_end": 135
          },
          {
            "file": "SKILL.md",
            "line_start": 135,
            "line_end": 139
          },
          {
            "file": "SKILL.md",
            "line_start": 139,
            "line_end": 146
          },
          {
            "file": "SKILL.md",
            "line_start": 146,
            "line_end": 148
          },
          {
            "file": "SKILL.md",
            "line_start": 148,
            "line_end": 152
          },
          {
            "file": "SKILL.md",
            "line_start": 152,
            "line_end": 159
          },
          {
            "file": "SKILL.md",
            "line_start": 159,
            "line_end": 166
          },
          {
            "file": "SKILL.md",
            "line_start": 166,
            "line_end": 179
          },
          {
            "file": "SKILL.md",
            "line_start": 179,
            "line_end": 187
          },
          {
            "file": "SKILL.md",
            "line_start": 187,
            "line_end": 208
          },
          {
            "file": "SKILL.md",
            "line_start": 208,
            "line_end": 219
          },
          {
            "file": "SKILL.md",
            "line_start": 219,
            "line_end": 221
          },
          {
            "file": "SKILL.md",
            "line_start": 221,
            "line_end": 231
          },
          {
            "file": "SKILL.md",
            "line_start": 231,
            "line_end": 234
          },
          {
            "file": "SKILL.md",
            "line_start": 234,
            "line_end": 238
          },
          {
            "file": "SKILL.md",
            "line_start": 238,
            "line_end": 248
          },
          {
            "file": "SKILL.md",
            "line_start": 248,
            "line_end": 251
          },
          {
            "file": "SKILL.md",
            "line_start": 251,
            "line_end": 253
          },
          {
            "file": "SKILL.md",
            "line_start": 253,
            "line_end": 256
          },
          {
            "file": "SKILL.md",
            "line_start": 256,
            "line_end": 273
          },
          {
            "file": "SKILL.md",
            "line_start": 273,
            "line_end": 275
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "references/auth-server-setup.md",
            "line_start": 119,
            "line_end": 119
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 140,
            "line_end": 140
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 64,
            "line_end": 64
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 107,
            "line_end": 107
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 125,
            "line_end": 125
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 223,
            "line_end": 223
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 228,
            "line_end": 228
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 248,
            "line_end": 248
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 279,
            "line_end": 279
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 423,
            "line_end": 423
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 520,
            "line_end": 520
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 523,
            "line_end": 523
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 534,
            "line_end": 534
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 534,
            "line_end": 534
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 537,
            "line_end": 537
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 322,
            "line_end": 322
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 322,
            "line_end": 322
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 327,
            "line_end": 327
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 329,
            "line_end": 329
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 329,
            "line_end": 329
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 330,
            "line_end": 330
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 331,
            "line_end": 331
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 332,
            "line_end": 332
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 333,
            "line_end": 333
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 336,
            "line_end": 336
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 336,
            "line_end": 336
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 337,
            "line_end": 337
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 338,
            "line_end": 338
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 339,
            "line_end": 339
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 340,
            "line_end": 340
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 342,
            "line_end": 342
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 343,
            "line_end": 343
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 353,
            "line_end": 353
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 355,
            "line_end": 355
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 366,
            "line_end": 366
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 367,
            "line_end": 367
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 368,
            "line_end": 368
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 368,
            "line_end": 368
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 415,
            "line_end": 415
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 416,
            "line_end": 416
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 416,
            "line_end": 416
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 417,
            "line_end": 417
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 418,
            "line_end": 418
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 419,
            "line_end": 419
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 151,
            "line_end": 151
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 294,
            "line_end": 294
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 336,
            "line_end": 336
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 508,
            "line_end": 508
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 567,
            "line_end": 567
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 40,
            "line_end": 40
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 598,
            "line_end": 598
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 602,
            "line_end": 602
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 639,
            "line_end": 639
          },
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          },
          {
            "file": "skill-report.json",
            "line_start": 129,
            "line_end": 129
          },
          {
            "file": "SKILL.md",
            "line_start": 159,
            "line_end": 159
          },
          {
            "file": "SKILL.md",
            "line_start": 221,
            "line_end": 221
          },
          {
            "file": "SKILL.md",
            "line_start": 19,
            "line_end": 19
          },
          {
            "file": "SKILL.md",
            "line_start": 29,
            "line_end": 29
          },
          {
            "file": "SKILL.md",
            "line_start": 102,
            "line_end": 102
          },
          {
            "file": "SKILL.md",
            "line_start": 120,
            "line_end": 120
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "references/auth-server-setup.md",
            "line_start": 266,
            "line_end": 266
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 557,
            "line_end": 557
          },
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          },
          {
            "file": "SKILL.md",
            "line_start": 238,
            "line_end": 238
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "references/auth-server-setup.md",
            "line_start": 54,
            "line_end": 54
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 271,
            "line_end": 271
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 325,
            "line_end": 325
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 326,
            "line_end": 326
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 327,
            "line_end": 327
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 331,
            "line_end": 331
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 332,
            "line_end": 332
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 333,
            "line_end": 333
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 338,
            "line_end": 338
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 339,
            "line_end": 339
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 340,
            "line_end": 340
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 342,
            "line_end": 342
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 343,
            "line_end": 343
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 349,
            "line_end": 349
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 350,
            "line_end": 350
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 54,
            "line_end": 54
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 271,
            "line_end": 271
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 325,
            "line_end": 325
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 326,
            "line_end": 326
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 327,
            "line_end": 327
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 331,
            "line_end": 331
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 332,
            "line_end": 332
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 333,
            "line_end": 333
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 338,
            "line_end": 338
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 339,
            "line_end": 339
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 340,
            "line_end": 340
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 342,
            "line_end": 342
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 343,
            "line_end": 343
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 349,
            "line_end": 349
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 350,
            "line_end": 350
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 271,
            "line_end": 271
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 349,
            "line_end": 349
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 350,
            "line_end": 350
          },
          {
            "file": "references/auth-server-setup.md",
            "line_start": 412,
            "line_end": 412
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 50,
            "line_end": 50
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 51,
            "line_end": 51
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 122,
            "line_end": 122
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 123,
            "line_end": 123
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 180,
            "line_end": 180
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 223,
            "line_end": 223
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 393,
            "line_end": 393
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 432,
            "line_end": 432
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 495,
            "line_end": 495
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 496,
            "line_end": 496
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 527,
            "line_end": 527
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 50,
            "line_end": 50
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 51,
            "line_end": 51
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 122,
            "line_end": 122
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 123,
            "line_end": 123
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 180,
            "line_end": 180
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 223,
            "line_end": 223
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 393,
            "line_end": 393
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 432,
            "line_end": 432
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 495,
            "line_end": 495
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 496,
            "line_end": 496
          },
          {
            "file": "references/sso-client-integration.md",
            "line_start": 527,
            "line_end": 527
          },
          {
            "file": "SKILL.md",
            "line_start": 138,
            "line_end": 138
          },
          {
            "file": "SKILL.md",
            "line_start": 164,
            "line_end": 164
          },
          {
            "file": "SKILL.md",
            "line_start": 166,
            "line_end": 166
          },
          {
            "file": "SKILL.md",
            "line_start": 225,
            "line_end": 225
          },
          {
            "file": "SKILL.md",
            "line_start": 244,
            "line_end": 244
          },
          {
            "file": "SKILL.md",
            "line_start": 138,
            "line_end": 138
          },
          {
            "file": "SKILL.md",
            "line_start": 164,
            "line_end": 164
          },
          {
            "file": "SKILL.md",
            "line_start": 166,
            "line_end": 166
          },
          {
            "file": "SKILL.md",
            "line_start": 225,
            "line_end": 225
          },
          {
            "file": "SKILL.md",
            "line_start": 244,
            "line_end": 244
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 5,
    "total_lines": 1735,
    "audit_model": "claude",
    "audited_at": "2026-01-16T17:45:57.210Z"
  },
  "content": {
    "user_title": "Configure Better Auth OAuth 2.1 and OIDC",
    "value_statement": "This skill helps developers implement secure OAuth 2.1 and OIDC authentication using Better Auth framework. It provides step-by-step guidance for setting up centralized authentication servers with SSO, PKCE flows, and JWKS token verification.",
    "seo_keywords": [
      "better auth oauth",
      "oidc authentication",
      "sso implementation",
      "pkce flow",
      "oauth 2.1",
      "jwks verification",
      "claude oauth",
      "codex authentication",
      "claude-code sso"
    ],
    "actual_capabilities": [
      "Set up a centralized Better Auth OAuth 2.1 / OIDC authentication server",
      "Implement SSO client integration in Next.js applications with PKCE",
      "Configure JWKS endpoint and client-side token verification",
      "Implement secure token storage with httpOnly cookies",
      "Set up email verification with SMTP or Resend providers",
      "Implement global logout across multiple applications"
    ],
    "limitations": [
      "Does not provide pre-built authentication UI components",
      "Requires existing Better Auth and database setup",
      "Does not handle custom OAuth provider integrations beyond OIDC",
      "Database schema and migration must be configured separately"
    ],
    "use_cases": [
      {
        "target_user": "Full-stack developers",
        "title": "Build SSO platform",
        "description": "Create a centralized auth server for multiple applications with proper OAuth 2.1 compliance."
      },
      {
        "target_user": "Next.js developers",
        "title": "Add SSO login",
        "description": "Integrate Better Auth SSO into Next.js apps with secure PKCE flow and token management."
      },
      {
        "target_user": "DevOps engineers",
        "title": "Configure auth infrastructure",
        "description": "Set up production-ready authentication with JWKS, email verification, and admin controls."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic Auth Setup",
        "scenario": "Start Better Auth server",
        "prompt": "Set up a Better Auth OAuth 2.1 authentication server with OIDC provider plugin, including database configuration and trusted client registration."
      },
      {
        "title": "SSO Integration",
        "scenario": "Connect Next.js app to SSO",
        "prompt": "Implement SSO client integration in a Next.js application with PKCE flow, token exchange, and httpOnly cookie storage."
      },
      {
        "title": "Token Security",
        "scenario": "Add JWKS verification",
        "prompt": "Configure JWKS endpoint and client-side token verification for Better Auth, including RS256 signing and token validation."
      },
      {
        "title": "Production Setup",
        "scenario": "Production deployment",
        "prompt": "Set up production Better Auth with email verification using Resend or SMTP, admin dashboard, and global logout functionality."
      }
    ],
    "output_examples": [
      {
        "input": "Set up Better Auth with OIDC provider",
        "output": [
          "Install dependencies: better-auth, @better-auth/oidc-provider, drizzle-orm",
          "Configure database adapter and session settings",
          "Set up trusted clients with PKCE support",
          "Add email verification with Resend or SMTP"
        ]
      },
      {
        "input": "Implement PKCE login in Next.js",
        "output": [
          "Generate cryptographically secure code verifier using crypto.getRandomValues",
          "Create SHA-256 code challenge for authorization request",
          "Store verifier in sessionStorage before redirect",
          "Exchange authorization code for tokens server-side"
        ]
      },
      {
        "input": "Verify tokens with JWKS",
        "output": [
          "Create remote JWKS endpoint pointing to auth server",
          "Use jose library for JWT verification with RS256",
          "Validate issuer and audience claims",
          "Handle token expiration and refresh gracefully"
        ]
      }
    ],
    "best_practices": [
      "Always use PKCE for public clients (SPAs, mobile apps) instead of client secrets",
      "Store tokens in httpOnly cookies with SameSite=Lax, never in localStorage",
      "Validate redirect URIs exactly and configure trusted origins for CORS",
      "Use RS256 for JWT signing with automatic JWKS key rotation"
    ],
    "anti_patterns": [
      "Storing access tokens in localStorage exposes them to XSS attacks",
      "Skipping PKCE for public clients allows authorization code interception",
      "Using weak hashing like MD5 or SHA1 for password or token operations",
      "Hardcoding secrets or credentials in source code instead of environment variables"
    ],
    "faq": [
      {
        "question": "What is Better Auth?",
        "answer": "Better Auth is a TypeScript authentication library that provides OAuth 2.1 and OIDC compliance with plugins for various providers."
      },
      {
        "question": "When should I use PKCE?",
        "answer": "Use PKCE for all public clients including SPAs and mobile apps. It replaces client secrets and prevents authorization code theft."
      },
      {
        "question": "What is JWKS?",
        "answer": "JSON Web Key Set (JWKS) is a set of public keys used to verify JWT tokens. Better Auth exposes these at the JWKS endpoint."
      },
      {
        "question": "How do I store tokens securely?",
        "answer": "Store tokens in httpOnly, Secure, SameSite=Lax cookies. Never use localStorage as it is vulnerable to XSS attacks."
      },
      {
        "question": "What is the difference between OAuth and OIDC?",
        "answer": "OAuth handles authorization (permission to access resources). OIDC adds authentication (verifying user identity) on top of OAuth."
      },
      {
        "question": "How does global logout work?",
        "answer": "Global logout redirects users to the auth server endsession endpoint, which clears the SSO session across all connected applications."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "auth-server-setup.md",
          "type": "file",
          "path": "references/auth-server-setup.md",
          "lines": 581
        },
        {
          "name": "sso-client-integration.md",
          "type": "file",
          "path": "references/sso-client-integration.md",
          "lines": 639
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "verify.py",
          "type": "file",
          "path": "scripts/verify.py",
          "lines": 21
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 285
    }
  ]
}
