{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:26:39.538Z",
    "slug": "asmayaseen-configuring-better-auth",
    "source_url": "https://github.com/Asmayaseen/hackathon-2/tree/main/.claude/skills/configuring-better-auth",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "39c8c6c4687db6f94006ce166b786f0c831c1d10ebcb72880a37b1648fc3734c",
    "tree_hash": "0da2243ca48422659c98a6c495befd60de1d520c3eb009b0899872c5de4fd25d"
  },
  "skill": {
    "name": "configuring-better-auth",
    "description": "Implement OAuth 2.1 / OIDC authentication using Better Auth with MCP assistance. Use when setting\nup a centralized auth server (SSO provider), implementing SSO clients in Next.js apps, configuring\nPKCE flows, or managing tokens with JWKS verification. Uses Better Auth MCP for guided setup.\nNOT when using simple session-only auth without OAuth/OIDC requirements.\n",
    "summary": "Implement OAuth 2.1 / OIDC authentication using Better Auth with MCP assistance. Use when setting\nup...",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "Asmayaseen",
    "license": "MIT",
    "category": "security",
    "tags": [
      "oauth",
      "oidc",
      "authentication",
      "better-auth",
      "sso"
    ],
    "supported_tools": [
      "claude",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation/reference skill with minimal executable code. The only script (verify.py) only checks for file existence without modifying anything. No network access, no sensitive data access, no external command execution. Content shows standard OAuth 2.1/OIDC security patterns.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 4,
    "total_lines": 1526,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:26:39.537Z"
  },
  "content": {
    "user_title": "Configure Better Auth OAuth/OIDC",
    "value_statement": "Setting up secure authentication with OAuth 2.1 and OIDC is complex and error-prone. This skill provides guided patterns for implementing centralized auth servers and SSO clients with PKCE flows and JWKS verification.",
    "seo_keywords": [
      "better-auth",
      "oauth-oidc",
      "authentication",
      "claude-code",
      "sso",
      "pkce",
      "jwks",
      "openid-connect",
      "nextjs-auth",
      "mcp"
    ],
    "actual_capabilities": [
      "Set up Better Auth as an OAuth 2.1/OIDC authorization server",
      "Implement PKCE authentication flows for public clients",
      "Configure JWKS for token verification",
      "Create SSO client integrations in Next.js applications",
      "Manage token storage with httpOnly cookies",
      "Implement global logout across multiple applications"
    ],
    "limitations": [
      "Does not include a working auth server implementation",
      "Does not provide credentials or secrets",
      "Does not integrate with specific identity providers directly",
      "Requires additional setup of Better Auth and database"
    ],
    "use_cases": [
      {
        "target_user": "Full-stack developers",
        "title": "Build auth server",
        "description": "Create a centralized authentication server with OIDC provider for multiple applications"
      },
      {
        "target_user": "Next.js developers",
        "title": "Add SSO login",
        "description": "Integrate OAuth 2.1 SSO login into Next.js applications with secure token handling"
      },
      {
        "target_user": "Security engineers",
        "title": "Verify auth patterns",
        "description": "Review and validate OAuth implementations using PKCE and JWKS security patterns"
      }
    ],
    "prompt_templates": [
      {
        "title": "Quick auth setup",
        "scenario": "Get started with Better Auth",
        "prompt": "Help me set up Better Auth as an OIDC provider for a new authentication server"
      },
      {
        "title": "SSO client",
        "scenario": "Connect Next.js app to auth server",
        "prompt": "How do I integrate my Next.js app as an SSO client with PKCE flow"
      },
      {
        "title": "JWKS verification",
        "scenario": "Verify tokens securely",
        "prompt": "Configure JWKS verification for tokens from the auth server"
      },
      {
        "title": "Global logout",
        "scenario": "Implement single logout",
        "prompt": "Implement global/logout across multiple applications connected to the same auth server"
      }
    ],
    "output_examples": [
      {
        "input": "Set up Better Auth as an OIDC provider",
        "output": [
          "Install dependencies: better-auth, @better-auth/oidc-provider, drizzle-orm",
          "Configure auth server with oidcProvider plugin",
          "Register OAuth clients with redirect URIs",
          "Set up PKCE for public clients",
          "Configure JWKS endpoint for token verification",
          "Add email verification with Resend or SMTP"
        ]
      }
    ],
    "best_practices": [
      "Always use PKCE for public clients (SPAs, mobile apps)",
      "Store tokens in httpOnly cookies, never in localStorage",
      "Verify tokens using JWKS from a remote endpoint",
      "Configure appropriate token expiration times (6h access, 7d refresh)"
    ],
    "anti_patterns": [
      "Storing tokens in localStorage exposes them to XSS attacks",
      "Skipping PKCE for public clients creates security vulnerabilities",
      "Using client secrets in browser code exposes credentials",
      "Not validating redirect URIs allows authorization hijacking"
    ],
    "faq": [
      {
        "question": "What databases work with Better Auth?",
        "answer": "Better Auth supports PostgreSQL, MySQL, SQLite, and MongoDB through official adapters. Drizzle ORM is recommended for PostgreSQL."
      },
      {
        "question": "How long should tokens expire?",
        "answer": "Access tokens: 1-6 hours. Refresh tokens: 7-30 days. Authorization codes: 10 minutes maximum per OAuth standard."
      },
      {
        "question": "How do I connect multiple apps to one auth server?",
        "answer": "Register each app as an OAuth client with their redirect URIs. Apps use PKCE flow to authenticate and receive tokens from the central server."
      },
      {
        "question": "Is my data safe with this skill?",
        "answer": "This skill is read-only documentation. It does not access your files, credentials, or send data anywhere. Only run code patterns in your own project."
      },
      {
        "question": "PKCE verifier is lost after redirect. What do I do?",
        "answer": "Store the PKCE verifier in a cookie before redirecting to the auth server. The cookie must be accessible by your callback endpoint."
      },
      {
        "question": "How is this different from NextAuth.js?",
        "answer": "Better Auth focuses on OAuth 2.1/OIDC with a dedicated OIDC provider plugin. NextAuth.js is simpler but less flexible for enterprise SSO scenarios."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "auth-server-setup.md",
          "type": "file",
          "path": "references/auth-server-setup.md"
        },
        {
          "name": "sso-client-integration.md",
          "type": "file",
          "path": "references/sso-client-integration.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "verify.py",
          "type": "file",
          "path": "scripts/verify.py"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
