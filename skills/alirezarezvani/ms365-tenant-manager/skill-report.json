{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T16:19:58.733Z",
    "slug": "alirezarezvani-ms365-tenant-manager",
    "source_url": "https://github.com/alirezarezvani/claude-skills/tree/main/engineering-team/ms365-tenant-manager",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "8a219cd88f0b9eeb40af161df48d786c2a2d95905dab8f50317a38f378f1d851",
    "tree_hash": "b84efe7ddcad69c39efe137b401420100582cb795ea19f3abb0dd84521c516a4"
  },
  "skill": {
    "name": "ms365-tenant-manager",
    "description": "Comprehensive Microsoft 365 tenant administration skill for setup, configuration, user management, security policies, and organizational structure optimization for Global Administrators",
    "summary": "Comprehensive Microsoft 365 tenant administration skill for setup, configuration, user management, s...",
    "icon": "☁️",
    "version": "1.0.0",
    "author": "alirezarezvani",
    "license": "MIT",
    "category": "office",
    "tags": [
      "microsoft-365",
      "tenant-management",
      "powershell",
      "administration",
      "security"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "external_commands",
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a legitimate Microsoft 365 administration skill. Static findings are false positives: PowerShell generation is expected functionality for M365 management, documentation backticks are formatting not execution, URLs point to official Microsoft resources, and security references discuss enabling protections not implementing weaknesses.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "powershell_generator.py",
            "line_start": 1,
            "line_end": 431
          },
          {
            "file": "tenant_setup.py",
            "line_start": 1,
            "line_end": 448
          },
          {
            "file": "user_management.py",
            "line_start": 1,
            "line_end": 448
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "powershell_generator.py",
            "line_start": 21,
            "line_end": 104
          },
          {
            "file": "tenant_setup.py",
            "line_start": 281,
            "line_end": 385
          },
          {
            "file": "user_management.py",
            "line_start": 23,
            "line_end": 138
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 189,
            "line_end": 197
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 218,
            "line_end": 224
          },
          {
            "file": "tenant_setup.py",
            "line_start": 42,
            "line_end": 46
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 8,
    "total_lines": 2778,
    "audit_model": "claude",
    "audited_at": "2026-01-16T16:19:58.733Z"
  },
  "content": {
    "user_title": "Manage Microsoft 365 tenants efficiently",
    "value_statement": "Microsoft 365 tenant management requires careful configuration across multiple services. This skill provides automated guidance, security policies, and PowerShell scripts for Global Administrators managing users, licenses, security, and compliance.",
    "seo_keywords": [
      "microsoft 365 management",
      "m365 tenant admin",
      "claude code skill",
      "powershell automation",
      "user provisioning",
      "license management",
      "conditional access",
      "security compliance",
      "claude",
      "codex"
    ],
    "actual_capabilities": [
      "Generate comprehensive tenant setup checklists with DNS records and security baselines",
      "Create PowerShell scripts for bulk user creation, modification, and offboarding",
      "Build Conditional Access policies and security audit reports",
      "Recommend license assignments based on user roles and departments",
      "Produce compliance documentation for GDPR, HIPAA, and security frameworks"
    ],
    "limitations": [
      "Requires Global Administrator or appropriate role-based permissions to execute generated scripts",
      "Cannot access tenant directly - generates scripts and guidance for manual implementation",
      "PowerShell modules must be installed locally (Microsoft.Graph, ExchangeOnlineManagement, MicrosoftTeams)",
      "Some compliance features require specific license tiers (E3, E5)"
    ],
    "use_cases": [
      {
        "target_user": "IT Administrators",
        "title": "Automate tenant configuration",
        "description": "Generate complete setup guides and PowerShell scripts for new Microsoft 365 tenants with security best practices."
      },
      {
        "target_user": "Security Teams",
        "title": "Implement access policies",
        "description": "Create Conditional Access policies requiring MFA and generate security audit scripts for compliance reporting."
      },
      {
        "target_user": "HR Managers",
        "title": "Streamline user lifecycle",
        "description": "Produce bulk user provisioning and offboarding scripts with license management and mailbox handling."
      }
    ],
    "prompt_templates": [
      {
        "title": "New tenant setup",
        "scenario": "Setting up a new Microsoft 365 environment",
        "prompt": "Create a complete Microsoft 365 tenant setup guide for a 50-person company including DNS records, security baseline, and recommended license distribution."
      },
      {
        "title": "Bulk user creation",
        "scenario": "Provisioning multiple users from CSV",
        "prompt": "Generate a PowerShell script to create 25 new users from a CSV file and assign Microsoft 365 Business Standard licenses to each."
      },
      {
        "title": "Security hardening",
        "scenario": "Auditing tenant security posture",
        "prompt": "Create a security audit script that checks MFA status, admin role assignments, inactive users, and Conditional Access policies."
      },
      {
        "title": "License optimization",
        "scenario": "Analyzing and reducing license costs",
        "prompt": "Analyze license usage and recommend cost optimization for 100 users while maintaining necessary features for each department."
      }
    ],
    "output_examples": [
      {
        "input": "Create a secure offboarding script for user john.doe@company.com",
        "output": [
          "PowerShell script that disables the account, revokes sessions, converts mailbox to shared, removes licenses, hides from GAL, and configures auto-reply",
          "Step-by-step offboarding checklist with audit trail documentation",
          "Recommendations for OneDrive archival and resource transfer"
        ]
      },
      {
        "input": "What DNS records do I need for my custom domain acme.com?",
        "output": [
          "MX record: acme-com.mail.protection.outlook.com (priority 0)",
          "TXT records: SPF (v=spf1 include:spf.protection.outlook.com -all) and domain verification",
          "CNAME records: autodiscover, selector1/selector2._domainkey, msoid, enterpriseregistration, enterpriseenrollment",
          "SRV records: _sip._tls and _sipfederationtls._tcp for Teams federation"
        ]
      },
      {
        "input": "Configure Conditional Access requiring MFA for all admin accounts",
        "output": [
          "Ready-to-use PowerShell script using Microsoft Graph API",
          "Policy configured in report-only mode for testing before enforcement",
          "Includes user exclusion capability and detailed logging",
          "Next steps: review in Azure AD portal and monitor sign-in logs"
        ]
      }
    ],
    "best_practices": [
      "Always test generated scripts in a non-production environment before running them in production",
      "Review and understand each script before execution - the skill generates scripts for admin review",
      "Use Azure Key Vault or managed identities for authentication, never hardcode credentials in scripts"
    ],
    "anti_patterns": [
      "Running generated scripts without reading and understanding what each command does",
      "Executing scripts with Global Administrator when more limited permissions would suffice",
      "Skipping the dry-run mode (-WhatIf) when available for destructive operations"
    ],
    "faq": [
      {
        "question": "Does this skill execute PowerShell commands directly?",
        "answer": "No. The skill generates PowerShell scripts and guidance as output. You review the scripts before running them yourself."
      },
      {
        "question": "What permissions do I need to run the generated scripts?",
        "answer": "Permissions vary by task. User management needs User Administrator. Security policies need Security Administrator. Full tenant setup needs Global Administrator."
      },
      {
        "question": "Can this skill connect to my tenant?",
        "answer": "No. This skill generates scripts and documentation. You run the scripts locally with your credentials after reviewing them."
      },
      {
        "question": "Which PowerShell modules are required?",
        "answer": "The main modules are Microsoft.Graph for Graph API, ExchangeOnlineManagement for Exchange, and MicrosoftTeams for Teams administration."
      },
      {
        "question": "Is this skill compliant with GDPR and HIPAA?",
        "answer": "The skill can generate compliance-focused configurations and reports. Actual compliance depends on your specific implementation and policies."
      },
      {
        "question": "Can I use this for hybrid AD environments?",
        "answer": "The skill focuses on cloud-only scenarios. Hybrid environments require additional AD Connect configuration not covered by this skill."
      }
    ]
  },
  "file_structure": [
    {
      "name": "expected_output.json",
      "type": "file",
      "path": "expected_output.json",
      "lines": 87
    },
    {
      "name": "HOW_TO_USE.md",
      "type": "file",
      "path": "HOW_TO_USE.md",
      "lines": 234
    },
    {
      "name": "powershell_generator.py",
      "type": "file",
      "path": "powershell_generator.py",
      "lines": 431
    },
    {
      "name": "sample_input.json",
      "type": "file",
      "path": "sample_input.json",
      "lines": 22
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 197
    },
    {
      "name": "tenant_setup.py",
      "type": "file",
      "path": "tenant_setup.py",
      "lines": 448
    },
    {
      "name": "user_management.py",
      "type": "file",
      "path": "user_management.py",
      "lines": 448
    }
  ]
}
