vulnerability,language,unsafe_pattern,safe_fix,explanation,test_template
sql-injection,javascript,"db.query(`SELECT * FROM users WHERE id = ${id}`)","db.query('SELECT * FROM users WHERE id = $1', [id])","Use parameterized queries to prevent SQL injection","test('should prevent SQL injection', () => { expect(() => query(userId)).not.toThrow(); });"
xss,javascript,"element.innerHTML = userInput","element.textContent = userInput","Use textContent to prevent XSS attacks","test('should escape HTML', () => { expect(element.innerHTML).not.toContain('<script>'); });"
command-injection,python,"os.system(f'ls {user_dir}')","subprocess.run(['ls', user_dir], check=True)","Use subprocess with list arguments","def test_no_injection(): assert subprocess.run(['ls', 'test']) is not None"
weak-crypto,javascript,"crypto.createHash('md5')","crypto.createHash('sha256')","Use SHA-256 or stronger algorithms","test('should use strong hash', () => { expect(hash.algorithm).toBe('sha256'); });"
hardcoded-secret,javascript,"const API_KEY = 'sk-1234'","const API_KEY = process.env.API_KEY","Use environment variables for secrets","test('should load from env', () => { expect(process.env.API_KEY).toBeDefined(); });"
path-traversal,javascript,"fs.readFile(userPath)","const safe = path.resolve(baseDir, path.normalize(userPath).replace(/^(\\.\\.[/\\\\])+/, ''))","Validate and sanitize file paths","test('should prevent traversal', () => { expect(safePath).not.toContain('..'); });"
csrf,javascript,"app.post('/transfer', handler)","app.post('/transfer', csrf(), handler)","Add CSRF protection middleware","test('should require CSRF token', async () => { const res = await request(app).post('/transfer'); expect(res.status).toBe(403); });"
deserialization,python,"pickle.loads(user_data)","json.loads(user_data)","Use JSON instead of pickle for user data","def test_safe_deserialize(): assert json.loads(data) is not None"
jwt-confusion,javascript,"jwt.verify(token, secret)","jwt.verify(token, secret, { algorithms: ['HS256'] })","Explicitly specify allowed algorithms","test('should enforce algorithm', () => { expect(() => verify(token)).not.toThrow(); });"
ssrf,javascript,"fetch(`http://${userUrl}`)","fetch(userUrl).then(res => { if (!isAllowedDomain(res.url)) throw new Error(); })","Validate URLs and whitelist domains","test('should block SSRF', async () => { await expect(fetch('http://internal')).rejects.toThrow(); });"
