{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T16:16:04.051Z",
    "slug": "agentsecops-sca-trivy",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/devsecops/sca-trivy",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "b20163e934407c438296a480fce6da4e1e817db39e95c051964e5a7c271151c1",
    "tree_hash": "d6fe181aeb06cd73264659e2de1484c3b155b4b843d512cc1e302c8ccacc1ea4"
  },
  "skill": {
    "name": "sca-trivy",
    "description": "Software Composition Analysis (SCA) and container vulnerability scanning using Aqua Trivy for identifying CVE vulnerabilities in dependencies, container images, IaC misconfigurations, and license compliance risks. Use when: (1) Scanning container images and filesystems for vulnerabilities and misconfigurations, (2) Analyzing dependencies for known CVEs across multiple languages (Go, Python, Node.js, Java, etc.), (3) Detecting IaC security issues in Terraform, Kubernetes, Dockerfile, (4) Integrating vulnerability scanning into CI/CD pipelines with SARIF output, (5) Generating Software Bill of Materials (SBOM) in CycloneDX or SPDX format, (6) Prioritizing remediation by CVSS score and exploitability.\n",
    "summary": "Software Composition Analysis (SCA) and container vulnerability scanning using Aqua Trivy for identi...",
    "icon": "üõ°Ô∏è",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "MIT",
    "category": "devsecops",
    "tags": [
      "sca",
      "trivy",
      "container-security",
      "vulnerability-scanning",
      "sbom",
      "iac-security",
      "dependency-scanning",
      "cvss"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Documentation-only skill containing markdown guides for Trivy vulnerability scanner usage. No executable code present. This is a knowledge-base skill providing standardized workflows for identifying CVEs, generating SBOMs, and integrating security scanning into CI/CD pipelines. All 86 static findings are false positives - the analyzer misinterpreted documentation examples and legitimate security/compliance terminology as security threats.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          },
          {
            "file": "SKILL.md",
            "line_start": 20,
            "line_end": 20
          },
          {
            "file": "SKILL.md",
            "line_start": 21,
            "line_end": 21
          },
          {
            "file": "SKILL.md",
            "line_start": 22,
            "line_end": 22
          },
          {
            "file": "SKILL.md",
            "line_start": 23,
            "line_end": 23
          },
          {
            "file": "SKILL.md",
            "line_start": 452,
            "line_end": 452
          },
          {
            "file": "SKILL.md",
            "line_start": 453,
            "line_end": 453
          },
          {
            "file": "SKILL.md",
            "line_start": 454,
            "line_end": 454
          },
          {
            "file": "SKILL.md",
            "line_start": 455,
            "line_end": 455
          },
          {
            "file": "SKILL.md",
            "line_start": 456,
            "line_end": 456
          },
          {
            "file": "SKILL.md",
            "line_start": 457,
            "line_end": 457
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 39,
            "line_end": 56
          },
          {
            "file": "SKILL.md",
            "line_start": 56,
            "line_end": 64
          },
          {
            "file": "SKILL.md",
            "line_start": 64,
            "line_end": 76
          },
          {
            "file": "SKILL.md",
            "line_start": 76,
            "line_end": 88
          },
          {
            "file": "SKILL.md",
            "line_start": 88,
            "line_end": 93
          },
          {
            "file": "SKILL.md",
            "line_start": 93,
            "line_end": 101
          },
          {
            "file": "SKILL.md",
            "line_start": 101,
            "line_end": 113
          },
          {
            "file": "SKILL.md",
            "line_start": 113,
            "line_end": 124
          },
          {
            "file": "SKILL.md",
            "line_start": 124,
            "line_end": 147
          },
          {
            "file": "SKILL.md",
            "line_start": 147,
            "line_end": 151
          },
          {
            "file": "SKILL.md",
            "line_start": 151,
            "line_end": 162
          },
          {
            "file": "SKILL.md",
            "line_start": 162,
            "line_end": 164
          },
          {
            "file": "SKILL.md",
            "line_start": 164,
            "line_end": 170
          },
          {
            "file": "SKILL.md",
            "line_start": 170,
            "line_end": 179
          },
          {
            "file": "SKILL.md",
            "line_start": 179,
            "line_end": 194
          },
          {
            "file": "SKILL.md",
            "line_start": 194,
            "line_end": 223
          },
          {
            "file": "SKILL.md",
            "line_start": 223,
            "line_end": 225
          },
          {
            "file": "SKILL.md",
            "line_start": 225,
            "line_end": 226
          },
          {
            "file": "SKILL.md",
            "line_start": 226,
            "line_end": 227
          },
          {
            "file": "SKILL.md",
            "line_start": 227,
            "line_end": 228
          },
          {
            "file": "SKILL.md",
            "line_start": 228,
            "line_end": 230
          },
          {
            "file": "SKILL.md",
            "line_start": 230,
            "line_end": 232
          },
          {
            "file": "SKILL.md",
            "line_start": 232,
            "line_end": 233
          },
          {
            "file": "SKILL.md",
            "line_start": 233,
            "line_end": 234
          },
          {
            "file": "SKILL.md",
            "line_start": 234,
            "line_end": 235
          },
          {
            "file": "SKILL.md",
            "line_start": 235,
            "line_end": 237
          },
          {
            "file": "SKILL.md",
            "line_start": 237,
            "line_end": 239
          },
          {
            "file": "SKILL.md",
            "line_start": 239,
            "line_end": 240
          },
          {
            "file": "SKILL.md",
            "line_start": 240,
            "line_end": 241
          },
          {
            "file": "SKILL.md",
            "line_start": 241,
            "line_end": 242
          },
          {
            "file": "SKILL.md",
            "line_start": 242,
            "line_end": 243
          },
          {
            "file": "SKILL.md",
            "line_start": 243,
            "line_end": 251
          },
          {
            "file": "SKILL.md",
            "line_start": 251,
            "line_end": 266
          },
          {
            "file": "SKILL.md",
            "line_start": 266,
            "line_end": 272
          },
          {
            "file": "SKILL.md",
            "line_start": 272,
            "line_end": 279
          },
          {
            "file": "SKILL.md",
            "line_start": 279,
            "line_end": 285
          },
          {
            "file": "SKILL.md",
            "line_start": 285,
            "line_end": 291
          },
          {
            "file": "SKILL.md",
            "line_start": 291,
            "line_end": 302
          },
          {
            "file": "SKILL.md",
            "line_start": 302,
            "line_end": 309
          },
          {
            "file": "SKILL.md",
            "line_start": 309,
            "line_end": 315
          },
          {
            "file": "SKILL.md",
            "line_start": 315,
            "line_end": 343
          },
          {
            "file": "SKILL.md",
            "line_start": 343,
            "line_end": 344
          },
          {
            "file": "SKILL.md",
            "line_start": 344,
            "line_end": 345
          },
          {
            "file": "SKILL.md",
            "line_start": 345,
            "line_end": 347
          },
          {
            "file": "SKILL.md",
            "line_start": 347,
            "line_end": 354
          },
          {
            "file": "SKILL.md",
            "line_start": 354,
            "line_end": 355
          },
          {
            "file": "SKILL.md",
            "line_start": 355,
            "line_end": 356
          },
          {
            "file": "SKILL.md",
            "line_start": 356,
            "line_end": 357
          },
          {
            "file": "SKILL.md",
            "line_start": 357,
            "line_end": 358
          },
          {
            "file": "SKILL.md",
            "line_start": 358,
            "line_end": 369
          },
          {
            "file": "SKILL.md",
            "line_start": 369,
            "line_end": 376
          },
          {
            "file": "SKILL.md",
            "line_start": 376,
            "line_end": 388
          },
          {
            "file": "SKILL.md",
            "line_start": 388,
            "line_end": 394
          },
          {
            "file": "SKILL.md",
            "line_start": 394,
            "line_end": 396
          },
          {
            "file": "SKILL.md",
            "line_start": 396,
            "line_end": 416
          },
          {
            "file": "SKILL.md",
            "line_start": 416,
            "line_end": 418
          },
          {
            "file": "SKILL.md",
            "line_start": 418,
            "line_end": 422
          },
          {
            "file": "SKILL.md",
            "line_start": 422,
            "line_end": 424
          },
          {
            "file": "SKILL.md",
            "line_start": 424,
            "line_end": 434
          },
          {
            "file": "SKILL.md",
            "line_start": 434,
            "line_end": 440
          },
          {
            "file": "SKILL.md",
            "line_start": 440,
            "line_end": 448
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 408,
            "line_end": 408
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 640,
    "audit_model": "claude",
    "audited_at": "2026-01-16T16:16:04.051Z"
  },
  "content": {
    "user_title": "Scan containers and dependencies for vulnerabilities",
    "value_statement": "Manual dependency and container vulnerability scanning requires significant security expertise to interpret CVE reports and prioritize fixes. This skill provides standardized Trivy workflows for identifying CVEs, generating SBOMs, and integrating security scanning into CI/CD pipelines.",
    "seo_keywords": [
      "trivy sca",
      "container vulnerability scanner",
      "cve scanning",
      "dependency vulnerability",
      "sbom generation",
      "claude code security",
      "claude security scanning",
      "codex vulnerability",
      "iac security scanning",
      "trivy ci cd"
    ],
    "actual_capabilities": [
      "Scan container images for CVE vulnerabilities by severity level",
      "Analyze project dependencies across multiple languages (Go, Python, Node.js, Java)",
      "Detect IaC misconfigurations in Terraform, Kubernetes, and Dockerfiles",
      "Generate Software Bill of Materials in CycloneDX or SPDX format",
      "Create SARIF reports for GitHub Security tab integration",
      "Prioritize vulnerabilities using CVSS scores and exploitability data"
    ],
    "limitations": [
      "Does not install Trivy; users must install it separately",
      "Does not execute scans automatically; provides command templates only",
      "Does not fix vulnerabilities; only identifies and reports them",
      "Does not integrate with private container registries without manual configuration"
    ],
    "use_cases": [
      {
        "target_user": "Security engineers",
        "title": "Container security assessment",
        "description": "Run comprehensive scans on container images to identify critical vulnerabilities before deployment to production"
      },
      {
        "target_user": "DevOps engineers",
        "title": "CI/CD pipeline security",
        "description": "Integrate vulnerability scanning into GitHub Actions or GitLab CI pipelines with SARIF output and security gates"
      },
      {
        "target_user": "Compliance officers",
        "title": "SBOM documentation",
        "description": "Generate software bill of materials to meet regulatory requirements and track component provenance"
      }
    ],
    "prompt_templates": [
      {
        "title": "Quick image scan",
        "scenario": "Scan a container image",
        "prompt": "Scan the container image nginx:latest for vulnerabilities using Trivy and show findings by severity level"
      },
      {
        "title": "Dependency audit",
        "scenario": "Check project dependencies",
        "prompt": "Run Trivy filesystem scan on my project to identify vulnerable dependencies with CVSS scores above 7.0"
      },
      {
        "title": "IaC security scan",
        "scenario": "Scan infrastructure code",
        "prompt": "Scan my Terraform configurations in the infrastructure/ directory for security misconfigurations using Trivy"
      },
      {
        "title": "Generate SBOM",
        "scenario": "Create software bill of materials",
        "prompt": "Generate a CycloneDX SBOM for my application and save it to sbom.json using Trivy"
      }
    ],
    "output_examples": [
      {
        "input": "Scan nginx:latest for critical and high severity vulnerabilities",
        "output": [
          "Critical: 3 vulnerabilities found",
          "  - CVE-2024-39338 (CVSS 9.8): PostgreSQL out-of-bounds write in libpq",
          "  - CVE-2024-4741 (CVSS 9.8): OpenSSL use after free in SSL_read",
          "High: 7 vulnerabilities found",
          "  - CVE-2024-24786 (CVSS 7.5): Buffer overrun in Google ProtoBuf",
          "Remediation: Update base image to nginx:1.25-alpine or later"
        ]
      },
      {
        "input": "Find vulnerabilities in my Node.js project dependencies",
        "output": [
          "Scan results for ./package-lock.json:",
          "MEDIUM: 12 vulnerabilities found",
          "  - CVE-2024-37890 (CVSS 7.5): Prototype pollution in package-name",
          "  - CVE-2024-21538 (CVSS 6.1): XSS vulnerability in dependency",
          "Remediation: Run npm update to patch affected packages"
        ]
      },
      {
        "input": "Check Terraform files for security issues",
        "output": [
          "IaC Misconfigurations in terraform/:",
          "HIGH: 2 findings",
          "  - K8s privilege escalation: Deployment runs privileged container",
          "  - CIS benchmark: root user specified in container",
          "MEDIUM: 4 findings",
          "  - Resource limits not specified",
          "  - Missing network policy"
        ]
      }
    ],
    "best_practices": [
      "Run Trivy scans in CI/CD pipelines before deploying to production environments",
      "Use severity filtering (CRITICAL,HIGH) to focus on actionable findings initially",
      "Generate SBOMs during build time for supply chain transparency and incident response"
    ],
    "anti_patterns": [
      "Scanning production images without first building and testing in staging environments",
      "Ignoring false positive rates without documenting accepted risks in .trivyignore",
      "Running scans without caching the vulnerability database for faster subsequent scans"
    ],
    "faq": [
      {
        "question": "Which languages does Trivy support for dependency scanning?",
        "answer": "Trivy supports Go, Python, Node.js, Java, .NET, PHP, Ruby, Rust, and many other languages through package manifest files."
      },
      {
        "question": "What is the minimum Trivy version required for SARIF output?",
        "answer": "Trivy v0.31.0 or later supports SARIF format output for integration with GitHub Security tab."
      },
      {
        "question": "How do I integrate Trivy scans into my existing CI/CD pipeline?",
        "answer": "Use the aquasecurity/trivy-action for GitHub Actions or run trivy CLI directly in any CI system with JSON or SARIF output."
      },
      {
        "question": "Is my scan data sent to external servers?",
        "answer": "By default, Trivy downloads its vulnerability database from GitHub but scan results stay local. Configure offline mode for air-gapped environments."
      },
      {
        "question": "Why am I seeing false positives in my scan results?",
        "answer": "False positives occur when CVEs apply to different versions or contexts. Use .trivyignore files to suppress confirmed false positives with justification."
      },
      {
        "question": "How does Trivy compare to other SCA tools like Snyk or OWASP Dependency-Check?",
        "answer": "Trivy is open-source, fast, and covers containers, IaC, and dependencies. Snyk offers more integrations; Dependency-Check has broader language support but slower scans."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 458
    }
  ]
}
