{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:42:42.494Z",
    "slug": "agentsecops-ir-velociraptor",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/incident-response/ir-velociraptor",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "bb1f3f709c90340339415916060091aebb532f3691b0bf8f8429e6e41a3e720f",
    "tree_hash": "94c8065c35ce75c293a9dc51203188516a3936c8b27668fe9ff8895595e448d4"
  },
  "skill": {
    "name": "ir-velociraptor",
    "description": "Endpoint visibility, digital forensics, and incident response using Velociraptor Query Language (VQL) for evidence collection and threat hunting at scale. Use when: (1) Conducting forensic investigations across multiple endpoints, (2) Hunting for indicators of compromise or suspicious activities, (3) Collecting endpoint telemetry and artifacts for incident analysis, (4) Performing live response and evidence preservation, (5) Monitoring endpoints for security events, (6) Creating custom forensic artifacts for specific threat scenarios.\n",
    "summary": "Endpoint visibility, digital forensics, and incident response using Velociraptor Query Language (VQL...",
    "icon": "üîç",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "MIT",
    "category": "incident-response",
    "tags": [
      "forensics",
      "incident-response",
      "endpoint-detection",
      "threat-hunting",
      "vql",
      "dfir",
      "live-response",
      "evidence-collection"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation skill containing only markdown reference files and YAML templates. No executable code, no network calls, no file system access, no command execution. Legitimate Velociraptor DFIR documentation for incident response professionals.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 12,
    "total_lines": 4778,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:42:42.494Z"
  },
  "content": {
    "user_title": "Collect endpoint evidence with Velociraptor VQL",
    "value_statement": "Conduct forensic investigations and threat hunting across enterprise endpoints. Use VQL queries to collect process artifacts, network connections, registry data, and event logs for incident analysis and compromise detection.",
    "seo_keywords": [
      "velociraptor",
      "incident response",
      "digital forensics",
      "endpoint detection",
      "threat hunting",
      "VQL queries",
      "MITRE ATT&CK",
      "evidence collection",
      "forensic artifacts",
      "Claite Code"
    ],
    "actual_capabilities": [
      "Create VQL queries for process and network investigation",
      "Collect forensic artifacts from Windows endpoints",
      "Map threat indicators to MITRE ATT&CK techniques",
      "Build custom Velociraptor hunt configurations",
      "Develop offline collectors for air-gapped investigations",
      "Deploy enterprise Velociraptor server infrastructure"
    ],
    "limitations": [
      "Requires Velociraptor binary to be installed separately",
      "No actual endpoint access without Velociraptor deployment",
      "Linux and macOS support is secondary to Windows focus",
      "Does not perform live memory acquisition"
    ],
    "use_cases": [
      {
        "target_user": "Incident Responders",
        "title": "Investigate security breaches",
        "description": "Collect and analyze forensic evidence to determine scope and root cause of security incidents"
      },
      {
        "target_user": "Threat Hunters",
        "title": "Proactively hunt for threats",
        "description": "Deploy organization-wide hunts to detect suspicious process execution and persistence mechanisms"
      },
      {
        "target_user": "Security Analysts",
        "title": "Build forensic artifacts",
        "description": "Create custom VQL artifacts tailored to specific threat scenarios and detection requirements"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic VQL Query",
        "scenario": "Process investigation",
        "prompt": "Write a VQL query to find processes running from temp directories with obfuscated command lines"
      },
      {
        "title": "Registry Persistence",
        "scenario": "Detect autoruns",
        "prompt": "Show me the VQL to hunt for suspicious registry run keys and startup locations"
      },
      {
        "title": "Threat Hunt",
        "scenario": "MITRE ATT&CK mapping",
        "prompt": "What VQL queries detect PowerShell execution techniques mapped to ATT&CK T1059.001"
      },
      {
        "title": "Artifact Development",
        "scenario": "Custom collection",
        "prompt": "Create a custom Velociraptor artifact YAML that collects recent executables with SHA256 hashes"
      }
    ],
    "output_examples": [
      {
        "input": "Find processes with suspicious parent-child relationships indicating potential injection",
        "output": [
          "Processes spawned by Office applications running PowerShell or cmd.exe",
          "Processes from AppData/Temp directories with hidden or bypass flags",
          "LOLBin abuse (certutil, bitsadmin, mshta) for code execution",
          "Memory regions with RWX protections in non-JIT processes"
        ]
      }
    ],
    "best_practices": [
      "Use preconditions to verify OS compatibility before artifact execution",
      "Implement rate limiting and CPU limits to prevent endpoint performance impact",
      "Document chain of custody and investigation scope for compliance",
      "Hash all collected evidence to maintain integrity verification"
    ],
    "anti_patterns": [
      "Running filesystem glob queries without time or size limits",
      "Collecting all artifacts without defining specific investigation scope",
      "Ignoring preconditions that may cause artifacts to fail on incompatible systems",
      "Storing collected evidence without encryption or access controls"
    ],
    "faq": [
      {
        "question": "What platforms does Velociraptor support?",
        "answer": "Windows (primary), Linux, and macOS. Most artifacts target Windows for enterprise incident response."
      },
      {
        "question": "How many endpoints can Velociraptor manage?",
        "answer": "Single server handles up to 10,000 clients. Multi-frontend deployments support 100,000+ endpoints."
      },
      {
        "question": "Can Velociraptor work offline?",
        "answer": "Yes. Offline collectors can gather evidence without server connectivity for air-gapped or initial triage scenarios."
      },
      {
        "question": "Is collected data encrypted?",
        "answer": "Enable encryption in collector configuration. Use TLS for server communications and secure output storage."
      },
      {
        "question": "Why are queries returning no results?",
        "answer": "Verify path syntax uses forward slashes, test queries in notebook mode first, and check client permissions."
      },
      {
        "question": "How does this compare to commercial EDR?",
        "answer": "Velociraptor provides deeper forensic capabilities and customization. Best used alongside EDR for comprehensive coverage."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "artifact-template.yaml",
          "type": "file",
          "path": "assets/artifact-template.yaml"
        },
        {
          "name": "ci-config-template.yml",
          "type": "file",
          "path": "assets/ci-config-template.yml"
        },
        {
          "name": "hunt-template.yaml",
          "type": "file",
          "path": "assets/hunt-template.yaml"
        },
        {
          "name": "offline-collector-config.yaml",
          "type": "file",
          "path": "assets/offline-collector-config.yaml"
        },
        {
          "name": "rule-template.yaml",
          "type": "file",
          "path": "assets/rule-template.yaml"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "artifact-development.md",
          "type": "file",
          "path": "references/artifact-development.md"
        },
        {
          "name": "deployment-guide.md",
          "type": "file",
          "path": "references/deployment-guide.md"
        },
        {
          "name": "EXAMPLE.md",
          "type": "file",
          "path": "references/EXAMPLE.md"
        },
        {
          "name": "mitre-attack-mapping.md",
          "type": "file",
          "path": "references/mitre-attack-mapping.md"
        },
        {
          "name": "vql-patterns.md",
          "type": "file",
          "path": "references/vql-patterns.md"
        },
        {
          "name": "WORKFLOW_CHECKLIST.md",
          "type": "file",
          "path": "references/WORKFLOW_CHECKLIST.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
