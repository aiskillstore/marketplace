{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T15:54:33.330Z",
    "slug": "agentsecops-pytm",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/threatmodel/pytm",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "7ed749d4b32bc0b8cf7736be83b43377fcb2b97a021cec3bfa76d3084afe526c",
    "tree_hash": "546528e3700e27893a280d7d76fefacb622cc948bd16d242a523a1c3d7e551dc"
  },
  "skill": {
    "name": "pytm",
    "description": "Python-based threat modeling using pytm library for programmatic STRIDE analysis, data flow diagram generation, and automated security threat identification. Use when: (1) Creating threat models programmatically using Python code, (2) Generating data flow diagrams (DFDs) with automatic STRIDE threat identification, (3) Integrating threat modeling into CI/CD pipelines and shift-left security practices, (4) Analyzing system architecture for security threats across trust boundaries, (5) Producing threat reports with STRIDE categories and mitigation recommendations, (6) Maintaining threat models as code for version control and automation.\n",
    "summary": "Python-based threat modeling using pytm library for programmatic STRIDE analysis, data flow diagram ...",
    "icon": "üõ°Ô∏è",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "MIT",
    "category": "threatmodel",
    "tags": [
      "threat-modeling",
      "stride",
      "dfd",
      "security-architecture",
      "pytm",
      "appsec",
      "risk-analysis"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation skill containing only YAML frontmatter and markdown documentation teaching threat modeling concepts with the pytm library. No executable code, scripts, network calls, filesystem access, environment variable reads, or command execution capabilities are present. All static findings are false positives triggered by documentation patterns, not actual security risks.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          },
          {
            "file": "SKILL.md",
            "line_start": 21,
            "line_end": 21
          },
          {
            "file": "SKILL.md",
            "line_start": 22,
            "line_end": 22
          },
          {
            "file": "SKILL.md",
            "line_start": 23,
            "line_end": 23
          },
          {
            "file": "SKILL.md",
            "line_start": 24,
            "line_end": 24
          },
          {
            "file": "SKILL.md",
            "line_start": 569,
            "line_end": 569
          },
          {
            "file": "SKILL.md",
            "line_start": 570,
            "line_end": 570
          },
          {
            "file": "SKILL.md",
            "line_start": 571,
            "line_end": 571
          },
          {
            "file": "SKILL.md",
            "line_start": 572,
            "line_end": 572
          },
          {
            "file": "SKILL.md",
            "line_start": 573,
            "line_end": 573
          },
          {
            "file": "SKILL.md",
            "line_start": 574,
            "line_end": 574
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 41,
            "line_end": 76
          },
          {
            "file": "SKILL.md",
            "line_start": 76,
            "line_end": 79
          },
          {
            "file": "SKILL.md",
            "line_start": 79,
            "line_end": 84
          },
          {
            "file": "SKILL.md",
            "line_start": 84,
            "line_end": 95
          },
          {
            "file": "SKILL.md",
            "line_start": 95,
            "line_end": 97
          },
          {
            "file": "SKILL.md",
            "line_start": 97,
            "line_end": 114
          },
          {
            "file": "SKILL.md",
            "line_start": 114,
            "line_end": 116
          },
          {
            "file": "SKILL.md",
            "line_start": 116,
            "line_end": 123
          },
          {
            "file": "SKILL.md",
            "line_start": 123,
            "line_end": 163
          },
          {
            "file": "SKILL.md",
            "line_start": 163,
            "line_end": 169
          },
          {
            "file": "SKILL.md",
            "line_start": 169,
            "line_end": 201
          },
          {
            "file": "SKILL.md",
            "line_start": 201,
            "line_end": 207
          },
          {
            "file": "SKILL.md",
            "line_start": 207,
            "line_end": 216
          },
          {
            "file": "SKILL.md",
            "line_start": 216,
            "line_end": 260
          },
          {
            "file": "SKILL.md",
            "line_start": 260,
            "line_end": 262
          },
          {
            "file": "SKILL.md",
            "line_start": 262,
            "line_end": 263
          },
          {
            "file": "SKILL.md",
            "line_start": 263,
            "line_end": 264
          },
          {
            "file": "SKILL.md",
            "line_start": 264,
            "line_end": 265
          },
          {
            "file": "SKILL.md",
            "line_start": 265,
            "line_end": 267
          },
          {
            "file": "SKILL.md",
            "line_start": 267,
            "line_end": 269
          },
          {
            "file": "SKILL.md",
            "line_start": 269,
            "line_end": 270
          },
          {
            "file": "SKILL.md",
            "line_start": 270,
            "line_end": 271
          },
          {
            "file": "SKILL.md",
            "line_start": 271,
            "line_end": 272
          },
          {
            "file": "SKILL.md",
            "line_start": 272,
            "line_end": 274
          },
          {
            "file": "SKILL.md",
            "line_start": 274,
            "line_end": 276
          },
          {
            "file": "SKILL.md",
            "line_start": 276,
            "line_end": 277
          },
          {
            "file": "SKILL.md",
            "line_start": 277,
            "line_end": 278
          },
          {
            "file": "SKILL.md",
            "line_start": 278,
            "line_end": 279
          },
          {
            "file": "SKILL.md",
            "line_start": 279,
            "line_end": 280
          },
          {
            "file": "SKILL.md",
            "line_start": 280,
            "line_end": 286
          },
          {
            "file": "SKILL.md",
            "line_start": 286,
            "line_end": 325
          },
          {
            "file": "SKILL.md",
            "line_start": 325,
            "line_end": 329
          },
          {
            "file": "SKILL.md",
            "line_start": 329,
            "line_end": 361
          },
          {
            "file": "SKILL.md",
            "line_start": 361,
            "line_end": 367
          },
          {
            "file": "SKILL.md",
            "line_start": 367,
            "line_end": 385
          },
          {
            "file": "SKILL.md",
            "line_start": 385,
            "line_end": 391
          },
          {
            "file": "SKILL.md",
            "line_start": 391,
            "line_end": 400
          },
          {
            "file": "SKILL.md",
            "line_start": 400,
            "line_end": 441
          },
          {
            "file": "SKILL.md",
            "line_start": 441,
            "line_end": 442
          },
          {
            "file": "SKILL.md",
            "line_start": 442,
            "line_end": 442
          },
          {
            "file": "SKILL.md",
            "line_start": 442,
            "line_end": 445
          },
          {
            "file": "SKILL.md",
            "line_start": 445,
            "line_end": 452
          },
          {
            "file": "SKILL.md",
            "line_start": 452,
            "line_end": 462
          },
          {
            "file": "SKILL.md",
            "line_start": 462,
            "line_end": 470
          },
          {
            "file": "SKILL.md",
            "line_start": 470,
            "line_end": 471
          },
          {
            "file": "SKILL.md",
            "line_start": 471,
            "line_end": 472
          },
          {
            "file": "SKILL.md",
            "line_start": 472,
            "line_end": 483
          },
          {
            "file": "SKILL.md",
            "line_start": 483,
            "line_end": 491
          },
          {
            "file": "SKILL.md",
            "line_start": 491,
            "line_end": 515
          },
          {
            "file": "SKILL.md",
            "line_start": 515,
            "line_end": 521
          },
          {
            "file": "SKILL.md",
            "line_start": 521,
            "line_end": 546
          },
          {
            "file": "SKILL.md",
            "line_start": 546,
            "line_end": 552
          },
          {
            "file": "SKILL.md",
            "line_start": 552,
            "line_end": 565
          },
          {
            "file": "SKILL.md",
            "line_start": 188,
            "line_end": 188
          },
          {
            "file": "SKILL.md",
            "line_start": 458,
            "line_end": 458
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 758,
    "audit_model": "claude",
    "audited_at": "2026-01-16T15:54:33.330Z"
  },
  "content": {
    "user_title": "Create threat models with Python and STRIDE analysis",
    "value_statement": "Threat modeling is critical for secure system design but often gets skipped due to complexity. This skill provides programmatic threat modeling using Python and the pytm library. Define architecture as code, automatically generate data flow diagrams, and identify security threats across trust boundaries.",
    "seo_keywords": [
      "pytm threat modeling",
      "STRIDE analysis",
      "data flow diagrams",
      "security architecture review",
      "threat modeling CI/CD",
      "Claude Code security",
      "Codex AppSec",
      "DevSecOps tools",
      "OWASP threat modeling",
      "MITRE ATT&CK"
    ],
    "actual_capabilities": [
      "Define system architecture as Python code with trust boundaries",
      "Generate data flow diagrams with graphviz integration",
      "Automatically identify STRIDE threats (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege)",
      "Create threat reports with mitigation recommendations",
      "Integrate threat modeling into GitHub Actions CI/CD pipelines",
      "Define custom threats for organization-specific risks"
    ],
    "limitations": [
      "Requires Python 3.7+ and graphviz installation",
      "Does not execute actual security tests or scans",
      "Threat identification is heuristic-based and requires human review",
      "No built-in integration with external threat intelligence feeds"
    ],
    "use_cases": [
      {
        "target_user": "Security Architects",
        "title": "Architecture Security Review",
        "description": "Define system architecture in code and automatically identify security threats across trust boundaries before implementation"
      },
      {
        "target_user": "DevSecOps Engineers",
        "title": "CI/CD Security Integration",
        "description": "Automate threat modeling in pull requests to catch security issues early in the development lifecycle"
      },
      {
        "target_user": "Application Security Engineers",
        "title": "STRIDE Threat Enumeration",
        "description": "Generate comprehensive threat reports with categorized STRIDE threats and actionable mitigation strategies"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic Threat Model",
        "scenario": "Create initial threat model",
        "prompt": "Create a Python threat model using pytm for a web application with user authentication, a REST API backend, and a PostgreSQL database. Define trust boundaries for internet, DMZ, and internal network. Show how to generate the threat report."
      },
      {
        "title": "Microservices Architecture",
        "scenario": "Model cloud-native services",
        "prompt": "Model a microservices architecture using pytm with Lambda functions for API gateway, auth service, and order service. Include Redis cache and DynamoDB. Generate a data flow diagram showing encrypted communication between services."
      },
      {
        "title": "Custom Threats",
        "scenario": "Add organization-specific threats",
        "prompt": "Show how to add custom threat definitions to a pytm threat model. Create a custom threat for API rate limiting bypass with specific conditions and mitigation guidance. Include it in the threat report output."
      },
      {
        "title": "CI/CD Pipeline Integration",
        "scenario": "Automate in build pipeline",
        "prompt": "Create a GitHub Actions workflow that runs pytm threat modeling on every pull request. Include steps to install dependencies, generate the threat model, and upload the DFD as an artifact. Check for unmitigated threats and fail the build if high-severity threats lack mitigations."
      }
    ],
    "output_examples": [
      {
        "input": "Create a pytm threat model for a three-tier web application with user, load balancer, web server, app server, and database",
        "output": [
          "Trust Boundaries defined: Internet, DMZ, Internal Network",
          "Components: Actor(User), Server(Load Balancer), Server(Web Server), Server(App Server), Datastore(Database)",
          "Identified STRIDE Threats:",
          "  - Spoofing impersonation at: User authentication",
          "  - Tampering: Unencrypted web-to-app HTTP flow",
          "  - Information Disclosure: Database without encryption at rest",
          "  - Denial of Service: Load balancer without rate limiting",
          "Data Flow Crossings: 4 trust boundary crossings require review"
        ]
      },
      {
        "input": "Generate a threat report for a microservices architecture with API gateway, auth service, and database",
        "output": [
          "Architecture Overview: Cloud Microservices with 3 Lambda functions, 2 data stores",
          "Trust Boundary: Cloud Provider VPC",
          "STRIDE Analysis Results:",
          "  - Elevation of Privilege: API gateway without rate limiting",
          "  - Information Disclosure: Cache without encryption in transit",
          "  - Tampering: Auth function input validation missing",
          "Recommended Mitigations: Implement WAF rules, enable TLS for cache, add input sanitization"
        ]
      }
    ],
    "best_practices": [
      "Store threat models in version control alongside application code to track architecture changes",
      "Set accurate component security attributes (isEncrypted, implementsAuthentication) to reduce false positives",
      "Integrate threat model validation into CI/CD pipelines to catch security issues early"
    ],
    "anti_patterns": [
      "Hardcoding credentials or secrets in threat model Python files",
      "Skipping trust boundary definitions and modeling everything as a single zone",
      "Ignoring identified threats without documenting why they do not apply"
    ],
    "faq": [
      {
        "question": "Does pytm require Python 3.7 or newer?",
        "answer": "Yes. Python 3.7 or newer is required. You also need graphviz installed on your system for diagram generation."
      },
      {
        "question": "Can pytm generate diagrams without graphviz?",
        "answer": "No. Graphviz is a required dependency for generating data flow diagrams. Install via brew (macOS) or apt-get (Linux)."
      },
      {
        "question": "How does pytm integrate with CI/CD pipelines?",
        "answer": "pytm integrates via Python scripts run in CI. GitHub Actions or GitLab CI can execute threat models on each build and upload DFD artifacts."
      },
      {
        "question": "Is my threat model data safe to store in version control?",
        "answer": "Review threat models for sensitive architecture details before committing. Avoid hardcoding credentials. Use placeholders for secrets."
      },
      {
        "question": "Why are expected threats not appearing in my report?",
        "answer": "Verify component properties are set correctly (isSQL, isEncrypted). Ensure components are assigned to boundaries. Review trust boundary crossings."
      },
      {
        "question": "How does pytm compare to other threat modeling tools?",
        "answer": "pytm offers code-first threat modeling with version control benefits. Unlike graphical tools, it integrates naturally into CI/CD and developer workflows."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 575
    }
  ]
}
