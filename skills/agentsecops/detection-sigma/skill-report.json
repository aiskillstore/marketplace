{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:31:52.574Z",
    "slug": "agentsecops-detection-sigma",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/incident-response/detection-sigma",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "5635b4630bcbc1192914706ee35775a62e99d3a8f29cdd8664a1632e63a3984f",
    "tree_hash": "930f64e96775ea13fed0db446bce7e8ebb01ee6d73dd68d517c6fd2eac76c66a"
  },
  "skill": {
    "name": "detection-sigma",
    "description": "Generic detection rule creation and management using Sigma, the universal SIEM rule format. Sigma provides vendor-agnostic detection logic for log analysis across multiple SIEM platforms. Use when: (1) Creating detection rules for security monitoring, (2) Converting rules between SIEM platforms (Splunk, Elastic, QRadar, Sentinel), (3) Threat hunting with standardized detection patterns, (4) Building detection-as-code pipelines, (5) Mapping detections to MITRE ATT&CK tactics, (6) Implementing compliance-based monitoring rules.\n",
    "summary": "Generic detection rule creation and management using Sigma, the universal SIEM rule format. Sigma pr...",
    "icon": "üõ°Ô∏è",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "MIT",
    "category": "incident-response",
    "tags": [
      "sigma",
      "detection",
      "siem",
      "threat-hunting",
      "mitre-attack",
      "detection-engineering",
      "log-analysis"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Documentation-only skill containing YAML templates and reference guides for defensive security detection engineering. No executable code, network access, or file system operations. All content describes legitimate defensive security patterns for threat detection and compliance monitoring.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 13,
    "total_lines": 2860,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:31:52.574Z"
  },
  "content": {
    "user_title": "Create Sigma Detection Rules for SIEM",
    "value_statement": "Security teams need vendor-agnostic detection rules that work across multiple SIEM platforms. This skill provides templates, workflows, and references for creating, validating, and converting Sigma rules to Splunk, Elastic, Sentinel, QRadar, and other platforms.",
    "seo_keywords": [
      "sigma detection rules",
      "siem rule creation",
      "claude detection engineering",
      "claude code threat hunting",
      "splunk detection rules",
      "elastic detection rules",
      "mitre attack detection",
      "codex security monitoring"
    ],
    "actual_capabilities": [
      "Create detection rules using Sigma YAML format with field modifiers",
      "Convert rules to 25+ SIEM backends including Splunk, Elastic, Sentinel, QRadar",
      "Map detections to MITRE ATT&CK tactics and techniques",
      "Build compliance-based monitoring rules for PCI-DSS, NIST, ISO 27001",
      "Use pre-built templates for credential access, persistence, lateral movement",
      "Validate rule syntax and test against sample log data"
    ],
    "limitations": [
      "Requires Python pysigma library for rule conversion (not included)",
      "Does not execute or deploy rules to SIEM platforms directly",
      "Actual detection requires log sources to be ingested in target SIEM",
      "Backend compatibility varies by modifier type"
    ],
    "use_cases": [
      {
        "target_user": "SOC Analyst",
        "title": "Build Detection Rules",
        "description": "Create detection rules for security monitoring based on threat intelligence and attack patterns."
      },
      {
        "target_user": "Security Engineer",
        "title": "Migrate SIEM Rules",
        "description": "Convert existing detection rules between SIEM platforms or build new rules from Sigma specification."
      },
      {
        "target_user": "Compliance Officer",
        "title": "Compliance Monitoring",
        "description": "Implement detection rules for PCI-DSS, NIST 800-53, and ISO 27001 audit requirements."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic Detection Rule",
        "scenario": "Create detection for suspicious process",
        "prompt": "Create a Sigma detection rule for [process_name] with suspicious [indicators] in [log_source]. Include MITRE ATT&CK mapping."
      },
      {
        "title": "SIEM Conversion",
        "scenario": "Convert rule to target platform",
        "prompt": "Convert this Sigma rule to [Splunk|Elasticsearch|Sentinel|QRadar] format. Show the converted query and field mappings."
      },
      {
        "title": "MITRE Mapping",
        "scenario": "Map technique to detection",
        "prompt": "Create Sigma detection rules for MITRE ATT&CK technique [T####.###] covering [tactic_name]. Include log sources and key fields."
      },
      {
        "title": "Compliance Rule",
        "scenario": "Build compliance detection",
        "prompt": "Create Sigma detection rules for [PCI-DSS|NIST|ISO27001] requirement [control_id]. Include tags and documentation."
      }
    ],
    "output_examples": [
      {
        "input": "Create a Sigma rule to detect PowerShell encoded commands",
        "output": [
          "‚úì Rule: Suspicious PowerShell Execution",
          "‚úì Log Source: Windows process_creation (Sysmon Event ID 1)",
          "‚úì Detection: Image endswith 'powershell.exe' AND CommandLine contains '-enc' or 'FromBase64String'",
          "‚úì MITRE ATT&CK: T1059.001 (PowerShell) - Execution tactic",
          "‚úì Supported backends: Splunk SPL, Elastic Query DSL, Sentinel KQL, QRadar AQL",
          "‚úì Severity: Medium with false positive notes for admin scripts"
        ]
      }
    ],
    "best_practices": [
      "Use specific field modifiers like 'endswith' instead of 'contains' for better performance",
      "Start rules at 'experimental' status and promote after testing in non-production",
      "Tag all rules with MITRE ATT&CK techniques and compliance framework controls"
    ],
    "anti_patterns": [
      "Using overly broad detection criteria that generates excessive false positives",
      "Deploying rules without testing against historical log data first",
      "Creating rules without documenting false positive scenarios and mitigation filters"
    ],
    "faq": [
      {
        "question": "What SIEM platforms does Sigma support?",
        "answer": "Sigma converts to 25+ platforms including Splunk, Elastic, QRadar, Microsoft Sentinel, Chronicle, LogPoint, ArcSight, and EDR platforms."
      },
      {
        "question": "What Python packages are required?",
        "answer": "Install pysigma plus backend plugins: pip install pysigma pysigma-backend-splunk pysigma-backend-elasticsearch pyyaml."
      },
      {
        "question": "Can I use this with existing Sigma rules?",
        "answer": "Yes. Import rules from SigmaHQ repository or use the skill to convert, validate, and customize existing rules for your environment."
      },
      {
        "question": "How is sensitive data handled?",
        "answer": "Sigma rules reference field names and patterns. Never include actual sensitive data in rule values. Store rules with version control access controls."
      },
      {
        "question": "Why is my converted query not working in SIEM?",
        "answer": "Verify log source availability, check field name mappings, test time range, and ensure backend supports all modifiers used in the rule."
      },
      {
        "question": "How does this differ from writing SIEM queries directly?",
        "answer": "Sigma rules are vendor-agnostic. Write once and convert to any supported backend, enabling portability across SIEM platforms and detection-as-code workflows."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "compliance-rules",
          "type": "dir",
          "path": "assets/compliance-rules",
          "children": [
            {
              "name": "iso27001-logging.yml",
              "type": "file",
              "path": "assets/compliance-rules/iso27001-logging.yml"
            },
            {
              "name": "nist-800-53-audit.yml",
              "type": "file",
              "path": "assets/compliance-rules/nist-800-53-audit.yml"
            },
            {
              "name": "pci-dss-monitoring.yml",
              "type": "file",
              "path": "assets/compliance-rules/pci-dss-monitoring.yml"
            }
          ]
        },
        {
          "name": "rule-templates",
          "type": "dir",
          "path": "assets/rule-templates",
          "children": [
            {
              "name": "credential-access.yml",
              "type": "file",
              "path": "assets/rule-templates/credential-access.yml"
            },
            {
              "name": "lateral-movement.yml",
              "type": "file",
              "path": "assets/rule-templates/lateral-movement.yml"
            },
            {
              "name": "persistence.yml",
              "type": "file",
              "path": "assets/rule-templates/persistence.yml"
            },
            {
              "name": "privilege-escalation.yml",
              "type": "file",
              "path": "assets/rule-templates/privilege-escalation.yml"
            }
          ]
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "backend-support.md",
          "type": "file",
          "path": "references/backend-support.md"
        },
        {
          "name": "compliance-mappings.md",
          "type": "file",
          "path": "references/compliance-mappings.md"
        },
        {
          "name": "field-modifiers.md",
          "type": "file",
          "path": "references/field-modifiers.md"
        },
        {
          "name": "log-source-guide.md",
          "type": "file",
          "path": "references/log-source-guide.md"
        },
        {
          "name": "mitre-attack-mapping.md",
          "type": "file",
          "path": "references/mitre-attack-mapping.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
