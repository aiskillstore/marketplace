{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-02-21T08:39:40.546Z",
    "slug": "microsoft-azure-aigateway",
    "source_url": "https://github.com/microsoft/github-copilot-for-azure/tree/main/plugin/skills/azure-aigateway/",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "d47cde5b57369641397daf931d570cfb2b3378cbb2a60c04d047ded03bffd97c",
    "tree_hash": "9d148b1fcd7c460fa7c97b4915a346204dae205fb9af7ff871baf6ad79044c55"
  },
  "skill": {
    "name": "azure-aigateway",
    "description": "Configure Azure API Management (APIM) as AI Gateway to secure, observe, control AI models, MCP servers, agents. Helps with rate limiting, semantic caching, content safety, load balancing. USE FOR: AI Gateway, APIM, setup gateway, configure gateway, add gateway, model gateway, MCP server, rate limit, token limit, semantic cache, content safety, load balance, OpenAPI import, convert API to MCP. DO NOT USE FOR: deploy models (use microsoft-foundry), Azure Functions (use azure-functions), databases (use azure-postgres).",
    "summary": "Configure Azure API Management as AI Gateway for securing, observing, and controlling AI models, MCP servers, and agents with rate limiting, caching, and content safety.",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "microsoft",
    "license": "MIT",
    "tags": [
      "azure",
      "api-management",
      "ai-gateway",
      "rate-limiting",
      "mcp-server"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is an official Microsoft skill for configuring Azure API Management as an AI Gateway. All static findings are false positives: external_commands are legitimate Azure CLI commands for infrastructure deployment, network findings are Microsoft documentation URLs, and 'jailbreak' references describe a content safety security feature that detects/blocks jailbreak attempts, not a vulnerability.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 5,
    "total_lines": 871,
    "audit_model": "claude",
    "audited_at": "2026-02-21T08:39:40.546Z",
    "risk_factors": [
      "external_commands",
      "network"
    ],
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 54,
            "line_end": 58
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 62,
            "line_end": 68
          }
        ]
      }
    ]
  },
  "content": {
    "user_title": "Configure Azure AI Gateway with APIM",
    "value_statement": "Secure and control AI models, MCP servers, and agents with Azure API Management. This skill helps set up rate limiting, semantic caching, content safety, and load balancing for AI deployments.",
    "seo_keywords": [
      "Azure AI Gateway",
      "APIM configuration",
      "Claude Codex",
      "Claude Code",
      "rate limiting AI",
      "MCP server Azure",
      "semantic caching",
      "content safety AI",
      "Azure OpenAI gateway",
      "AI API management"
    ],
    "actual_capabilities": [
      "Deploy Azure API Management as AI Gateway with Basicv2 SKU",
      "Configure semantic caching to reduce AI costs by 60-80%",
      "Set up token rate limiting per subscription or IP address",
      "Implement content safety with jailbreak detection",
      "Import OpenAPI specifications and convert APIs to MCP servers",
      "Configure managed identity authentication for Azure AI services"
    ],
    "limitations": [
      "Does not deploy Azure AI models (use microsoft-foundry skill)",
      "Does not manage Azure Functions (use azure-functions skill)",
      "Requires Azure subscription and appropriate permissions",
      "Basicv2 SKU has limited features compared to Premium tier"
    ],
    "use_cases": [
      {
        "title": "Secure AI Model Access",
        "description": "Add rate limiting, token quotas, and authentication to Azure OpenAI or AI Foundry deployments",
        "target_user": "DevOps engineers securing AI endpoints"
      },
      {
        "title": "Reduce AI Costs with Caching",
        "description": "Implement semantic caching to cache similar prompts and reduce API calls to AI services",
        "target_user": "Developers optimizing AI application costs"
      },
      {
        "title": "Convert APIs to MCP Servers",
        "description": "Expose existing APIs as Model Context Protocol servers for AI agent tool discovery",
        "target_user": "Backend developers integrating APIs with AI agents"
      }
    ],
    "prompt_templates": [
      {
        "title": "Quick Gateway Setup",
        "prompt": "Set up an Azure AI Gateway using API Management with Basicv2 SKU in resource group rg-aigateway in eastus2 region",
        "scenario": "Getting started with AI Gateway deployment"
      },
      {
        "title": "Add Rate Limiting",
        "prompt": "Add token rate limiting to my AI Gateway. Limit to 500 tokens per minute per subscription",
        "scenario": "Configuring token quotas for cost control"
      },
      {
        "title": "Enable Semantic Caching",
        "prompt": "Configure semantic caching on my API Management instance with 0.8 similarity threshold and 120 second TTL",
        "scenario": "Reducing AI API costs with intelligent caching"
      },
      {
        "title": "Add Content Safety",
        "prompt": "Add content safety filtering to block harmful content and detect jailbreak attempts with severity threshold 4",
        "scenario": "Securing AI endpoints from abusive content"
      }
    ],
    "output_examples": [
      {
        "input": "Set up an Azure AI Gateway with rate limiting",
        "output": [
          "Created APIM instance with Basicv2 SKU",
          "Configured token rate limiting: 500 tokens/minute per subscription",
          "Added semantic caching with 0.8 threshold",
          "Gateway URL: https://apim-aigateway.azure-api.net"
        ]
      },
      {
        "input": "Add content safety to my AI endpoint",
        "output": [
          "Configured content safety policy with eight severity categories",
          "Enabled jailbreak detection (shield-prompt=true)",
          "Blocking categories: Hate, Sexual, SelfHarm, Violence at threshold 4",
          "Applied policy to inbound requests"
        ]
      }
    ],
    "best_practices": [
      "Use Basicv2 SKU for faster deployment (5-10 min) and lower cost",
      "Enable managed identity instead of API keys for backend authentication",
      "Configure semantic caching with 0.7-0.8 threshold for optimal hit rates",
      "Use azure-openai-emit-token-metric for cost tracking and monitoring"
    ],
    "anti_patterns": [
      "Using Premium SKU when Basicv2 meets requirements (slower deployment)",
      "Hardcoding API keys instead of using managed identity",
      "Setting score-threshold too high (>0.9) causing no cache hits",
      "Disabling content safety monitoring in production AI deployments"
    ],
    "faq": [
      {
        "question": "What is Azure AI Gateway?",
        "answer": "Azure AI Gateway is Azure API Management configured to secure, observe, and control AI models, MCP servers, and agents. It provides rate limiting, caching, content safety, and load balancing."
      },
      {
        "question": "Which APIM SKU should I use?",
        "answer": "Use Basicv2 SKU for AI Gateway workloads. It supports all AI Gateway policies, deploys faster (5-10 min), and costs less than Premium."
      },
      {
        "question": "How does semantic caching reduce costs?",
        "answer": "Semantic caching stores AI responses for similar prompts. With 0.8 similarity threshold, similar queries return cached results instead of calling the AI model, reducing costs by 60-80%."
      },
      {
        "question": "Can I convert my API to an MCP server?",
        "answer": "Yes, Pattern 10 in this skill shows how to convert existing APIM APIs to MCP servers that AI agents can discover and use as tools."
      },
      {
        "question": "How does content safety work?",
        "answer": "The llm-content-safety policy filters harmful content across 8 severity categories. Enable shield-prompt to detect jailbreak attempts that try to bypass AI safety controls."
      },
      {
        "question": "Do I need managed identity?",
        "answer": "Yes, managed identity is recommended for production. It avoids storing API keys and provides secure authentication to Azure AI services like Azure OpenAI."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "sdk",
          "type": "dir",
          "path": "references/sdk",
          "children": [
            {
              "name": "azure-ai-contentsafety-py.md",
              "type": "file",
              "path": "references/sdk/azure-ai-contentsafety-py.md",
              "lines": 32
            },
            {
              "name": "azure-ai-contentsafety-ts.md",
              "type": "file",
              "path": "references/sdk/azure-ai-contentsafety-ts.md",
              "lines": 31
            },
            {
              "name": "azure-mgmt-apimanagement-dotnet.md",
              "type": "file",
              "path": "references/sdk/azure-mgmt-apimanagement-dotnet.md",
              "lines": 27
            },
            {
              "name": "azure-mgmt-apimanagement-py.md",
              "type": "file",
              "path": "references/sdk/azure-mgmt-apimanagement-py.md",
              "lines": 25
            }
          ]
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 756
    }
  ]
}
