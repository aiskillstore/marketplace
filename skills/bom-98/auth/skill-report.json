{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:50:00.367Z",
    "slug": "bom-98-auth",
    "source_url": "https://github.com/BOM-98/FinTracker/tree/main/.claude/skills/auth",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "6005d9626510278849914eed6525254912febe6aed90ea16dae250b945057993",
    "tree_hash": "0bb36634c8a93281bbe1799793b8dc8c8aa8818e74cedbdb0ccb13adfc8234ee"
  },
  "skill": {
    "name": "auth",
    "description": "Authentication and access control skill for Next.js 15 + Supabase applications. Use when implementing user authentication, protecting routes, managing user sessions, enforcing role-based access control (admin/member), or working with multi-tenant family-based data isolation. Covers login/logout, registration with email verification, OAuth (GitHub), route protection for Server Components and Server Actions, admin-only features, and multi-tenant data access patterns.",
    "summary": "Authentication and access control skill for Next.js 15 + Supabase applications. Use when implementin...",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "BOM-98",
    "license": "MIT",
    "category": "security",
    "tags": [
      "authentication",
      "supabase",
      "nextjs",
      "access-control",
      "multi-tenant"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill contains only documentation and TypeScript code examples for authentication patterns. No executable scripts, network calls, filesystem access beyond its own files, or external command execution. All code examples demonstrate legitimate security practices using Supabase Auth with Next.js 15.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 5,
    "total_lines": 965,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:50:00.367Z"
  },
  "content": {
    "user_title": "Implement authentication and access control",
    "value_statement": "This skill helps you add secure user authentication to Next.js applications. It provides ready-to-use patterns for Supabase Auth with httpOnly cookies, route protection, and role-based access control.",
    "seo_keywords": [
      "Claude authentication skill",
      "Next.js 15 auth",
      "Supabase authentication",
      "role-based access control",
      "multi-tenant security",
      "httpOnly cookies",
      "Cla Code auth patterns",
      "Server Components auth",
      "MCP authentication",
      "OAuth GitHub integration"
    ],
    "actual_capabilities": [
      "Protect routes with requireAuthRedirect for Server Components",
      "Enforce authentication in Server Actions with requireAuth",
      "Implement admin-only features using role-based access",
      "Validate multi-tenant family data access with requireFamilyAccess",
      "Configure OAuth login with GitHub provider",
      "Handle token refresh via middleware on every request"
    ],
    "limitations": [
      "Requires existing Next.js 15 + Supabase project setup",
      "Only supports Supabase Auth provider (not other auth services)",
      "Family-based multi-tenancy assumes specific database schema",
      "GitHub OAuth requires Supabase project configuration"
    ],
    "use_cases": [
      {
        "target_user": "Full-stack developers",
        "title": "Add login to web app",
        "description": "Implement user registration, login, and logout flows with email verification and session management."
      },
      {
        "target_user": "Team leads",
        "title": "Enforce role-based access",
        "description": "Restrict admin features to specific users while allowing family members appropriate access levels."
      },
      {
        "target_user": "Security engineers",
        "title": "Secure API routes",
        "description": "Protect Server Actions and API routes with server-side authentication validation using httpOnly cookies."
      }
    ],
    "prompt_templates": [
      {
        "title": "Protect a page",
        "scenario": "Making a page require login",
        "prompt": "How do I protect a Server Component page so only logged-in users can access it?"
      },
      {
        "title": "Add admin-only route",
        "scenario": "Creating admin dashboard",
        "prompt": "Create an admin-only route that redirects non-admin users back to the dashboard."
      },
      {
        "title": "Implement login action",
        "scenario": "Building login form",
        "prompt": "Write a Server Action that handles user login with email and password using Supabase Auth."
      },
      {
        "title": "Validate family access",
        "scenario": "Multi-tenant data",
        "prompt": "Show me how to verify a user belongs to a family before allowing them to access or modify family data."
      }
    ],
    "output_examples": [
      {
        "input": "How do I add authentication to a new page in my Next.js app?",
        "output": [
          "To protect a page from unauthenticated users:",
          "1. Import requireAuthRedirect from '@/lib/auth/server-auth'",
          "2. Call await requireAuthRedirect() at the start of your Server Component",
          "3. Unauthenticated users will be redirected to /login automatically",
          "The function validates the session server-side and returns early if not authenticated."
        ]
      }
    ],
    "best_practices": [
      "Always use getUser() instead of getSession() for server-side validation since it revalidates with the Supabase server.",
      "Keep all authentication logic server-side in Server Components and Server Actions to prevent client-side bypass.",
      "Use requireFamilyAccess() to validate multi-tenant access before any database operations on family data."
    ],
    "anti_patterns": [
      "Trusting client-side role checks for authorization - always validate on the server.",
      "Using getSession() in server code without server-side validation.",
      "Skipping authentication checks in protected routes or exposing auth helpers to Client Components."
    ],
    "faq": [
      {
        "question": "Which AI tools support this skill?",
        "answer": "This skill works with Claude, Codex, and Claude Code. All code patterns are compatible with Next.js 15 and Supabase Auth."
      },
      {
        "question": "What Supabase setup is required?",
        "answer": "You need Supabase Auth enabled with email/password and optional GitHub OAuth. Configure the public environment variables in your .env file."
      },
      {
        "question": "How does route protection work?",
        "answer": "The skill uses a hybrid approach: middleware refreshes tokens, and Server Components use requireAuthRedirect() for page-level protection."
      },
      {
        "question": "Is my user data secure?",
        "answer": "Yes. Authentication uses httpOnly cookies so tokens never reach JavaScript. All validation happens server-side with Supabase."
      },
      {
        "question": "Why do redirects fail in Server Actions?",
        "answer": "Middleware redirects do not work with POST requests (Server Actions). Always validate authentication within each Server Action using requireAuth()."
      },
      {
        "question": "How is this different from other auth skills?",
        "answer": "This skill is specific to Next.js 15 + Supabase with server-side auth patterns, httpOnly cookies, and family-based multi-tenancy."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "file-tree.md",
          "type": "file",
          "path": "references/file-tree.md"
        },
        {
          "name": "flows.md",
          "type": "file",
          "path": "references/flows.md"
        },
        {
          "name": "patterns.md",
          "type": "file",
          "path": "references/patterns.md"
        },
        {
          "name": "security.md",
          "type": "file",
          "path": "references/security.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
