{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-07T01:08:29.115Z",
    "slug": "davila7-docx",
    "source_url": "https://github.com/davila7/claude-code-templates/tree/main/cli-tool/components/skills/scientific/document-skills/docx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "d2e7652f8c5e710ed6583c8fd8c4d8dd314f43dab2a15309613c0a784c34fed2",
    "tree_hash": "7d8d9013961b4b97aaddace9f608433d7aa1d0eb4b32bd82e6e61f851a44def2"
  },
  "skill": {
    "name": "docx",
    "description": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation, text extraction, for professional document processing.",
    "summary": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation,...",
    "icon": "ðŸ“„",
    "version": "1.0.1",
    "author": "davila7",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "documentation",
    "tags": [
      "word",
      "document",
      "office",
      "writing"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "filesystem",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Legitimate document processing toolkit with no malicious behavior. Uses secure XML parsing with defusedxml, controlled subprocess calls, and filesystem operations limited to user-specified document paths.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "scripts/document.py",
            "line_start": 1,
            "line_end": 1277
          },
          {
            "file": "scripts/utilities.py",
            "line_start": 1,
            "line_end": 375
          },
          {
            "file": "ooxml/scripts/unpack.py",
            "line_start": 1,
            "line_end": 30
          },
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 1,
            "line_end": 160
          },
          {
            "file": "ooxml/scripts/validate.py",
            "line_start": 1,
            "line_end": 70
          },
          {
            "file": "ooxml/scripts/validation/base.py",
            "line_start": 1,
            "line_end": 952
          },
          {
            "file": "ooxml/scripts/validation/docx.py",
            "line_start": 1,
            "line_end": 275
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 1,
            "line_end": 280
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/document.py",
            "line_start": 634,
            "line_end": 642
          },
          {
            "file": "scripts/utilities.py",
            "line_start": 65,
            "line_end": 74
          },
          {
            "file": "ooxml/scripts/unpack.py",
            "line_start": 15,
            "line_end": 17
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 116
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 153,
            "line_end": 163
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "External command execution via subprocess",
        "description": "The pack.py and redlining.py scripts use subprocess.run() to execute external commands (soffice, git). These are legitimate document processing tools, but subprocess execution is a potential risk factor.\n\nEvidence from pack.py:103-116:\n```python\nresult = subprocess.run([\n    \"soffice\",\n    \"--headless\",\n    \"--convert-to\",\n    filter_name,\n    \"--outdir\",\n    temp_dir,\n    str(doc_path),\n], capture_output=True, timeout=10, text=True)\n```\n\nEvidence from redlining.py:153-163:\n```python\nresult = subprocess.run([\n    \"git\",\n    \"diff\",\n    \"--word-diff=plain\",\n    \"--word-diff-regex=.\",\n    \"-U0\",\n    \"--no-index\",\n    str(original_file),\n    str(modified_file),\n], capture_output=True, text=True)\n```",
        "locations": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 116
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 153,
            "line_end": 163
          }
        ]
      },
      {
        "title": "Filesystem write access to user-specified paths",
        "description": "The document.py library creates temporary directories and writes modified documents back to user-specified locations. This is expected behavior for a document editing tool.\n\nEvidence from document.py:640-646:\n```python\nself.temp_dir = tempfile.mkdtemp(prefix=\"docx_\")\nself.unpacked_path = Path(self.temp_dir) / \"unpacked\"\nshutil.copytree(self.original_path, self.unpacked_path)\nself.original_docx = Path(self.temp_dir) / \"original.docx\"\npack_document(self.original_path, self.original_docx, validate=False)\n```",
        "locations": [
          {
            "file": "scripts/document.py",
            "line_start": 640,
            "line_end": 646
          },
          {
            "file": "scripts/document.py",
            "line_start": 859,
            "line_end": 884
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 12,
    "total_lines": 4641,
    "audit_model": "claude",
    "audited_at": "2026-01-07T01:08:29.115Z"
  },
  "content": {
    "user_title": "Create and edit Word documents with tracked changes",
    "value_statement": "Need to create professional Word documents or edit existing files with tracked changes? This skill provides JavaScript and Python libraries for document creation, editing, and validation with full formatting support.",
    "seo_keywords": [
      "docx",
      "Word document",
      "Microsoft Word",
      "Office Open XML",
      "tracked changes",
      "document editing",
      "Claude Code",
      "Codex",
      "redlining",
      "comments"
    ],
    "actual_capabilities": [
      "Create new Word documents with JavaScript using docx library",
      "Edit existing DOCX files with tracked changes and comments",
      "Extract text content from Word documents using pandoc",
      "Access raw OOXML for complex document manipulation",
      "Validate document integrity against XSD schemas",
      "Convert documents to PDF and images for visual analysis"
    ],
    "limitations": [
      "Cannot process password-protected or encrypted documents",
      "External dependencies (pandoc, LibreOffice, defusedxml) must be installed",
      "Works only with local files, no cloud storage integration",
      "Tracked changes validation requires git for diff comparison"
    ],
    "use_cases": [
      {
        "target_user": "Legal professionals",
        "title": "Legal document review",
        "description": "Edit contracts and agreements with tracked changes for professional redlining workflows."
      },
      {
        "target_user": "Academic researchers",
        "title": "Academic paper editing",
        "description": "Create and format research papers with proper headings, tables, and citations."
      },
      {
        "target_user": "Business users",
        "title": "Business document creation",
        "description": "Generate professional reports, proposals, and business letters with consistent formatting."
      }
    ],
    "prompt_templates": [
      {
        "title": "Create simple document",
        "scenario": "Basic document creation",
        "prompt": "Create a Word document with a title, three headings, and a bulleted list. Save it as report.docx."
      },
      {
        "title": "Edit with tracked changes",
        "scenario": "Document editing",
        "prompt": "Edit existing-document.docx to change all instances of 'company' to 'Corporation' using tracked changes."
      },
      {
        "title": "Extract document content",
        "scenario": "Content extraction",
        "prompt": "Extract all text from document.docx including tracked changes. Output the content in markdown format."
      },
      {
        "title": "Complex formatting",
        "scenario": "Professional document",
        "prompt": "Create a formal letter with proper headers, tables, and page numbering. Include a table of contents and footnotes."
      }
    ],
    "output_examples": [
      {
        "input": "Create a Word document for a meeting agenda with three sections: attendees, discussion topics, and action items.",
        "output": [
          "Title: Meeting Agenda",
          "Section 1: Attendees",
          "- Team member 1",
          "- Team member 2",
          "Section 2: Discussion Topics",
          "Section 3: Action Items",
          "â€¢ Task 1 - Owner: [Name]",
          "â€¢ Task 2 - Owner: [Name]"
        ]
      }
    ],
    "best_practices": [
      "Use the Document library (Python) for existing document editing with tracked changes",
      "Use docx-js (JavaScript) for creating new documents with complex formatting",
      "Validate documents with soffice before distribution to ensure compatibility",
      "Test tracked changes on copies before modifying original files"
    ],
    "anti_patterns": [
      "Avoid using unicode symbols for bullets - always use proper numbering configuration",
      "Never nest tracked change tags inside text elements (w:t, w:delText)",
      "Do not modify documents without enabling track revisions when changes should be visible",
      "Avoid standalone PageBreak elements - always wrap in Paragraph"
    ],
    "faq": [
      {
        "question": "Which tool should I use for creating vs editing documents?",
        "answer": "Use docx-js (JavaScript) for creating new documents. Use the Document library (Python) for editing existing documents with tracked changes."
      },
      {
        "question": "What are the system dependencies required?",
        "answer": "Install pandoc (text extraction), docx npm package (document creation), LibreOffice (PDF conversion), and defusedxml (secure XML parsing)."
      },
      {
        "question": "How do I enable tracked changes in my documents?",
        "answer": "Initialize the Document class with track_revisions=True. All edits will automatically use tracked changes with proper author attribution."
      },
      {
        "question": "Is my document data safe when using this skill?",
        "answer": "Yes. All processing is local. The skill uses secure XML parsing (defusedxml) and only accesses files you explicitly specify."
      },
      {
        "question": "Why are my changes not appearing in the document?",
        "answer": "Check that you called doc.save() after making changes. Verify tracked change tags are properly nested. Use validate.py to check for XML issues."
      },
      {
        "question": "What is the difference between docx-js and Python Document library?",
        "answer": "docx-js creates new documents with JavaScript and is ideal for fresh documents. The Python library works with existing DOCX files and provides tracked changes support."
      }
    ]
  },
  "file_structure": [
    {
      "name": "ooxml",
      "type": "dir",
      "path": "ooxml",
      "children": [
        {
          "name": "schemas",
          "type": "dir",
          "path": "ooxml/schemas",
          "children": [
            {
              "name": "ecma",
              "type": "dir",
              "path": "ooxml/schemas/ecma",
              "children": [
                {
                  "name": "fouth-edition",
                  "type": "dir",
                  "path": "ooxml/schemas/ecma/fouth-edition"
                }
              ]
            },
            {
              "name": "ISO-IEC29500-4_2016",
              "type": "dir",
              "path": "ooxml/schemas/ISO-IEC29500-4_2016",
              "children": [
                {
                  "name": "dml-chart.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chart.xsd"
                },
                {
                  "name": "dml-chartDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chartDrawing.xsd"
                },
                {
                  "name": "dml-diagram.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-diagram.xsd"
                },
                {
                  "name": "dml-lockedCanvas.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-lockedCanvas.xsd"
                },
                {
                  "name": "dml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-main.xsd"
                },
                {
                  "name": "dml-picture.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-picture.xsd"
                },
                {
                  "name": "dml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "dml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "pml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/pml.xsd"
                },
                {
                  "name": "shared-additionalCharacteristics.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-additionalCharacteristics.xsd"
                },
                {
                  "name": "shared-bibliography.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-bibliography.xsd"
                },
                {
                  "name": "shared-commonSimpleTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-commonSimpleTypes.xsd"
                },
                {
                  "name": "shared-customXmlDataProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlDataProperties.xsd"
                },
                {
                  "name": "shared-customXmlSchemaProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlSchemaProperties.xsd"
                },
                {
                  "name": "shared-documentPropertiesCustom.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesCustom.xsd"
                },
                {
                  "name": "shared-documentPropertiesExtended.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesExtended.xsd"
                },
                {
                  "name": "shared-documentPropertiesVariantTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesVariantTypes.xsd"
                },
                {
                  "name": "shared-math.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-math.xsd"
                },
                {
                  "name": "shared-relationshipReference.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-relationshipReference.xsd"
                },
                {
                  "name": "sml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/sml.xsd"
                },
                {
                  "name": "vml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-main.xsd"
                },
                {
                  "name": "vml-officeDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-officeDrawing.xsd"
                },
                {
                  "name": "vml-presentationDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-presentationDrawing.xsd"
                },
                {
                  "name": "vml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "vml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "wml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/wml.xsd"
                },
                {
                  "name": "xml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/xml.xsd"
                }
              ]
            },
            {
              "name": "mce",
              "type": "dir",
              "path": "ooxml/schemas/mce",
              "children": [
                {
                  "name": "mc.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/mce/mc.xsd"
                }
              ]
            },
            {
              "name": "microsoft",
              "type": "dir",
              "path": "ooxml/schemas/microsoft",
              "children": [
                {
                  "name": "wml-2010.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2010.xsd"
                },
                {
                  "name": "wml-2012.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2012.xsd"
                },
                {
                  "name": "wml-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2018.xsd"
                },
                {
                  "name": "wml-cex-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cex-2018.xsd"
                },
                {
                  "name": "wml-cid-2016.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cid-2016.xsd"
                },
                {
                  "name": "wml-sdtdatahash-2020.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-sdtdatahash-2020.xsd"
                },
                {
                  "name": "wml-symex-2015.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-symex-2015.xsd"
                }
              ]
            }
          ]
        },
        {
          "name": "scripts",
          "type": "dir",
          "path": "ooxml/scripts",
          "children": [
            {
              "name": "validation",
              "type": "dir",
              "path": "ooxml/scripts/validation",
              "children": [
                {
                  "name": "__init__.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/__init__.py"
                },
                {
                  "name": "base.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/base.py"
                },
                {
                  "name": "docx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/docx.py"
                },
                {
                  "name": "pptx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/pptx.py"
                },
                {
                  "name": "redlining.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/redlining.py"
                }
              ]
            },
            {
              "name": "pack.py",
              "type": "file",
              "path": "ooxml/scripts/pack.py"
            },
            {
              "name": "unpack.py",
              "type": "file",
              "path": "ooxml/scripts/unpack.py"
            },
            {
              "name": "validate.py",
              "type": "file",
              "path": "ooxml/scripts/validate.py"
            }
          ]
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "templates",
          "type": "dir",
          "path": "scripts/templates",
          "children": [
            {
              "name": "comments.xml",
              "type": "file",
              "path": "scripts/templates/comments.xml"
            },
            {
              "name": "commentsExtended.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtended.xml"
            },
            {
              "name": "commentsExtensible.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtensible.xml"
            },
            {
              "name": "commentsIds.xml",
              "type": "file",
              "path": "scripts/templates/commentsIds.xml"
            },
            {
              "name": "people.xml",
              "type": "file",
              "path": "scripts/templates/people.xml"
            }
          ]
        },
        {
          "name": "__init__.py",
          "type": "file",
          "path": "scripts/__init__.py"
        },
        {
          "name": "document.py",
          "type": "file",
          "path": "scripts/document.py"
        },
        {
          "name": "utilities.py",
          "type": "file",
          "path": "scripts/utilities.py"
        }
      ]
    },
    {
      "name": "docx-js.md",
      "type": "file",
      "path": "docx-js.md"
    },
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "ooxml.md",
      "type": "file",
      "path": "ooxml.md"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
