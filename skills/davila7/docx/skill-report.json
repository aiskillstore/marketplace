{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-17T00:45:14.090Z",
    "slug": "davila7-docx",
    "source_url": "https://github.com/davila7/claude-code-templates/tree/main/cli-tool/components/skills/scientific/document-skills/docx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "0bd90681fcab2e282025ee14acf508b60bbd6c41ac6c3bf83c0dc14d52c37933",
    "tree_hash": "e9c50de4963aa447fa9baf0daac2b827b27549db5941cc7da4c1a6fdc82cfe63"
  },
  "skill": {
    "name": "docx",
    "description": "Comprehensive document creation, editing, and analysis with support for tracked changes, comments, formatting preservation, and text extraction. When Claude needs to work with professional documents (.docx files) for: (1) Creating new documents, (2) Modifying or editing content, (3) Working with tracked changes, (4) Adding comments, or any other document tasks",
    "summary": "Comprehensive document creation, editing, and analysis with support for tracked changes, comments, f...",
    "icon": "ðŸ“„",
    "version": "1.0.0",
    "author": "davila7",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "documentation",
    "tags": [
      "document-processing",
      "word",
      "docx",
      "office",
      "writing"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "filesystem",
      "external_commands",
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "The docx skill is a legitimate document processing tool. Static findings are false positives triggered by documentation examples and standard XML schema files. The actual Python code uses defusedxml for secure parsing and performs no network requests, cryptography, or credential handling. Minor concern: dependency installation commands in documentation require user review before execution.",
    "risk_factor_evidence": [
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/document.py",
            "line_start": 29,
            "line_end": 43
          },
          {
            "file": "scripts/utilities.py",
            "line_start": 302,
            "line_end": 310
          },
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 64,
            "line_end": 86
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 36,
            "line_end": 196
          },
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 116
          }
        ]
      },
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "scripts/document.py",
            "line_start": 1,
            "line_end": 50
          },
          {
            "file": "scripts/utilities.py",
            "line_start": 1,
            "line_end": 50
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [
      {
        "finding": "external_commands in documentation files",
        "count": 243,
        "verdict": "false_positive",
        "reasoning": "All findings are markdown documentation showing command-line examples, not executable code."
      }
    ],
    "low_findings": [
      {
        "finding": "Hardcoded URLs in XSD schema files",
        "count": 427,
        "verdict": "false_positive",
        "reasoning": "Standard OOXML namespace declarations in specification schema files."
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 60,
    "total_lines": 25370,
    "audit_model": "claude",
    "audited_at": "2026-01-17T00:45:14.090Z"
  },
  "content": {
    "user_title": "Create and edit Word documents",
    "value_statement": "Automate Word document creation, editing, and analysis with full support for tracked changes, comments, and formatting. Convert documents, apply edits in review mode, and extract content with precision.",
    "seo_keywords": [
      "docx",
      "Word document",
      "document automation",
      "Claude",
      "Codex",
      "Claude Code",
      "Office Open XML",
      "tracked changes",
      "document editing",
      "pandoc"
    ],
    "actual_capabilities": [
      "Create new Word documents from scratch using docx-js library",
      "Edit existing documents with tracked changes and comments",
      "Convert documents between formats using pandoc and LibreOffice",
      "Extract text and raw XML content from DOCX files",
      "Implement batch tracked changes with redlining workflow",
      "Validate document structure against OOXML schemas"
    ],
    "limitations": [
      "Requires external dependencies (pandoc, LibreOffice, docx library)",
      "Complex formatting may require manual XML editing",
      "Large documents may need batched processing for tracked changes",
      "Does not support real-time collaboration features"
    ],
    "use_cases": [
      {
        "target_user": "Legal professionals",
        "title": "Legal document redlining",
        "description": "Apply tracked changes to contracts and legal documents with proper RSID handling and batch processing."
      },
      {
        "target_user": "Technical writers",
        "title": "Document conversion pipeline",
        "description": "Convert Word documents to markdown, analyze structure, and export with formatting preserved."
      },
      {
        "target_user": "Business analysts",
        "title": "Report generation",
        "description": "Create professional Word documents with tables, images, and formatting from automated analysis."
      }
    ],
    "prompt_templates": [
      {
        "title": "Extract text content",
        "scenario": "Read document contents",
        "prompt": "Extract all text content from document.docx and save it to output.md using pandoc with tracked changes preserved."
      },
      {
        "title": "Create new document",
        "scenario": "Generate Word file",
        "prompt": "Create a new Word document named report.docx with a title paragraph, two headings, and a table with 3 rows and 4 columns."
      },
      {
        "title": "Edit with tracked changes",
        "scenario": "Apply document revisions",
        "prompt": "Review contract.docx and make the following tracked changes: replace '30 days' with '45 days' in section 2, update the signature date format, and add a comment about the renewal clause."
      },
      {
        "title": "Batch document processing",
        "scenario": "Multiple file workflow",
        "prompt": "Unpack all DOCX files in the input directory, extract their text content, apply the corrections in batch_review.md to each, and repack them with tracked changes."
      }
    ],
    "output_examples": [
      {
        "input": "Create a Word document with a title, three paragraphs with different alignments, and a bulleted list with 5 items.",
        "output": [
          "Created document.docx with:",
          "â€¢ Centered title 'Project Report'",
          "â€¢ Left-aligned intro paragraph",
          "â€¢ Justified main content with spacing 200/200",
          "â€¢ Right-aligned conclusion",
          "â€¢ Bulleted list with 5 items and Symbol font bullets"
        ]
      },
      {
        "input": "Convert report.docx to markdown showing all tracked changes, then grep for deleted text 'old value' and inserted text 'new value'.",
        "output": [
          "Conversion complete: report_with_changes.md",
          "Found 3 occurrences of 'new value' (insertions)",
          "Found 3 occurrences of 'old value' (deletions)",
          "Total tracked changes: 6 (3 insertions, 3 deletions)"
        ]
      }
    ],
    "best_practices": [
      "Always unpack DOCX files before editing and repack after changes to maintain OOXML structure.",
      "Use tracked changes for all edits to external documents - this is required for legal, academic, and business documents.",
      "Group related changes into batches of 3-10 for easier debugging and incremental progress."
    ],
    "anti_patterns": [
      "Do not use raw string replacement on DOCX files - always unpack, edit XML, and repack.",
      "Avoid modifying multiple XML elements in a single script without testing batch-by-batch.",
      "Do not skip reading the full documentation files before starting complex document operations."
    ],
    "faq": [
      {
        "question": "What dependencies are required for this skill?",
        "answer": "The skill requires pandoc, docx (npm), LibreOffice, poppler-utils, and defusedxml (pip). Install them as documented in SKILL.md."
      },
      {
        "question": "How do I create a new Word document from scratch?",
        "answer": "Read docx-js.md for complete syntax, then create a JavaScript/TypeScript file using Document, Paragraph, and TextRun components, then export using Packer.toBuffer()."
      },
      {
        "question": "Can I edit someone elses document with tracked changes?",
        "answer": "Yes. Use the redlining workflow: unpack the document, create a Python script using the Document library, implement changes with tracked changes, then repack."
      },
      {
        "question": "How do I preserve formatting when editing documents?",
        "answer": "Extract the original run (w:r) element for unchanged text and reuse its RSID. Only mark what actually changed in w:ins and w:del elements."
      },
      {
        "question": "What file operations are safe in DOCX files?",
        "answer": "Use the unpack/pack workflow with ooxml/scripts/unpack.py and ooxml/scripts/pack.py. Never modify DOCX files directly as ZIP archives."
      },
      {
        "question": "How do I validate a document after editing?",
        "answer": "Use python ooxml/scripts/pack.py with the --force flag to skip validation, or without --force to validate using LibreOffice soffice."
      }
    ]
  },
  "file_structure": [
    {
      "name": "ooxml",
      "type": "dir",
      "path": "ooxml",
      "children": [
        {
          "name": "schemas",
          "type": "dir",
          "path": "ooxml/schemas",
          "children": [
            {
              "name": "ecma",
              "type": "dir",
              "path": "ooxml/schemas/ecma",
              "children": [
                {
                  "name": "fouth-edition",
                  "type": "dir",
                  "path": "ooxml/schemas/ecma/fouth-edition"
                }
              ]
            },
            {
              "name": "ISO-IEC29500-4_2016",
              "type": "dir",
              "path": "ooxml/schemas/ISO-IEC29500-4_2016",
              "children": [
                {
                  "name": "dml-chart.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chart.xsd",
                  "lines": 1500
                },
                {
                  "name": "dml-chartDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chartDrawing.xsd",
                  "lines": 147
                },
                {
                  "name": "dml-diagram.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-diagram.xsd",
                  "lines": 1086
                },
                {
                  "name": "dml-lockedCanvas.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-lockedCanvas.xsd",
                  "lines": 12
                },
                {
                  "name": "dml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-main.xsd",
                  "lines": 3082
                },
                {
                  "name": "dml-picture.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-picture.xsd",
                  "lines": 24
                },
                {
                  "name": "dml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-spreadsheetDrawing.xsd",
                  "lines": 186
                },
                {
                  "name": "dml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-wordprocessingDrawing.xsd",
                  "lines": 288
                },
                {
                  "name": "pml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/pml.xsd",
                  "lines": 1677
                },
                {
                  "name": "shared-additionalCharacteristics.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-additionalCharacteristics.xsd",
                  "lines": 29
                },
                {
                  "name": "shared-bibliography.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-bibliography.xsd",
                  "lines": 145
                },
                {
                  "name": "shared-commonSimpleTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-commonSimpleTypes.xsd",
                  "lines": 175
                },
                {
                  "name": "shared-customXmlDataProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlDataProperties.xsd",
                  "lines": 26
                },
                {
                  "name": "shared-customXmlSchemaProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlSchemaProperties.xsd",
                  "lines": 19
                },
                {
                  "name": "shared-documentPropertiesCustom.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesCustom.xsd",
                  "lines": 60
                },
                {
                  "name": "shared-documentPropertiesExtended.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesExtended.xsd",
                  "lines": 57
                },
                {
                  "name": "shared-documentPropertiesVariantTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesVariantTypes.xsd",
                  "lines": 196
                },
                {
                  "name": "shared-math.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-math.xsd",
                  "lines": 583
                },
                {
                  "name": "shared-relationshipReference.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-relationshipReference.xsd",
                  "lines": 26
                },
                {
                  "name": "sml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/sml.xsd",
                  "lines": 4440
                },
                {
                  "name": "vml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-main.xsd",
                  "lines": 571
                },
                {
                  "name": "vml-officeDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-officeDrawing.xsd",
                  "lines": 510
                },
                {
                  "name": "vml-presentationDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-presentationDrawing.xsd",
                  "lines": 13
                },
                {
                  "name": "vml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-spreadsheetDrawing.xsd",
                  "lines": 109
                },
                {
                  "name": "vml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-wordprocessingDrawing.xsd",
                  "lines": 97
                },
                {
                  "name": "wml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/wml.xsd",
                  "lines": 3647
                },
                {
                  "name": "xml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/xml.xsd",
                  "lines": 117
                }
              ]
            },
            {
              "name": "mce",
              "type": "dir",
              "path": "ooxml/schemas/mce",
              "children": [
                {
                  "name": "mc.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/mce/mc.xsd",
                  "lines": 76
                }
              ]
            },
            {
              "name": "microsoft",
              "type": "dir",
              "path": "ooxml/schemas/microsoft",
              "children": [
                {
                  "name": "wml-2010.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2010.xsd",
                  "lines": 561
                },
                {
                  "name": "wml-2012.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2012.xsd",
                  "lines": 68
                },
                {
                  "name": "wml-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2018.xsd",
                  "lines": 15
                },
                {
                  "name": "wml-cex-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cex-2018.xsd",
                  "lines": 21
                },
                {
                  "name": "wml-cid-2016.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cid-2016.xsd",
                  "lines": 14
                },
                {
                  "name": "wml-sdtdatahash-2020.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-sdtdatahash-2020.xsd",
                  "lines": 5
                },
                {
                  "name": "wml-symex-2015.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-symex-2015.xsd",
                  "lines": 9
                }
              ]
            }
          ]
        },
        {
          "name": "scripts",
          "type": "dir",
          "path": "ooxml/scripts",
          "children": [
            {
              "name": "validation",
              "type": "dir",
              "path": "ooxml/scripts/validation",
              "children": [
                {
                  "name": "__init__.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/__init__.py",
                  "lines": 16
                },
                {
                  "name": "base.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/base.py",
                  "lines": 952
                },
                {
                  "name": "docx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/docx.py",
                  "lines": 275
                },
                {
                  "name": "pptx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/pptx.py",
                  "lines": 316
                },
                {
                  "name": "redlining.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/redlining.py",
                  "lines": 280
                }
              ]
            },
            {
              "name": "pack.py",
              "type": "file",
              "path": "ooxml/scripts/pack.py",
              "lines": 160
            },
            {
              "name": "unpack.py",
              "type": "file",
              "path": "ooxml/scripts/unpack.py",
              "lines": 30
            },
            {
              "name": "validate.py",
              "type": "file",
              "path": "ooxml/scripts/validate.py",
              "lines": 70
            }
          ]
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "templates",
          "type": "dir",
          "path": "scripts/templates",
          "children": [
            {
              "name": "comments.xml",
              "type": "file",
              "path": "scripts/templates/comments.xml",
              "lines": 3
            },
            {
              "name": "commentsExtended.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtended.xml",
              "lines": 3
            },
            {
              "name": "commentsExtensible.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtensible.xml",
              "lines": 3
            },
            {
              "name": "commentsIds.xml",
              "type": "file",
              "path": "scripts/templates/commentsIds.xml",
              "lines": 3
            },
            {
              "name": "people.xml",
              "type": "file",
              "path": "scripts/templates/people.xml",
              "lines": 3
            }
          ]
        },
        {
          "name": "__init__.py",
          "type": "file",
          "path": "scripts/__init__.py",
          "lines": 2
        },
        {
          "name": "document.py",
          "type": "file",
          "path": "scripts/document.py",
          "lines": 1277
        },
        {
          "name": "utilities.py",
          "type": "file",
          "path": "scripts/utilities.py",
          "lines": 375
        }
      ]
    },
    {
      "name": "docx-js.md",
      "type": "file",
      "path": "docx-js.md",
      "lines": 350
    },
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt",
      "lines": 31
    },
    {
      "name": "ooxml.md",
      "type": "file",
      "path": "ooxml.md",
      "lines": 610
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 197
    }
  ]
}
