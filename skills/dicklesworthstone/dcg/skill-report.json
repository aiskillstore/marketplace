{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-17T02:35:55.929Z",
    "slug": "dicklesworthstone-dcg",
    "source_url": "https://github.com/Dicklesworthstone/agent_flywheel_clawdbot_skills_and_integrations/tree/main/skills/dcg",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "f62fc2a13390be0ad4dae5acffd5236937172cad42a47095e44870361b1f2e76",
    "tree_hash": "6ad226e1b6635209b96d6e9bf9555ccfe412b5e2dc1d94f67c29784a81772036"
  },
  "skill": {
    "name": "dcg",
    "description": "Destructive Command Guard - High-performance Rust hook for Claude Code that blocks dangerous commands before execution. SIMD-accelerated, modular pack system, whitelist-first architecture. Essential safety layer for agent workflows.",
    "summary": "Destructive Command Guard - High-performance Rust hook for Claude Code that blocks dangerous command...",
    "icon": "ğŸ›¡ï¸",
    "version": "1.0.0",
    "author": "Dicklesworthstone",
    "license": "MIT",
    "category": "security",
    "tags": [
      "safety",
      "git",
      "command-guard",
      "destructive-commands"
    ],
    "supported_tools": [
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "filesystem",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Documentation-only skill describing a defensive safety tool. Pure markdown content with no executable code. The 223 static findings are FALSE POSITIVES - they flag documentation examples of dangerous commands that DCG is designed to BLOCK, not actual dangerous code. This skill contains only SKILL.md and skill-report.json, describing a protective Claude Code hook.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          },
          {
            "file": "SKILL.md",
            "line_start": 197,
            "line_end": 197
          },
          {
            "file": "SKILL.md",
            "line_start": 200,
            "line_end": 200
          },
          {
            "file": "SKILL.md",
            "line_start": 203,
            "line_end": 203
          },
          {
            "file": "SKILL.md",
            "line_start": 209,
            "line_end": 209
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 121,
            "line_end": 121
          },
          {
            "file": "skill-report.json",
            "line_start": 122,
            "line_end": 122
          },
          {
            "file": "skill-report.json",
            "line_start": 121,
            "line_end": 121
          },
          {
            "file": "skill-report.json",
            "line_start": 122,
            "line_end": 122
          },
          {
            "file": "SKILL.md",
            "line_start": 173,
            "line_end": 173
          },
          {
            "file": "SKILL.md",
            "line_start": 218,
            "line_end": 218
          },
          {
            "file": "SKILL.md",
            "line_start": 418,
            "line_end": 418
          },
          {
            "file": "SKILL.md",
            "line_start": 173,
            "line_end": 173
          },
          {
            "file": "SKILL.md",
            "line_start": 218,
            "line_end": 218
          },
          {
            "file": "SKILL.md",
            "line_start": 418,
            "line_end": 418
          },
          {
            "file": "SKILL.md",
            "line_start": 92,
            "line_end": 92
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 14,
            "line_end": 14
          },
          {
            "file": "SKILL.md",
            "line_start": 15,
            "line_end": 15
          },
          {
            "file": "SKILL.md",
            "line_start": 16,
            "line_end": 16
          },
          {
            "file": "SKILL.md",
            "line_start": 17,
            "line_end": 17
          },
          {
            "file": "SKILL.md",
            "line_start": 27,
            "line_end": 30
          },
          {
            "file": "SKILL.md",
            "line_start": 30,
            "line_end": 49
          },
          {
            "file": "SKILL.md",
            "line_start": 49,
            "line_end": 50
          },
          {
            "file": "SKILL.md",
            "line_start": 50,
            "line_end": 51
          },
          {
            "file": "SKILL.md",
            "line_start": 51,
            "line_end": 52
          },
          {
            "file": "SKILL.md",
            "line_start": 52,
            "line_end": 52
          },
          {
            "file": "SKILL.md",
            "line_start": 52,
            "line_end": 53
          },
          {
            "file": "SKILL.md",
            "line_start": 53,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 60
          },
          {
            "file": "SKILL.md",
            "line_start": 60,
            "line_end": 66
          },
          {
            "file": "SKILL.md",
            "line_start": 66,
            "line_end": 67
          },
          {
            "file": "SKILL.md",
            "line_start": 67,
            "line_end": 73
          },
          {
            "file": "SKILL.md",
            "line_start": 73,
            "line_end": 73
          },
          {
            "file": "SKILL.md",
            "line_start": 73,
            "line_end": 73
          },
          {
            "file": "SKILL.md",
            "line_start": 73,
            "line_end": 73
          },
          {
            "file": "SKILL.md",
            "line_start": 73,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 81
          },
          {
            "file": "SKILL.md",
            "line_start": 81,
            "line_end": 87
          },
          {
            "file": "SKILL.md",
            "line_start": 87,
            "line_end": 88
          },
          {
            "file": "SKILL.md",
            "line_start": 88,
            "line_end": 89
          },
          {
            "file": "SKILL.md",
            "line_start": 89,
            "line_end": 90
          },
          {
            "file": "SKILL.md",
            "line_start": 90,
            "line_end": 91
          },
          {
            "file": "SKILL.md",
            "line_start": 91,
            "line_end": 91
          },
          {
            "file": "SKILL.md",
            "line_start": 91,
            "line_end": 92
          },
          {
            "file": "SKILL.md",
            "line_start": 92,
            "line_end": 93
          },
          {
            "file": "SKILL.md",
            "line_start": 93,
            "line_end": 95
          },
          {
            "file": "SKILL.md",
            "line_start": 95,
            "line_end": 97
          },
          {
            "file": "SKILL.md",
            "line_start": 97,
            "line_end": 100
          },
          {
            "file": "SKILL.md",
            "line_start": 100,
            "line_end": 110
          },
          {
            "file": "SKILL.md",
            "line_start": 110,
            "line_end": 111
          },
          {
            "file": "SKILL.md",
            "line_start": 111,
            "line_end": 117
          },
          {
            "file": "SKILL.md",
            "line_start": 117,
            "line_end": 118
          },
          {
            "file": "SKILL.md",
            "line_start": 118,
            "line_end": 119
          },
          {
            "file": "SKILL.md",
            "line_start": 119,
            "line_end": 120
          },
          {
            "file": "SKILL.md",
            "line_start": 120,
            "line_end": 121
          },
          {
            "file": "SKILL.md",
            "line_start": 121,
            "line_end": 127
          },
          {
            "file": "SKILL.md",
            "line_start": 127,
            "line_end": 128
          },
          {
            "file": "SKILL.md",
            "line_start": 128,
            "line_end": 129
          },
          {
            "file": "SKILL.md",
            "line_start": 129,
            "line_end": 135
          },
          {
            "file": "SKILL.md",
            "line_start": 135,
            "line_end": 136
          },
          {
            "file": "SKILL.md",
            "line_start": 136,
            "line_end": 137
          },
          {
            "file": "SKILL.md",
            "line_start": 137,
            "line_end": 143
          },
          {
            "file": "SKILL.md",
            "line_start": 143,
            "line_end": 144
          },
          {
            "file": "SKILL.md",
            "line_start": 144,
            "line_end": 145
          },
          {
            "file": "SKILL.md",
            "line_start": 145,
            "line_end": 151
          },
          {
            "file": "SKILL.md",
            "line_start": 151,
            "line_end": 152
          },
          {
            "file": "SKILL.md",
            "line_start": 152,
            "line_end": 153
          },
          {
            "file": "SKILL.md",
            "line_start": 153,
            "line_end": 159
          },
          {
            "file": "SKILL.md",
            "line_start": 159,
            "line_end": 160
          },
          {
            "file": "SKILL.md",
            "line_start": 160,
            "line_end": 161
          },
          {
            "file": "SKILL.md",
            "line_start": 161,
            "line_end": 167
          },
          {
            "file": "SKILL.md",
            "line_start": 167,
            "line_end": 168
          },
          {
            "file": "SKILL.md",
            "line_start": 168,
            "line_end": 172
          },
          {
            "file": "SKILL.md",
            "line_start": 172,
            "line_end": 180
          },
          {
            "file": "SKILL.md",
            "line_start": 180,
            "line_end": 186
          },
          {
            "file": "SKILL.md",
            "line_start": 186,
            "line_end": 187
          },
          {
            "file": "SKILL.md",
            "line_start": 187,
            "line_end": 188
          },
          {
            "file": "SKILL.md",
            "line_start": 188,
            "line_end": 189
          },
          {
            "file": "SKILL.md",
            "line_start": 189,
            "line_end": 190
          },
          {
            "file": "SKILL.md",
            "line_start": 190,
            "line_end": 196
          },
          {
            "file": "SKILL.md",
            "line_start": 196,
            "line_end": 204
          },
          {
            "file": "SKILL.md",
            "line_start": 204,
            "line_end": 208
          },
          {
            "file": "SKILL.md",
            "line_start": 208,
            "line_end": 210
          },
          {
            "file": "SKILL.md",
            "line_start": 210,
            "line_end": 218
          },
          {
            "file": "SKILL.md",
            "line_start": 218,
            "line_end": 220
          },
          {
            "file": "SKILL.md",
            "line_start": 220,
            "line_end": 236
          },
          {
            "file": "SKILL.md",
            "line_start": 236,
            "line_end": 244
          },
          {
            "file": "SKILL.md",
            "line_start": 244,
            "line_end": 247
          },
          {
            "file": "SKILL.md",
            "line_start": 247,
            "line_end": 269
          },
          {
            "file": "SKILL.md",
            "line_start": 269,
            "line_end": 273
          },
          {
            "file": "SKILL.md",
            "line_start": 273,
            "line_end": 277
          },
          {
            "file": "SKILL.md",
            "line_start": 277,
            "line_end": 277
          },
          {
            "file": "SKILL.md",
            "line_start": 277,
            "line_end": 293
          },
          {
            "file": "SKILL.md",
            "line_start": 293,
            "line_end": 294
          },
          {
            "file": "SKILL.md",
            "line_start": 294,
            "line_end": 300
          },
          {
            "file": "SKILL.md",
            "line_start": 300,
            "line_end": 306
          },
          {
            "file": "SKILL.md",
            "line_start": 306,
            "line_end": 310
          },
          {
            "file": "SKILL.md",
            "line_start": 310,
            "line_end": 321
          },
          {
            "file": "SKILL.md",
            "line_start": 321,
            "line_end": 327
          },
          {
            "file": "SKILL.md",
            "line_start": 327,
            "line_end": 327
          },
          {
            "file": "SKILL.md",
            "line_start": 327,
            "line_end": 328
          },
          {
            "file": "SKILL.md",
            "line_start": 328,
            "line_end": 329
          },
          {
            "file": "SKILL.md",
            "line_start": 329,
            "line_end": 330
          },
          {
            "file": "SKILL.md",
            "line_start": 330,
            "line_end": 336
          },
          {
            "file": "SKILL.md",
            "line_start": 336,
            "line_end": 340
          },
          {
            "file": "SKILL.md",
            "line_start": 340,
            "line_end": 344
          },
          {
            "file": "SKILL.md",
            "line_start": 344,
            "line_end": 349
          },
          {
            "file": "SKILL.md",
            "line_start": 349,
            "line_end": 355
          },
          {
            "file": "SKILL.md",
            "line_start": 355,
            "line_end": 360
          },
          {
            "file": "SKILL.md",
            "line_start": 360,
            "line_end": 364
          },
          {
            "file": "SKILL.md",
            "line_start": 364,
            "line_end": 370
          },
          {
            "file": "SKILL.md",
            "line_start": 370,
            "line_end": 378
          },
          {
            "file": "SKILL.md",
            "line_start": 378,
            "line_end": 379
          },
          {
            "file": "SKILL.md",
            "line_start": 379,
            "line_end": 381
          },
          {
            "file": "SKILL.md",
            "line_start": 381,
            "line_end": 382
          },
          {
            "file": "SKILL.md",
            "line_start": 382,
            "line_end": 383
          },
          {
            "file": "SKILL.md",
            "line_start": 383,
            "line_end": 398
          },
          {
            "file": "SKILL.md",
            "line_start": 398,
            "line_end": 398
          },
          {
            "file": "SKILL.md",
            "line_start": 398,
            "line_end": 400
          },
          {
            "file": "SKILL.md",
            "line_start": 400,
            "line_end": 401
          },
          {
            "file": "SKILL.md",
            "line_start": 401,
            "line_end": 408
          },
          {
            "file": "SKILL.md",
            "line_start": 408,
            "line_end": 418
          },
          {
            "file": "SKILL.md",
            "line_start": 418,
            "line_end": 420
          },
          {
            "file": "SKILL.md",
            "line_start": 420,
            "line_end": 426
          },
          {
            "file": "SKILL.md",
            "line_start": 426,
            "line_end": 430
          },
          {
            "file": "SKILL.md",
            "line_start": 430,
            "line_end": 430
          },
          {
            "file": "SKILL.md",
            "line_start": 430,
            "line_end": 432
          },
          {
            "file": "SKILL.md",
            "line_start": 432,
            "line_end": 432
          },
          {
            "file": "SKILL.md",
            "line_start": 432,
            "line_end": 434
          },
          {
            "file": "SKILL.md",
            "line_start": 434,
            "line_end": 438
          },
          {
            "file": "SKILL.md",
            "line_start": 197,
            "line_end": 197
          },
          {
            "file": "SKILL.md",
            "line_start": 200,
            "line_end": 200
          },
          {
            "file": "SKILL.md",
            "line_start": 203,
            "line_end": 203
          },
          {
            "file": "SKILL.md",
            "line_start": 196,
            "line_end": 204
          },
          {
            "file": "SKILL.md",
            "line_start": 203,
            "line_end": 203
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 628,
    "audit_model": "claude",
    "audited_at": "2026-01-17T02:35:55.929Z"
  },
  "content": {
    "user_title": "Block Dangerous Commands Before Execution",
    "value_statement": "AI coding agents can accidentally run destructive commands like rm -rf or git reset --hard. This high-performance Rust hook intercepts dangerous commands before execution and blocks them with clear explanations.",
    "seo_keywords": [
      "Claude Code",
      "command safety",
      "git protection",
      "destructive command block",
      "rm -rf guard",
      "force push prevention",
      "AI safety",
      "agent workflow protection"
    ],
    "actual_capabilities": [
      "Intercepts bash commands before execution via Claude Code PreToolUse hook",
      "Blocks destructive git commands: reset --hard, clean, checkout --, branch -D",
      "Blocks dangerous rm -rf operations outside temp directories",
      "Supports modular packs for databases, containers, Kubernetes, and cloud providers",
      "Whitelist-first architecture ensures safe commands are never blocked",
      "Sub-millisecond latency with SIMD-accelerated pattern matching"
    ],
    "limitations": [
      "Only protects Bash commands, not Python or JavaScript file writes",
      "Does not inspect commands inside executed scripts or shell files",
      "Cannot prevent commands run manually outside of Claude Code",
      "Skips protection for non-Bash tool usage in Claude Code"
    ],
    "use_cases": [
      {
        "target_user": "Development teams using AI coding agents",
        "title": "Prevent accidental git history loss",
        "description": "Stop AI agents from accidentally running git reset --hard or force pushing, which could destroy uncommitted or remote work."
      },
      {
        "target_user": "DevOps engineers",
        "title": "Block destructive infrastructure commands",
        "description": "Prevent AI agents from running rm -rf on production directories or executing terraform destroy without explicit approval."
      },
      {
        "target_user": "Data engineers",
        "title": "Protect databases from accidental drops",
        "description": "Guard against accidental DROP TABLE or FLUSHALL commands when AI agents interact with databases."
      }
    ],
    "prompt_templates": [
      {
        "title": "Install DCG",
        "scenario": "Add safety guard to Claude Code",
        "prompt": "Install and configure DCG Destructive Command Guard to protect against accidental destructive commands in my Claude Code setup."
      },
      {
        "title": "Configure packs",
        "scenario": "Enable database protection",
        "prompt": "Enable the database protection packs for PostgreSQL and MongoDB in DCG configuration."
      },
      {
        "title": "Test blocking",
        "scenario": "Verify dangerous commands are blocked",
        "prompt": "Test that git reset --hard and rm -rf commands are properly blocked when running through Claude Code."
      },
      {
        "title": "Bypass safely",
        "scenario": "Temporarily disable protection",
        "prompt": "Explain how to temporarily bypass DCG when I need to run a legitimately destructive command."
      }
    ],
    "output_examples": [
      {
        "input": "Install DCG and configure it to block dangerous git and filesystem commands",
        "output": [
          "âœ“ DCG installed via curl script",
          "âœ“ Configuration created at ~/.config/dcg/config.toml",
          "âœ“ Claude Code hook configured in ~/.claude/settings.json",
          "âœ“ Protected commands: git reset --hard, git clean, rm -rf (non-temp)",
          "âœ“ Restart Claude Code to activate protection"
        ]
      },
      {
        "input": "Try to run git reset --hard through Claude Code with DCG enabled",
        "output": [
          "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—",
          "â•‘ BLOCKED  dcg                                                   â•‘",
          "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",
          "â•‘ Reason: git reset --hard destroys uncommitted changes.         â•‘",
          "â•‘         Use 'git stash' first.                                 â•‘",
          "â•‘                                                                 â•‘",
          "â•‘ Command: git reset --hard HEAD~1                               â•‘",
          "â•‘                                                                 â•‘",
          "â•‘ Tip: Run manually in terminal after stash.                     â•‘",
          "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        ]
      },
      {
        "input": "Configure DCG to protect databases and kubernetes resources",
        "output": [
          "âœ“ Enabled database.postgresql pack (blocks DROP/TRUNCATE)",
          "âœ“ Enabled database.mysql pack (blocks DROP/TRUNCATE)",
          "âœ“ Enabled database.mongodb pack (blocks dropDatabase)",
          "âœ“ Enabled kubernetes.kubectl pack (blocks delete namespace)",
          "âœ“ Enabled kubernetes.helm pack (blocks helm uninstall)",
          "âœ“ DCG restarted with new configuration"
        ]
      }
    ],
    "best_practices": [
      "Install DCG before running AI agents on important projects to prevent costly mistakes",
      "Enable additional packs (databases, containers, cloud) based on your infrastructure",
      "Use git stash instead of blocked reset commands to preserve uncommitted work"
    ],
    "anti_patterns": [
      "Running AI agents without any destructive command protection",
      "Blocking DCG with DCG_BYPASS=1 for routine tasks",
      "Ignoring DCG block messages and manually running blocked commands without checking"
    ],
    "faq": [
      {
        "question": "Does DCG work with Claude Code running on Windows?",
        "answer": "DCG supports Windows but requires WSL or the prebuilt Windows binary. Linux and macOS have native support."
      },
      {
        "question": "What is the performance impact of DCG on Claude Code?",
        "answer": "DCG adds sub-millisecond latency using SIMD pattern matching. Most users report no noticeable performance impact."
      },
      {
        "question": "Can DCG be integrated with other AI coding tools?",
        "answer": "DCG is designed for Claude Code PreToolUse hooks. Integration with other tools requires custom implementation."
      },
      {
        "question": "Does DCG collect or transmit any user data?",
        "answer": "DCG runs locally and only analyzes commands locally. No data is collected or transmitted to external servers."
      },
      {
        "question": "Why is my safe git command being blocked?",
        "answer": "File an issue on the GitHub repository. The whitelist-first design means safe commands should not be blocked."
      },
      {
        "question": "How does DCG compare to git hooks or safe commands?",
        "answer": "DCG operates at the AI agent level, catching mistakes before git processes start. Git hooks run after the command is already formed."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 455
    }
  ]
}
