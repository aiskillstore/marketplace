{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-21T17:46:02.942Z",
    "slug": "diet103-route-tester",
    "source_url": "https://github.com/diet103/claude-code-infrastructure-showcase/tree/main/.claude/skills/route-tester",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "4f8f6f8c7e2cdf3d9c39e0eedfc4b20047b02503218c54ebbd8db0feedbb21a3",
    "tree_hash": "63989bb68fcfee8fb177c8e35e0565a27076822e5bb271a6d5b6bc2f6f7bd3c8"
  },
  "skill": {
    "name": "route-tester",
    "description": "Test authenticated routes in your project using cookie-based authentication. Use this skill when testing API endpoints, validating route functionality, or debugging authentication issues. Includes patterns for using test-auth-route.js and mock authentication.",
    "summary": "Comprehensive guide for testing authenticated API routes with cookie-based JWT authentication in Node.js projects",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "diet103",
    "license": "MIT",
    "category": "devops",
    "tags": [
      "testing",
      "authentication",
      "api",
      "jwt",
      "keycloak"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill is a documentation-only resource providing testing patterns for authenticated API routes. All 123 static findings are false positives from pattern detection in code examples, shell commands, and URLs within the documentation. The skill contains no executable code, scripts, or malicious patterns. The URLs reference localhost development environments, commands show testing examples, and file paths are documentation references. No actual security risks identified.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "risk_factors": [],
    "risk_factor_evidence": [],
    "files_scanned": 2,
    "total_lines": 1686,
    "audit_model": "claude",
    "audited_at": "2026-01-21T17:46:02.942Z"
  },
  "content": {
    "user_title": "Test Authenticated API Routes with Cookie-Based JWT",
    "value_statement": "Testing authenticated routes can be complex when using cookie-based JWT authentication with Keycloak. This skill provides comprehensive patterns and examples for testing API endpoints in development, including automated scripts, manual curl commands, and mock authentication strategies.",
    "seo_keywords": [
      "Claude Code",
      "API testing",
      "authentication testing",
      "JWT cookies",
      "Keycloak testing",
      "route testing",
      "Node.js API",
      "Claude",
      "Codex",
      "authenticated endpoints"
    ],
    "actual_capabilities": [
      "Provides patterns for testing authenticated routes using test-auth-route.js script with automatic token generation",
      "Demonstrates three testing methods: automated script, manual curl commands, and mock authentication for development",
      "Includes examples for testing GET, POST, PUT, DELETE operations with proper authentication headers and cookies",
      "Shows how to verify database changes after route execution and debug common authentication errors",
      "Covers service port mappings, route prefixes, and URL construction for multi-service architectures",
      "Provides troubleshooting guides for 401, 403, 404, and 500 errors in authenticated route testing"
    ],
    "limitations": [
      "Documentation is specific to projects using Keycloak for SSO and cookie-based JWT authentication",
      "Examples reference a specific project structure that may not match all Node.js applications",
      "Mock authentication only works in development or test environments and requires specific middleware setup",
      "Does not include the actual test-auth-route.js script implementation, only usage examples"
    ],
    "use_cases": [
      {
        "title": "Test New API Endpoints After Development",
        "description": "After creating a new authenticated route, use the test-auth-route.js script to validate the endpoint works correctly with proper authentication, then verify database changes and response format.",
        "target_user": "Backend developers building new API features"
      },
      {
        "title": "Debug Authentication Issues in Microservices",
        "description": "When routes return 401 or 403 errors, use the troubleshooting patterns to identify whether the issue is token expiration, incorrect cookie format, JWT secret mismatch, or missing permissions.",
        "target_user": "DevOps engineers troubleshooting authentication problems"
      },
      {
        "title": "Validate Route Changes with Mock Authentication",
        "description": "During development, use mock authentication headers to quickly test route modifications without setting up full Keycloak infrastructure, then verify backward compatibility with existing clients.",
        "target_user": "QA engineers testing API changes"
      }
    ],
    "prompt_templates": [
      {
        "title": "Test a Simple GET Endpoint",
        "prompt": "Help me test the GET endpoint at /api/users/profile using the test-auth-route.js script",
        "scenario": "You need to verify a basic authenticated GET request works correctly"
      },
      {
        "title": "Test POST Request with JSON Payload",
        "prompt": "I need to test the POST endpoint at /api/workflow/start with this JSON data: {workflowCode: DHS_CLOSEOUT, entityType: Submission, entityID: 123}. Show me how to use test-auth-route.js",
        "scenario": "You want to test a route that accepts JSON data and creates database records"
      },
      {
        "title": "Debug 401 Authentication Error",
        "prompt": "My route at /api/protected is returning 401 Unauthorized. Help me debug this using the patterns in route-tester skill",
        "scenario": "You are getting authentication errors and need to troubleshoot the token or cookie configuration"
      },
      {
        "title": "Set Up Mock Authentication for Testing",
        "prompt": "Configure mock authentication for my service so I can test routes without Keycloak during development",
        "scenario": "You want to bypass full authentication setup during rapid development iterations"
      }
    ],
    "output_examples": [
      {
        "input": "Test the endpoint /api/workflow/start with POST data",
        "output": "Run this command to test the authenticated endpoint:\n\nnode scripts/test-auth-route.js http://localhost:3002/api/workflow/start POST '{\"workflowCode\":\"DHS_CLOSEOUT\",\"entityType\":\"Submission\",\"entityID\":123}'\n\nThis will automatically:\n1. Get a refresh token from Keycloak using testuser credentials\n2. Sign the token with the JWT secret from config.ini\n3. Make the authenticated POST request with the cookie header\n4. Display the response and provide a curl command for manual testing"
      },
      {
        "input": "My route returns 401 error, how do I debug this?",
        "output": "For 401 Unauthorized errors, check these common causes:\n\n1. Verify Keycloak is running:\ndocker ps | grep keycloak\n\n2. Regenerate a fresh token:\nnode scripts/test-auth-route.js http://localhost:3002/api/health\n\n3. Verify config.ini has the correct jwtSecret\n\n4. Check the cookie format matches: refresh_token=<signed-token>\n\nThe token may have expired or the JWT secret might not match between the auth service and your application service."
      },
      {
        "input": "Set up mock authentication for development testing",
        "output": "Add these environment variables to your service .env file:\n\nMOCK_AUTH=true\nMOCK_USER_ID=test-user\nMOCK_USER_ROLES=admin,operations\n\nThen test routes using mock headers:\n\ncurl -H \"X-Mock-Auth: true\" -H \"X-Mock-User: test-user\" -H \"X-Mock-Roles: admin,operations\" http://localhost:3002/api/protected\n\nNote: Mock auth only works when NODE_ENV is development or test, and the mockAuth middleware is added to the route. It will never work in production."
      }
    ],
    "best_practices": [
      "Always use test-auth-route.js script for consistent token generation and authentication rather than manually constructing JWT tokens",
      "Verify database changes after testing routes that modify data by querying the affected tables directly",
      "Use mock authentication during rapid development but always test with real Keycloak authentication before deploying to staging or production"
    ],
    "anti_patterns": [
      "Do not hardcode JWT tokens in test scripts as they expire and will cause intermittent test failures",
      "Avoid using mock authentication in production or staging environments as it bypasses all security controls",
      "Do not test routes without verifying the full URL construction including base URL, service port, and route prefix to avoid 404 errors"
    ],
    "faq": [
      {
        "question": "What authentication method does this skill support?",
        "answer": "This skill supports testing routes that use cookie-based JWT authentication with Keycloak SSO. The JWT token is passed in a cookie named refresh_token rather than in Authorization headers."
      },
      {
        "question": "Can I use this skill without the test-auth-route.js script?",
        "answer": "Yes, the skill provides three methods: automated script, manual curl commands with tokens copied from script output, and mock authentication for development. You can use any method based on your needs."
      },
      {
        "question": "How do I find the correct port and URL for my service?",
        "answer": "The skill includes a service port mapping table and explains how to construct full URLs by combining base URL, service port, route prefix from app.ts, and the route path."
      },
      {
        "question": "What should I do if I get a 401 Unauthorized error?",
        "answer": "Check that Keycloak is running, regenerate a fresh token using the test script, verify the JWT secret in config.ini matches across services, and confirm the cookie format is correct."
      },
      {
        "question": "Is mock authentication safe to use?",
        "answer": "Mock authentication is safe for development and test environments only. It includes security checks to prevent use in production and requires NODE_ENV to be set to development or test."
      },
      {
        "question": "Can I test file uploads with this skill?",
        "answer": "Yes, the skill provides an example of testing file uploads by first getting a token from test-auth-route.js, then using curl with multipart form data and the cookie header."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 389
    }
  ]
}
