{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T14:23:11.678Z",
    "slug": "0xdarkmatter-structural-search",
    "source_url": "https://github.com/0xDarkMatter/claude-mods/tree/main/skills/structural-search",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "4e60c2443ca4485ba56ed44456f3eac0f8924c1ea06d259d5ca2be7d91bc1ee7",
    "tree_hash": "f21dda1884ac656942205e72d10f9a5e6a010d4ad918a80d08ffc3f8afc833b9"
  },
  "skill": {
    "name": "structural-search",
    "description": "Search code by AST structure using ast-grep. Find semantic patterns like function calls, imports, class definitions instead of text patterns. Triggers on: find all calls to X, search for pattern, refactor usages, find where function is used, structural search, ast-grep, sg.",
    "summary": "Search code by AST structure using ast-grep. Find semantic patterns like function calls, imports, cl...",
    "icon": "ğŸ”",
    "version": "1.0.0",
    "author": "0xDarkMatter",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "code-search",
      "refactoring",
      "ast-grep",
      "security-analysis",
      "patterns"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands",
      "scripts",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Documentation-only skill containing pattern references for ast-grep CLI. No executable code, network calls, filesystem access, or external command execution detected. All 175 static findings are false positives: bash command examples in documentation were incorrectly flagged as external command execution, and security pattern examples were misidentified as vulnerabilities.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "assets/rule-template.yaml",
            "line_start": 36,
            "line_end": 36
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 31,
            "line_end": 31
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 119,
            "line_end": 119
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 15,
            "line_end": 15
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 18,
            "line_end": 18
          },
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "references/advanced-usage.md",
            "line_start": 7,
            "line_end": 25
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 25,
            "line_end": 29
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 29,
            "line_end": 44
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 44,
            "line_end": 48
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 48,
            "line_end": 48
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 48,
            "line_end": 50
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 50,
            "line_end": 58
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 58,
            "line_end": 62
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 62,
            "line_end": 64
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 64,
            "line_end": 83
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 83,
            "line_end": 87
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 87,
            "line_end": 120
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 120,
            "line_end": 124
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 124,
            "line_end": 139
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 139,
            "line_end": 143
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 143,
            "line_end": 145
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 145,
            "line_end": 167
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 167,
            "line_end": 173
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 173,
            "line_end": 182
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 182,
            "line_end": 185
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 185,
            "line_end": 187
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 187,
            "line_end": 193
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 193,
            "line_end": 203
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 203,
            "line_end": 207
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 207,
            "line_end": 217
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 217,
            "line_end": 221
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 221,
            "line_end": 228
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 228,
            "line_end": 240
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 212,
            "line_end": 212
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 207,
            "line_end": 217
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 34,
            "line_end": 34
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 37,
            "line_end": 37
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 40,
            "line_end": 40
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 43,
            "line_end": 43
          },
          {
            "file": "references/advanced-usage.md",
            "line_start": 239,
            "line_end": 239
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 171,
            "line_end": 171
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 9,
            "line_end": 21
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 21,
            "line_end": 25
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 25,
            "line_end": 34
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 34,
            "line_end": 38
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 38,
            "line_end": 47
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 47,
            "line_end": 51
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 51,
            "line_end": 67
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 67,
            "line_end": 71
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 71,
            "line_end": 83
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 83,
            "line_end": 91
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 91,
            "line_end": 103
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 103,
            "line_end": 107
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 107,
            "line_end": 116
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 116,
            "line_end": 120
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 120,
            "line_end": 135
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 135,
            "line_end": 139
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 139,
            "line_end": 148
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 148,
            "line_end": 152
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 152,
            "line_end": 162
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 162,
            "line_end": 166
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 166,
            "line_end": 175
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 175,
            "line_end": 179
          },
          {
            "file": "references/go-rust-patterns.md",
            "line_start": 179,
            "line_end": 191
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 7,
            "line_end": 25
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 25,
            "line_end": 29
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 29,
            "line_end": 47
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 47,
            "line_end": 51
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 51,
            "line_end": 66
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 66,
            "line_end": 70
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 70,
            "line_end": 85
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 85,
            "line_end": 89
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 89,
            "line_end": 107
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 107,
            "line_end": 113
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 113,
            "line_end": 122
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 122,
            "line_end": 126
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 126,
            "line_end": 137
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 7,
            "line_end": 19
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 19,
            "line_end": 23
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 23,
            "line_end": 43
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 43,
            "line_end": 47
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 47,
            "line_end": 59
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 59,
            "line_end": 63
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 63,
            "line_end": 81
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 81,
            "line_end": 85
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 85,
            "line_end": 94
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 94,
            "line_end": 98
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 98,
            "line_end": 116
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 116,
            "line_end": 120
          },
          {
            "file": "references/python-patterns.md",
            "line_start": 120,
            "line_end": 131
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 76,
            "line_end": 76
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 79,
            "line_end": 79
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 69,
            "line_end": 69
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 77,
            "line_end": 77
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 78,
            "line_end": 78
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 74,
            "line_end": 74
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 71,
            "line_end": 71
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 7,
            "line_end": 13
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 13,
            "line_end": 18
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 18,
            "line_end": 22
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 22,
            "line_end": 40
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 40,
            "line_end": 44
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 44,
            "line_end": 63
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 63,
            "line_end": 67
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 67,
            "line_end": 80
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 80,
            "line_end": 84
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 84,
            "line_end": 93
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 93,
            "line_end": 97
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 97,
            "line_end": 106
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 106,
            "line_end": 110
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 110,
            "line_end": 120
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 120,
            "line_end": 124
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 124,
            "line_end": 134
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 134,
            "line_end": 138
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 138,
            "line_end": 148
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 148,
            "line_end": 153
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 153,
            "line_end": 159
          },
          {
            "file": "SKILL.md",
            "line_start": 16,
            "line_end": 16
          },
          {
            "file": "SKILL.md",
            "line_start": 22,
            "line_end": 22
          },
          {
            "file": "SKILL.md",
            "line_start": 22,
            "line_end": 22
          },
          {
            "file": "SKILL.md",
            "line_start": 23,
            "line_end": 23
          },
          {
            "file": "SKILL.md",
            "line_start": 23,
            "line_end": 23
          },
          {
            "file": "SKILL.md",
            "line_start": 24,
            "line_end": 24
          },
          {
            "file": "SKILL.md",
            "line_start": 24,
            "line_end": 24
          },
          {
            "file": "SKILL.md",
            "line_start": 28,
            "line_end": 65
          },
          {
            "file": "SKILL.md",
            "line_start": 65,
            "line_end": 71
          },
          {
            "file": "SKILL.md",
            "line_start": 71,
            "line_end": 72
          },
          {
            "file": "SKILL.md",
            "line_start": 72,
            "line_end": 73
          },
          {
            "file": "SKILL.md",
            "line_start": 73,
            "line_end": 74
          },
          {
            "file": "SKILL.md",
            "line_start": 74,
            "line_end": 75
          },
          {
            "file": "SKILL.md",
            "line_start": 75,
            "line_end": 76
          },
          {
            "file": "SKILL.md",
            "line_start": 76,
            "line_end": 77
          },
          {
            "file": "SKILL.md",
            "line_start": 77,
            "line_end": 78
          },
          {
            "file": "SKILL.md",
            "line_start": 78,
            "line_end": 79
          },
          {
            "file": "SKILL.md",
            "line_start": 79,
            "line_end": 93
          },
          {
            "file": "SKILL.md",
            "line_start": 93,
            "line_end": 94
          },
          {
            "file": "SKILL.md",
            "line_start": 94,
            "line_end": 95
          },
          {
            "file": "SKILL.md",
            "line_start": 95,
            "line_end": 96
          },
          {
            "file": "SKILL.md",
            "line_start": 96,
            "line_end": 97
          },
          {
            "file": "SKILL.md",
            "line_start": 97,
            "line_end": 98
          }
        ]
      },
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 62,
            "line_end": 62
          },
          {
            "file": "references/js-ts-patterns.md",
            "line_start": 65,
            "line_end": 65
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 30,
            "line_end": 30
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 155,
            "line_end": 155
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 33,
            "line_end": 33
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 24,
            "line_end": 24
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 155,
            "line_end": 155
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 36,
            "line_end": 36
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 39,
            "line_end": 39
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 69,
            "line_end": 69
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 77,
            "line_end": 77
          },
          {
            "file": "skill-report.json",
            "line_start": 125,
            "line_end": 125
          },
          {
            "file": "skill-report.json",
            "line_start": 126,
            "line_end": 126
          },
          {
            "file": "skill-report.json",
            "line_start": 127,
            "line_end": 127
          },
          {
            "file": "SKILL.md",
            "line_start": 54,
            "line_end": 54
          },
          {
            "file": "SKILL.md",
            "line_start": 55,
            "line_end": 55
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "references/security-patterns.md",
            "line_start": 52,
            "line_end": 52
          },
          {
            "file": "references/security-patterns.md",
            "line_start": 53,
            "line_end": 53
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 8,
    "total_lines": 1224,
    "audit_model": "claude",
    "audited_at": "2026-01-16T14:23:11.678Z"
  },
  "content": {
    "user_title": "Search code by AST structure",
    "value_statement": "Finding code patterns with regex leads to false positives and missed matches. This skill provides AST-based search patterns that understand code structure, enabling precise code search and refactoring across JavaScript, TypeScript, Python, Go, and Rust.",
    "seo_keywords": [
      "ast-grep",
      "structural search",
      "code pattern matching",
      "Claude Code",
      "refactoring patterns",
      "code search tool",
      "AST patterns",
      "security vulnerability detection",
      "code analysis",
      "semantic search"
    ],
    "actual_capabilities": [
      "Find semantic code patterns like function calls, imports, and class definitions",
      "Detect security vulnerabilities including SQL injection, XSS vectors, and command injection",
      "Preview and apply code refactoring across entire codebases",
      "Create custom YAML rules for organization-wide linting",
      "Search multiple languages with language-specific patterns"
    ],
    "limitations": [
      "Requires ast-grep CLI tool to be installed separately",
      "Cannot search code without specifying a valid pattern syntax",
      "Patterns must match actual AST structure, not text substrings",
      "Does not modify code without explicit --rewrite flag"
    ],
    "use_cases": [
      {
        "target_user": "Security Engineers",
        "title": "Detect vulnerabilities",
        "description": "Find security issues like eval calls, innerHTML assignments, and hardcoded credentials across the codebase."
      },
      {
        "target_user": "Codebase Refactorers",
        "title": "Safe refactoring",
        "description": "Preview structural changes before applying them, ensuring no unintended modifications occur."
      },
      {
        "target_user": "Framework Migrators",
        "title": "Pattern migration",
        "description": "Convert patterns like require to import statements or var to const across entire projects."
      }
    ],
    "prompt_templates": [
      {
        "title": "Find function calls",
        "scenario": "Locate specific function usage",
        "prompt": "Find all calls to [function_name] using ast-grep structural search. Show file paths and line numbers."
      },
      {
        "title": "Detect security issue",
        "scenario": "Find security anti-patterns",
        "prompt": "Search for [eval/innerHTML/innerText/command injection] patterns that could be security vulnerabilities."
      },
      {
        "title": "Preview refactor",
        "scenario": "Prepare code changes",
        "prompt": "Preview refactoring [old_pattern] to [new_pattern] without applying changes. Show all matches first."
      },
      {
        "title": "Custom rule",
        "scenario": "Create organization rule",
        "prompt": "Create an ast-grep YAML rule that detects [anti-pattern] with message [warning_message]."
      }
    ],
    "output_examples": [
      {
        "input": "Find all eval calls in the codebase",
        "output": [
          "Found 3 eval calls:",
          "  - src/auth.js:42 - eval(userInput)",
          "  - src/utils.js:15 - eval(dynamicCode)",
          "  - src/parser.js:88 - eval(config.script)",
          "Recommendation: Replace eval with safer alternatives like JSON.parse for data or Function constructors for specific use cases."
        ]
      },
      {
        "input": "Convert var to const across TypeScript files",
        "output": [
          "Previewing 12 matches for pattern: var $NAME = $_",
          "  - components/Button.tsx:5 - var theme = 'dark'",
          "  - components/Modal.tsx:12 - var count = 0",
          "  - utils/api.ts:8 - var endpoint = '/api/v1'",
          "Run with --rewrite to apply changes to all files."
        ]
      }
    ],
    "best_practices": [
      "Always preview refactoring with sg -p 'pattern' -r 'replacement' before using --rewrite to apply changes.",
      "Create YAML rules in a rules/ directory and run sg scan to enforce organization-wide coding standards.",
      "Combine ast-grep with pre-commit hooks to catch issues before code reaches the repository."
    ],
    "anti_patterns": [
      "Using regex for code search instead of AST patterns, which misses structural matches and produces false positives.",
      "Running sg scan --fix without reviewing changes first, which can introduce unintended modifications.",
      "Applying broad patterns like $_ == $_ without understanding context, which matches legitimate code patterns."
    ],
    "faq": [
      {
        "question": "Does this skill work offline?",
        "answer": "Yes. The skill provides patterns and documentation. The ast-grep tool runs locally on your machine."
      },
      {
        "question": "What languages are supported?",
        "answer": "JavaScript, TypeScript, Python, Go, Rust, and several other languages through the --lang flag."
      },
      {
        "question": "How do I install ast-grep?",
        "answer": "Run brew install ast-grep on macOS or cargo install ast-grep on Linux and Windows."
      },
      {
        "question": "Is my code sent anywhere?",
        "answer": "No. ast-grep searches code locally and does not transmit data to external servers."
      },
      {
        "question": "Why not use grep or regex?",
        "answer": "Regex matches text patterns, not code structure. AST search understands parentheses, scope, and syntax."
      },
      {
        "question": "Can this skill modify my code?",
        "answer": "Only with the --rewrite flag. Preview first with sg -p 'pattern' -r 'replacement' to see changes."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "rule-template.yaml",
          "type": "file",
          "path": "assets/rule-template.yaml",
          "lines": 37
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "advanced-usage.md",
          "type": "file",
          "path": "references/advanced-usage.md",
          "lines": 241
        },
        {
          "name": "go-rust-patterns.md",
          "type": "file",
          "path": "references/go-rust-patterns.md",
          "lines": 192
        },
        {
          "name": "js-ts-patterns.md",
          "type": "file",
          "path": "references/js-ts-patterns.md",
          "lines": 138
        },
        {
          "name": "python-patterns.md",
          "type": "file",
          "path": "references/python-patterns.md",
          "lines": 132
        },
        {
          "name": "security-patterns.md",
          "type": "file",
          "path": "references/security-patterns.md",
          "lines": 164
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 99
    }
  ]
}
