{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-17T05:25:46.101Z",
    "slug": "flashinfer-ai-debug-cuda-crash",
    "source_url": "https://github.com/flashinfer-ai/flashinfer/tree/main/.claude/skills/debug-cuda-crash",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "f091a152d7a3761ff0b6c6d04b44cbedcc7939b9ea59e59e628ead87e552a466",
    "tree_hash": "8314e663b0a6118e7001bdfc6629bf38dde0778c532d453d66e699a1a41c40ff"
  },
  "skill": {
    "name": "debug-cuda-crash",
    "description": "Tutorial for debugging CUDA crashes using API logging",
    "summary": "Tutorial for debugging CUDA crashes using API logging",
    "icon": "ðŸ”§",
    "version": "1.0.0",
    "author": "flashinfer-ai",
    "license": "Apache-2.0",
    "category": "documentation",
    "tags": [
      "cuda",
      "debugging",
      "flashinfer",
      "tutorial",
      "gpu"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "All 160 static findings are FALSE POSITIVES. This skill contains ONLY markdown documentation with zero executable code. The 'backtick execution' findings flag markdown code block formatting, not shell commands. 'Weak cryptographic algorithm' findings flag hash identifiers in metadata. 'System reconnaissance' findings flag environment variable documentation. Pure educational content for CUDA debugging.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 1,
            "line_end": 575
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 754,
    "audit_model": "claude",
    "audited_at": "2026-01-17T05:25:46.101Z"
  },
  "content": {
    "user_title": "Debug CUDA Crashes in FlashInfer",
    "value_statement": "CUDA crashes often leave no debugging information. This tutorial teaches you to use FlashInfer's API logging to capture tensor metadata before crashes. Learn to identify shape mismatches, dtype errors, and numerical issues quickly.",
    "seo_keywords": [
      "debug cuda crash",
      "flashinfer debugging",
      "cuda illegal memory access",
      "api logging",
      "cuda debugging tutorial",
      "gpu kernel debugging",
      "compute-sanitizer",
      "cuda-gdb",
      "claude code",
      "codex"
    ],
    "actual_capabilities": [
      "Debug CUDA crashes by capturing input tensors before failure",
      "Detect NaN and Inf values using tensor statistics logging",
      "Identify shape and dtype mismatches in kernel inputs",
      "Use compute-sanitizer for memory access validation",
      "Debug multi-GPU processes with separate log files",
      "Apply cuda-gdb for kernel-level debugging"
    ],
    "limitations": [
      "Requires FlashInfer library installed with @flashinfer_api decorator support",
      "Logging must be enabled before running the code that crashes",
      "Statistics logging (level 5) is skipped during CUDA graph capture",
      "Does not fix crashes automatically, only aids diagnosis"
    ],
    "use_cases": [
      {
        "target_user": "ML Engineers",
        "title": "Debug production ML crashes",
        "description": "Diagnose CUDA errors in production LLM serving workloads using API logging to capture failing inputs"
      },
      {
        "target_user": "GPU Kernel Developers",
        "title": "Debug kernel memory errors",
        "description": "Use compute-sanitizer combined with API logging to find illegal memory access and out-of-bounds errors"
      },
      {
        "target_user": "Research Scientists",
        "title": "Fix numerical instability",
        "description": "Detect NaN/Inf values in attention computations by examining tensor statistics from logged outputs"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic crash debugging",
        "scenario": "FlashInfer kernel crashed",
        "prompt": "My FlashInfer code crashed with 'illegal memory access'. Help me set up API logging to debug this."
      },
      {
        "title": "Numerical issues",
        "scenario": "NaN values in output",
        "prompt": "My attention kernel is producing NaN values. How do I use level 5 logging to find the source?"
      },
      {
        "title": "Multi-GPU debugging",
        "scenario": "Distributed training crash",
        "prompt": "My multi-GPU training job crashed. Show me how to log each rank separately for debugging."
      },
      {
        "title": "Memory errors",
        "scenario": "Using compute-sanitizer",
        "prompt": "Combine FlashInfer API logging with compute-sanitizer to debug memory access errors. Give me the exact command."
      }
    ],
    "output_examples": [
      {
        "input": "My batch_decode_with_padded_kv_cache crashed with 'illegal memory access'",
        "output": [
          "Set environment variables: export FLASHINFER_LOGLEVEL=3, export FLASHINFER_LOGDEST=debug.log",
          "Run your code again - inputs will be logged BEFORE the crash",
          "Check the log for tensor shapes and dtypes",
          "Common issues: shape mismatch, wrong dtype, CPU tensor passed to GPU",
          "For deeper analysis: compute-sanitizer --tool memcheck python your_script.py"
        ]
      },
      {
        "input": "My attention output has NaN values",
        "output": [
          "Use level 5 logging: export FLASHINFER_LOGLEVEL=5",
          "Check nan_count and inf_count in the log file",
          "Look for large min/max values indicating numerical instability",
          "Check preceding operations for division by zero or overflow"
        ]
      },
      {
        "input": "My distributed training crashed on multiple GPUs",
        "output": [
          "Use process-specific logs: export FLASHINFER_LOGDEST=rank_%i.log",
          "Each GPU process creates its own log file",
          "Check individual rank logs to identify which process crashed first",
          "Compare inputs across ranks to find inconsistencies"
        ]
      }
    ],
    "best_practices": [
      "Always start with level 3 logging for tensor metadata without overwhelming output",
      "Log to a file instead of stdout to preserve logs after crashes",
      "Compare the last successful API call (inputs and outputs logged) with the first failed call (only inputs logged)"
    ],
    "anti_patterns": [
      "Using level 5 logging by default (adds statistics overhead for every call)",
      "Logging to stdout when program crashes (output may be lost)",
      "Forgetting to disable logging in production (adds overhead even at level 1)"
    ],
    "faq": [
      {
        "question": "What CUDA versions support API logging?",
        "answer": "API logging works with any CUDA version supported by FlashInfer (CUDA 11.8+). The logging is implemented in Python."
      },
      {
        "question": "Does logging slow down my code?",
        "answer": "Level 0 (disabled) has zero overhead. Level 1-3 add minimal overhead for metadata extraction."
      },
      {
        "question": "Can I use this with PyTorch torch.compile()?",
        "answer": "Yes. API logging works with compiled PyTorch code. Statistics (level 5) are skipped during graph capture."
      },
      {
        "question": "Is my data safe in the log files?",
        "answer": "Log files contain tensor shapes, dtypes, and statistics. They do NOT contain actual tensor values."
      },
      {
        "question": "What if no logs appear even with FLASHINFER_LOGLEVEL=3?",
        "answer": "Verify the environment variable is set. Check that the API has the @flashinfer_api decorator."
      },
      {
        "question": "How is this different from CUDA's built-in tools?",
        "answer": "API logging shows WHAT data caused the crash. Tools like compute-sanitizer show WHERE it occurred. Use both together."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 575
    }
  ]
}
