{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-17T06:51:56.508Z",
    "slug": "k-dense-ai-anndata",
    "source_url": "https://github.com/K-Dense-AI/claude-scientific-skills/tree/main/scientific-skills/anndata",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "79db29b2d45fa0a2e130bb8ecd41adf935ee0789a8ad215fc515765a20c4cb78",
    "tree_hash": "9f28baa4debfb40a79f97a027915ba0e5360b5d437eac02be2555e16d2d3e6cd"
  },
  "skill": {
    "name": "anndata",
    "description": "Data structure for annotated matrices in single-cell analysis. Use when working with .h5ad files or integrating with the scverse ecosystem. This is the data format skillâ€”for analysis workflows use scanpy; for probabilistic models use scvi-tools; for population-scale queries use cellxgene-census.",
    "summary": "Data structure for annotated matrices in single-cell analysis. Use when working with .h5ad files or ...",
    "icon": "ðŸ”¬",
    "version": "1.0.0",
    "author": "K-Dense-AI",
    "license": "BSD-3-Clause license",
    "category": "data",
    "tags": [
      "python",
      "genomics",
      "single-cell",
      "data-format",
      "scverse"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "All 397 static findings are FALSE POSITIVES. This skill contains only markdown documentation with Python code examples. The static scanner incorrectly flags backticks in fenced code blocks, URLs in documentation links, and generic programming terms. No executable code, network operations, or credential handling exists. This is a legitimate scientific computing documentation skill for the AnnData Python library.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "references/best_practices.md",
            "line_start": 1,
            "line_end": 526
          },
          {
            "file": "SKILL.md",
            "line_start": 1,
            "line_end": 399
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 394,
            "line_end": 397
          },
          {
            "file": "references/io_operations.md",
            "line_start": 283,
            "line_end": 295
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 7,
    "total_lines": 4567,
    "audit_model": "claude",
    "audited_at": "2026-01-17T06:51:56.507Z"
  },
  "content": {
    "user_title": "Work with AnnData matrices",
    "value_statement": "AnnData provides a standardized data structure for annotated matrices used in single-cell genomics. This skill enables creating, reading, writing, and manipulating .h5ad files with full support for metadata, embeddings, and the scverse ecosystem.",
    "seo_keywords": [
      "AnnData",
      "single-cell",
      "h5ad",
      "Python",
      "scverse",
      "genomics",
      "data structure",
      "annotated matrices",
      "Claude",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Create and manipulate AnnData objects with X matrix, obs, var, layers, obsm, varm, obsp, varp, and uns",
      "Read and write data in H5AD, Zarr, CSV, MTX, Loom, 10X Genomics, and Excel formats",
      "Concatenate multiple AnnData objects along observations or variables with flexible join strategies",
      "Use backed mode for memory-efficient processing of large datasets that exceed RAM",
      "Subset, filter, transform, and annotate data with support for sparse matrices and categoricals",
      "Integrate with Scanpy, scvi-tools, Muon, and PyTorch for comprehensive analysis workflows"
    ],
    "limitations": [
      "This is a data structure skill only. For analysis workflows use scanpy skill. For probabilistic models use scvi-tools skill.",
      "Does not provide visualization capabilities. Use scanpy for plotting functions.",
      "Does not include scvi-tools probabilistic model training. Use scvi-tools skill for that.",
      "For cellxgene-census population queries, use the cellxgene-census skill directly."
    ],
    "use_cases": [
      {
        "target_user": "Bioinformatics researchers",
        "title": "Single-cell RNA-seq analysis",
        "description": "Load and process 10X Genomics data for single-cell transcriptomics research with proper metadata tracking."
      },
      {
        "target_user": "Data engineers",
        "title": "Multi-batch data integration",
        "description": "Combine multiple experimental batches with automatic batch label tracking and conflict resolution."
      },
      {
        "target_user": "ML engineers",
        "title": "Deep learning integration",
        "description": "Export data to PyTorch DataLoaders for training neural networks on single-cell expression data."
      }
    ],
    "prompt_templates": [
      {
        "title": "Create AnnData object",
        "scenario": "Initialize data structure",
        "prompt": "Create an AnnData object from a numpy array with observation metadata for cell types and sample IDs."
      },
      {
        "title": "Read H5AD file",
        "scenario": "Load existing data",
        "prompt": "Read an H5AD file in backed mode and filter for high-quality cells based on a quality_score column."
      },
      {
        "title": "Concatenate batches",
        "scenario": "Combine datasets",
        "prompt": "Concatenate three AnnData objects along the observation axis with batch labels and inner join."
      },
      {
        "title": "Optimize memory",
        "scenario": "Large dataset handling",
        "prompt": "Show how to convert string columns to categorical and use sparse matrices for memory efficiency."
      }
    ],
    "output_examples": [
      {
        "input": "How do I read a 10X Genomics H5 file and convert it to AnnData?",
        "output": [
          "Use ad.read_10x_h5() to read the H5 format directly",
          "The function handles gene and barcode extraction automatically",
          "Optional genome parameter for selecting specific reference when multiple are present"
        ]
      },
      {
        "input": "What is backed mode and when should I use it?",
        "output": [
          "Backed mode keeps data on disk and loads only accessed portions",
          "Use it for datasets larger than available RAM to avoid out-of-memory errors",
          "Access metadata and create subsets without loading entire file into memory"
        ]
      }
    ],
    "best_practices": [
      "Use backed mode (backed='r') for datasets larger than available RAM to avoid out-of-memory errors.",
      "Convert string columns to categorical with strings_to_categoricals() for 10-50x memory reduction.",
      "Store raw data with adata.raw = adata.copy() before filtering to preserve access to unfiltered genes."
    ],
    "anti_patterns": [
      "Avoid modifying views directly without copying first, as changes may affect the original object.",
      "Do not load entire large datasets into memory when backed mode can provide lazy access.",
      "Avoid index misalignment when adding external metadata by using set_index() and loc[].join()."
    ],
    "faq": [
      {
        "question": "What is the difference between backed mode and in-memory mode?",
        "answer": "Backed mode keeps data on disk and loads only accessed portions, enabling work with datasets larger than RAM."
      },
      {
        "question": "How do I combine multiple AnnData objects for different modalities like RNA and protein?",
        "answer": "Use Muon (MuData) to combine multiple AnnData objects for different modalities like RNA and protein."
      },
      {
        "question": "When should I use sparse matrices?",
        "answer": "Use sparse matrices when data has more than 50% zeros, common in single-cell count data."
      },
      {
        "question": "How do I track which batch each cell came from?",
        "answer": "Use the label and keys parameters in ad.concat() to add a batch column automatically."
      },
      {
        "question": "What is the raw attribute for?",
        "answer": "raw stores a snapshot of data before filtering, allowing access to original unfiltered genes later."
      },
      {
        "question": "How do I handle out of memory errors?",
        "answer": "Use backed mode, convert to sparse matrices, convert strings to categoricals, or process in chunks."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "best_practices.md",
          "type": "file",
          "path": "references/best_practices.md",
          "lines": 526
        },
        {
          "name": "concatenation.md",
          "type": "file",
          "path": "references/concatenation.md",
          "lines": 397
        },
        {
          "name": "data_structure.md",
          "type": "file",
          "path": "references/data_structure.md",
          "lines": 315
        },
        {
          "name": "io_operations.md",
          "type": "file",
          "path": "references/io_operations.md",
          "lines": 405
        },
        {
          "name": "manipulation.md",
          "type": "file",
          "path": "references/manipulation.md",
          "lines": 517
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 400
    }
  ]
}
