{
  "skill": {
    "name": "fda-database",
    "description": "Query openFDA API for drugs, devices, adverse events, recalls, regulatory submissions (510k, PMA), substance identification (UNII), for FDA regulatory data analysis and safety research.",
    "summary": "Access comprehensive FDA regulatory data through openFDA API for drugs, medical devices, foods, and substances.",
    "icon": "ðŸ’Š",
    "version": "1.0.0",
    "author": "K-Dense Inc.",
    "license": "Unknown",
    "category": "data",
    "tags": ["fda", "drugs", "medical-devices", "api"],
    "supported_tools": ["claude", "codex", "claude-code"]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a legitimate FDA data access library querying the public openFDA API (api.fda.gov). Static findings are false positives: markdown code block delimiters flagged as shell commands, legitimate API calls to US government endpoint, and standard environment variable access for API authentication. No malicious intent detected.",
    "static_findings_evaluation": [
      {
        "finding": "[MEDIUM] external_commands: Ruby/shell backtick execution",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Scanner incorrectly detected markdown code block delimiters (backticks) as shell commands. These are documentation examples in markdown files, not executable code. No actual backtick execution exists in the codebase."
      },
      {
        "finding": "[LOW] network: Python HTTP libraries / Hardcoded URL",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "HTTP requests target only api.fda.gov, a legitimate US government public API. This is the intended functionality of the skill. No suspicious external endpoints are accessed."
      },
      {
        "finding": "[HIGH] env_access: Generic API/secret keys",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Environment variable access reads FDA_API_KEY from os.environ for API authentication. This is standard practice for API clients. The key is used only for authenticating requests to the official FDA API, not exfiltrated."
      },
      {
        "finding": "[MEDIUM] filesystem: Python file write/append",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "File writes only occur in the FDACache class for caching API responses locally. This is a legitimate performance optimization, not suspicious file operations."
      },
      {
        "finding": "[HIGH] blocker: Weak cryptographic algorithm (MD5)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "MD5 is used only for generating cache keys, not for security or cryptographic purposes. This is safe and appropriate for non-security caching use cases."
      },
      {
        "finding": "[CRITICAL] obfuscation: DANGEROUS COMBINATION: Code execution + Network + Credential access",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "This heuristic triggered on the combination of API key access, network calls, and caching. However, there is NO code execution in this skill. All three capabilities are legitimate and necessary for a data access library: reading API credentials, making requests to the FDA API, and caching responses for performance."
      }
    ],
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {"file": "scripts/fda_query.py", "line_start": 87, "line_end": 87},
          {"file": "scripts/fda_query.py", "line_start": 135, "line_end": 135}
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {"file": "scripts/fda_query.py", "line_start": 408, "line_end": 408},
          {"file": "scripts/fda_query.py", "line_start": 11, "line_end": 11}
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {"file": "scripts/fda_query.py", "line_start": 80, "line_end": 80}
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 9,
    "total_lines": 4311
  },
  "content": {
    "user_title": "Query FDA drug and device databases",
    "value_statement": "Access comprehensive FDA regulatory data through openFDA API. Query drug adverse events, device recalls, food safety alerts, and substance information for regulatory compliance and safety research.",
    "seo_keywords": [
      "FDA database query",
      "openFDA API",
      "drug adverse events",
      "medical device recalls",
      "drug safety research",
      "FDA regulatory data",
      "Clude Code",
      "Claude",
      "Codex"
    ],
    "actual_capabilities": [
      "Query drug adverse events, labeling, and recalls via openFDA API",
      "Search medical device 510(k) clearances and adverse event reports",
      "Access food recall and adverse event data for safety monitoring",
      "Look up substance identifiers (UNII, CAS numbers) and chemical structures",
      "Query animal and veterinary drug adverse events by species",
      "Analyze regulatory submissions and enforcement actions"
    ],
    "limitations": [
      "API rate limits apply without authentication (240 req/min, 1,000/day)",
      "Only queries public FDA datasets, not proprietary databases",
      "Historical data availability varies by endpoint and data category"
    ],
    "use_cases": [
      {
        "target_user": "Pharmacovigilance researchers",
        "title": "Drug safety monitoring",
        "description": "Track adverse event reports and safety signals for medications over time"
      },
      {
        "target_user": "Medical device specialists",
        "title": "Device surveillance",
        "description": "Monitor recalls, adverse events, and 510(k) clearance status for devices"
      },
      {
        "target_user": "Regulatory compliance teams",
        "title": "Enforcement tracking",
        "description": "Stay informed about FDA enforcement actions and compliance requirements"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic drug query",
        "scenario": "Find adverse events",
        "prompt": "Query the FDA database for adverse events related to [drug_name]. Show the total count and most common reactions."
      },
      {
        "title": "Device recall search",
        "scenario": "Check device status",
        "prompt": "Search for [device_name] in the FDA device recall database. List any enforcement actions in the past year."
      },
      {
        "title": "Comparative analysis",
        "scenario": "Compare products",
        "prompt": "Compare the safety profiles of [drug_a] and [drug_b]. Show adverse event counts, serious events, and recent recalls for each."
      },
      {
        "title": "Regulatory research",
        "scenario": "Deep research",
        "prompt": "Generate a comprehensive report on [device_name] including: adverse events, 510(k) history, PMA status, recalls, and UDI information."
      }
    ],
    "output_examples": [
      {
        "input": "Query adverse events for aspirin",
        "output": [
          "Total Adverse Event Reports: 152,342",
          "Most Common Reactions: nausea (12,847), stomach pain (9,234), bleeding (7,891)",
          "Serious Events: 23,456 (15.4%)",
          "Recent Recalls: 2 found - contamination concern (Class II), labeling issue (Class III)"
        ]
      }
    ],
    "best_practices": [
      "Register for a free FDA API key to increase rate limits from 1,000 to 120,000 requests per day",
      "Use specific search terms and exact matching for accurate count results",
      "Implement caching for frequently accessed data to reduce API calls and improve performance"
    ],
    "anti_patterns": [
      "Using overly broad wildcard searches that return millions of unrelated results",
      "Ignoring rate limits without an API key, causing request failures",
      "Failing to validate input data before constructing search queries"
    ],
    "faq": [
      {
        "question": "Is an API key required?",
        "answer": "No, but registering for a free key increases daily limits from 1,000 to 120,000 requests."
      },
      {
        "question": "What data categories are available?",
        "answer": "Drugs, devices, foods, animal/veterinary products, and chemical substances (UNII, CAS)."
      },
      {
        "question": "How current is the data?",
        "answer": "Data is updated regularly with some endpoints reflecting real-time or near-real-time submissions."
      },
      {
        "question": "Can I export results?",
        "answer": "Yes, all query results are returned as JSON data that can be saved, processed, or analyzed."
      },
      {
        "question": "What are the rate limits?",
        "answer": "240 requests per minute with or without a key; daily limit is 1,000 without key, 120,000 with key."
      },
      {
        "question": "How do I search for specific fields?",
        "answer": "Use the search parameter with field names like 'patient.drug.medicinalproduct:drugname'."
      }
    ]
  }
}
