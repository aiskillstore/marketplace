{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T23:07:00.669Z",
    "slug": "consiliency-supabase-patterns",
    "source_url": "https://github.com/Consiliency/treesitter-chunker/tree/main/.ai-dev-kit/skills/supabase-patterns",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "0332a76c9b1b3dffec3a676207bfbfad6317ad8d580bff902c14d67b0e5f79d6",
    "tree_hash": "654e2e1cd5dced6e18510f3f3c889f5be588a98a0a813d4319104936f0b7bb59"
  },
  "skill": {
    "name": "supabase-patterns",
    "description": "Generic Supabase best practices for Row Level Security, realtime subscriptions, storage, and edge functions. Framework-agnostic.",
    "summary": "Generic Supabase best practices for Row Level Security, realtime subscriptions, storage, and edge fu...",
    "icon": "ðŸ”",
    "version": "1.0.0",
    "author": "Consiliency",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "supabase",
      "postgresql",
      "rls",
      "security",
      "database"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "network",
      "filesystem",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill is pure documentation containing SQL patterns and TypeScript examples for Supabase development. All 98 static findings are false positives caused by pattern matching against markdown code blocks and SQL keywords. The skill teaches security best practices for Row Level Security.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 9,
            "line_end": 15
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 15,
            "line_end": 19
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 19,
            "line_end": 35
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 35,
            "line_end": 39
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 39,
            "line_end": 44
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 44,
            "line_end": 48
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 48,
            "line_end": 63
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 63,
            "line_end": 69
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 69,
            "line_end": 85
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 85,
            "line_end": 89
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 89,
            "line_end": 111
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 111,
            "line_end": 115
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 115,
            "line_end": 132
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 132,
            "line_end": 136
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 136,
            "line_end": 144
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 144,
            "line_end": 150
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 150,
            "line_end": 167
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 167,
            "line_end": 171
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 171,
            "line_end": 186
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 186,
            "line_end": 192
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 192,
            "line_end": 203
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 203,
            "line_end": 207
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 207,
            "line_end": 215
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 215,
            "line_end": 221
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 221,
            "line_end": 231
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 231,
            "line_end": 235
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 235,
            "line_end": 252
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 252,
            "line_end": 256
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 256,
            "line_end": 261
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 261,
            "line_end": 265
          },
          {
            "file": "cookbook/rls-policies.md",
            "line_start": 265,
            "line_end": 294
          },
          {
            "file": "SKILL.md",
            "line_start": 48,
            "line_end": 48
          },
          {
            "file": "SKILL.md",
            "line_start": 52,
            "line_end": 52
          },
          {
            "file": "SKILL.md",
            "line_start": 56,
            "line_end": 56
          },
          {
            "file": "SKILL.md",
            "line_start": 62,
            "line_end": 72
          },
          {
            "file": "SKILL.md",
            "line_start": 72,
            "line_end": 76
          },
          {
            "file": "SKILL.md",
            "line_start": 76,
            "line_end": 91
          },
          {
            "file": "SKILL.md",
            "line_start": 91,
            "line_end": 95
          },
          {
            "file": "SKILL.md",
            "line_start": 95,
            "line_end": 113
          },
          {
            "file": "SKILL.md",
            "line_start": 113,
            "line_end": 117
          },
          {
            "file": "SKILL.md",
            "line_start": 117,
            "line_end": 139
          },
          {
            "file": "SKILL.md",
            "line_start": 139,
            "line_end": 143
          },
          {
            "file": "SKILL.md",
            "line_start": 143,
            "line_end": 158
          },
          {
            "file": "SKILL.md",
            "line_start": 158,
            "line_end": 162
          },
          {
            "file": "SKILL.md",
            "line_start": 162,
            "line_end": 166
          },
          {
            "file": "SKILL.md",
            "line_start": 166,
            "line_end": 174
          },
          {
            "file": "SKILL.md",
            "line_start": 174,
            "line_end": 175
          },
          {
            "file": "SKILL.md",
            "line_start": 175,
            "line_end": 203
          },
          {
            "file": "SKILL.md",
            "line_start": 203,
            "line_end": 211
          },
          {
            "file": "SKILL.md",
            "line_start": 211,
            "line_end": 215
          },
          {
            "file": "SKILL.md",
            "line_start": 215,
            "line_end": 222
          },
          {
            "file": "SKILL.md",
            "line_start": 222,
            "line_end": 226
          },
          {
            "file": "SKILL.md",
            "line_start": 226,
            "line_end": 233
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 123,
            "line_end": 123
          },
          {
            "file": "SKILL.md",
            "line_start": 124,
            "line_end": 124
          },
          {
            "file": "SKILL.md",
            "line_start": 123,
            "line_end": 123
          },
          {
            "file": "SKILL.md",
            "line_start": 124,
            "line_end": 124
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 729,
    "audit_model": "claude",
    "audited_at": "2026-01-16T23:07:00.669Z"
  },
  "content": {
    "user_title": "Implement Secure Supabase Row Level Security Patterns",
    "value_statement": "Supabase projects often have security vulnerabilities from missing or incorrect RLS policies. This skill provides proven patterns for user ownership, team access, role-based security, and proper policy testing.",
    "seo_keywords": [
      "supabase",
      "row level security",
      "rls policies",
      "postgresql security",
      "supabase patterns",
      "claude",
      "codex",
      "claude-code",
      "database security",
      "realtime subscriptions"
    ],
    "actual_capabilities": [
      "Generates RLS policies for user ownership, team access, and role-based control",
      "Provides migration patterns for adding RLS to existing tables",
      "Includes testing patterns for verifying policies with different user contexts",
      "Covers realtime subscription security and storage bucket policies",
      "Shows TypeScript client patterns with proper type generation",
      "Documents common RLS mistakes and how to avoid them"
    ],
    "limitations": [
      "Does not generate complete application code, only Supabase patterns",
      "Requires existing Supabase project setup",
      "Framework-agnostic patterns may need adaptation for specific frameworks",
      "Does not cover Supabase Auth configuration or third-party integrations"
    ],
    "use_cases": [
      {
        "target_user": "Backend Developer",
        "title": "Add RLS to New Tables",
        "description": "Create secure RLS policies when adding new database tables. Includes patterns for SELECT, INSERT, UPDATE, and DELETE operations."
      },
      {
        "target_user": "Team Lead",
        "title": "Implement Team-Based Access Control",
        "description": "Set up organization and team-level access patterns. Users see only their team's data with proper admin escalation."
      },
      {
        "target_user": "Security Engineer",
        "title": "Audit Existing RLS Policies",
        "description": "Review and test existing policies against common vulnerability patterns. Identify overly permissive or missing policies."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic User Ownership RLS",
        "scenario": "New table needs user-based access control",
        "prompt": "Create RLS policies for my 'documents' table where users can only access their own documents. Include SELECT, INSERT, UPDATE, and DELETE policies."
      },
      {
        "title": "Team Access Pattern",
        "scenario": "Multi-tenant app with team workspaces",
        "prompt": "Set up RLS for a 'projects' table where team members can view all team projects, but only team admins can update or delete them."
      },
      {
        "title": "Public and Private Content",
        "scenario": "Content with visibility settings",
        "prompt": "Create RLS for a 'posts' table with is_public boolean. Public posts visible to all, private posts only to owner."
      },
      {
        "title": "Complete Security Audit",
        "scenario": "Reviewing existing Supabase project",
        "prompt": "Review my Supabase migrations folder and identify tables missing RLS policies. Generate policies for any unprotected tables."
      }
    ],
    "output_examples": [
      {
        "input": "Create RLS policies for my comments table where users can only edit their own comments",
        "output": [
          "Enables Row Level Security on the comments table",
          "Creates SELECT policy allowing users to view all comments",
          "Creates INSERT policy ensuring user_id matches authenticated user",
          "Creates UPDATE policy restricting edits to comment owner",
          "Creates DELETE policy allowing only owners to remove comments"
        ]
      },
      {
        "input": "Set up team-based access for a shared documents table",
        "output": [
          "Creates helper function to get user's team memberships",
          "Creates SELECT policy for team members to view team documents",
          "Creates INSERT policy checking team membership before insert",
          "Creates UPDATE policy allowing only team admins to modify",
          "Adds migration file with idempotent policy creation"
        ]
      }
    ],
    "best_practices": [
      "Always enable RLS immediately after creating a new table before adding any data",
      "Use WITH CHECK for INSERT and UPDATE policies to validate new data, not just USING",
      "Create helper functions with SECURITY DEFINER for complex permission checks"
    ],
    "anti_patterns": [
      "Never use service role key in client-side code as it bypasses all RLS policies",
      "Avoid policies that only check auth.uid() IS NOT NULL without specific permission verification",
      "Do not modify schema directly in production. Always use migrations for RLS changes"
    ],
    "faq": [
      {
        "question": "Why are my RLS policies not working?",
        "answer": "Check that RLS is enabled with ALTER TABLE ENABLE ROW LEVEL SECURITY. Verify policy names and that USING vs WITH CHECK are correct for your operation type."
      },
      {
        "question": "How do I test RLS policies locally?",
        "answer": "Use SET request.jwt.claims to simulate different users. Query the table and verify only expected rows return. Reset claims after testing."
      },
      {
        "question": "Should I use SECURITY DEFINER functions?",
        "answer": "Yes for complex permission checks that query other tables. This avoids recursive RLS checks. Always validate auth.uid() inside the function."
      },
      {
        "question": "How do I handle admin access?",
        "answer": "Create a separate admin policy checking role from profiles table or JWT claims. Use auth.jwt() ->> 'role' = 'admin' for JWT-based roles."
      },
      {
        "question": "What is the difference between USING and WITH CHECK?",
        "answer": "USING filters which rows can be accessed. WITH CHECK validates new or modified rows. INSERT only uses WITH CHECK. UPDATE needs both."
      },
      {
        "question": "Can RLS be bypassed?",
        "answer": "Service role key bypasses RLS. Table owners bypass unless FORCE ROW LEVEL SECURITY is set. Always use anon key for client applications."
      }
    ]
  },
  "file_structure": [
    {
      "name": "cookbook",
      "type": "dir",
      "path": "cookbook",
      "children": [
        {
          "name": "rls-policies.md",
          "type": "file",
          "path": "cookbook/rls-policies.md",
          "lines": 295
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 243
    }
  ]
}
