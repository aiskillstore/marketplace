{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-17T07:22:17.140Z",
    "slug": "wshobson-auth-implementation-patterns",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/developer-essentials/skills/auth-implementation-patterns",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "8ded658b24a92f2b4308e3eff6f363b940e6137bc867b5cb9496f9463f8d55ce",
    "tree_hash": "fff9aab8ac67eef52ab110004e059c754f845a89a1edb197f6e57d5171cf4fd9"
  },
  "skill": {
    "name": "auth-implementation-patterns",
    "description": "Master authentication and authorization patterns including JWT, OAuth2, session management, and RBAC to build secure, scalable access control systems. Use when implementing auth systems, securing APIs, or debugging security issues.",
    "summary": "Master authentication and authorization patterns including JWT, OAuth2, session management, and RBAC...",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "wshobson",
    "license": "MIT",
    "category": "security",
    "tags": [
      "authentication",
      "authorization",
      "jwt",
      "oauth2",
      "rbac"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation skill containing authentication code examples. All code is illustrative TypeScript demonstrating secure patterns (bcrypt with 12 rounds, JWT, proper cookie flags). No executable code, shell commands, network calls, or file system access beyond reading its own files. Static findings are false positives triggered by markdown code block backticks, environment variable references in examples, and security library mentions. The previous audit correctly identified this as safe.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 57,
            "line_end": 123
          },
          {
            "file": "SKILL.md",
            "line_start": 123,
            "line_end": 127
          },
          {
            "file": "SKILL.md",
            "line_start": 127,
            "line_end": 218
          },
          {
            "file": "SKILL.md",
            "line_start": 218,
            "line_end": 224
          },
          {
            "file": "SKILL.md",
            "line_start": 224,
            "line_end": 290
          },
          {
            "file": "SKILL.md",
            "line_start": 290,
            "line_end": 296
          },
          {
            "file": "SKILL.md",
            "line_start": 296,
            "line_end": 345
          },
          {
            "file": "SKILL.md",
            "line_start": 345,
            "line_end": 348
          },
          {
            "file": "SKILL.md",
            "line_start": 348,
            "line_end": 354
          },
          {
            "file": "SKILL.md",
            "line_start": 354,
            "line_end": 396
          },
          {
            "file": "SKILL.md",
            "line_start": 396,
            "line_end": 400
          },
          {
            "file": "SKILL.md",
            "line_start": 400,
            "line_end": 450
          },
          {
            "file": "SKILL.md",
            "line_start": 450,
            "line_end": 454
          },
          {
            "file": "SKILL.md",
            "line_start": 454,
            "line_end": 502
          },
          {
            "file": "SKILL.md",
            "line_start": 502,
            "line_end": 508
          },
          {
            "file": "SKILL.md",
            "line_start": 508,
            "line_end": 571
          },
          {
            "file": "SKILL.md",
            "line_start": 571,
            "line_end": 575
          },
          {
            "file": "SKILL.md",
            "line_start": 575,
            "line_end": 602
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 74,
            "line_end": 74
          },
          {
            "file": "SKILL.md",
            "line_start": 80,
            "line_end": 80
          },
          {
            "file": "SKILL.md",
            "line_start": 90,
            "line_end": 90
          },
          {
            "file": "SKILL.md",
            "line_start": 153,
            "line_end": 153
          },
          {
            "file": "SKILL.md",
            "line_start": 181,
            "line_end": 181
          },
          {
            "file": "SKILL.md",
            "line_start": 231,
            "line_end": 231
          },
          {
            "file": "SKILL.md",
            "line_start": 238,
            "line_end": 238
          },
          {
            "file": "SKILL.md",
            "line_start": 242,
            "line_end": 242
          },
          {
            "file": "SKILL.md",
            "line_start": 305,
            "line_end": 305
          },
          {
            "file": "SKILL.md",
            "line_start": 306,
            "line_end": 306
          },
          {
            "file": "SKILL.md",
            "line_start": 345,
            "line_end": 345
          },
          {
            "file": "SKILL.md",
            "line_start": 74,
            "line_end": 74
          },
          {
            "file": "SKILL.md",
            "line_start": 80,
            "line_end": 80
          },
          {
            "file": "SKILL.md",
            "line_start": 90,
            "line_end": 90
          },
          {
            "file": "SKILL.md",
            "line_start": 153,
            "line_end": 153
          },
          {
            "file": "SKILL.md",
            "line_start": 181,
            "line_end": 181
          },
          {
            "file": "SKILL.md",
            "line_start": 231,
            "line_end": 231
          },
          {
            "file": "SKILL.md",
            "line_start": 238,
            "line_end": 238
          },
          {
            "file": "SKILL.md",
            "line_start": 242,
            "line_end": 242
          },
          {
            "file": "SKILL.md",
            "line_start": 305,
            "line_end": 305
          },
          {
            "file": "SKILL.md",
            "line_start": 306,
            "line_end": 306
          },
          {
            "file": "SKILL.md",
            "line_start": 345,
            "line_end": 345
          },
          {
            "file": "SKILL.md",
            "line_start": 231,
            "line_end": 231
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 810,
    "audit_model": "claude",
    "audited_at": "2026-01-17T07:22:17.140Z"
  },
  "content": {
    "user_title": "Implement secure authentication patterns",
    "value_statement": "You need clear guidance for secure authentication and authorization choices. This skill provides proven patterns and examples you can adapt quickly for JWT, OAuth2, and session management.",
    "seo_keywords": [
      "authentication patterns",
      "authorization patterns",
      "JWT",
      "OAuth2",
      "RBAC",
      "session management",
      "Claude",
      "Codex",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Explain JWT access and refresh token flows with validation steps",
      "Show session-based authentication with Redis-backed storage",
      "Outline OAuth2 social login setup with Passport strategies",
      "Define RBAC and permission-based authorization middleware",
      "Provide password hashing and rate limiting examples"
    ],
    "limitations": [
      "No runnable project or full application scaffolding included",
      "Does not provide database schemas or migration scripts",
      "Does not implement MFA or device trust flows"
    ],
    "use_cases": [
      {
        "target_user": "Backend developer",
        "title": "Secure an API",
        "description": "Choose and implement JWT or session auth with proper middleware and token handling."
      },
      {
        "target_user": "Startup engineer",
        "title": "Add social login",
        "description": "Integrate OAuth2 flows and redirect handling with clear examples."
      },
      {
        "target_user": "Security reviewer",
        "title": "Audit auth design",
        "description": "Check role and permission enforcement patterns against common pitfalls."
      }
    ],
    "prompt_templates": [
      {
        "title": "Pick an auth approach",
        "scenario": "New app needs login and API access",
        "prompt": "Recommend session or JWT auth for a small SaaS app. Include tradeoffs and a suggested default."
      },
      {
        "title": "Design refresh tokens",
        "scenario": "Existing JWT setup lacks refresh logic",
        "prompt": "Provide a safe refresh token flow and storage guidance for a Node API."
      },
      {
        "title": "Add RBAC",
        "scenario": "Admin and moderator roles needed",
        "prompt": "Draft RBAC middleware and role hierarchy for users, moderators, and admins."
      },
      {
        "title": "Harden login security",
        "scenario": "Login endpoint is targeted by bots",
        "prompt": "List concrete steps to secure login, including rate limiting and password policy."
      }
    ],
    "output_examples": [
      {
        "input": "Design a secure JWT auth flow with refresh tokens for a REST API.",
        "output": [
          "Use short-lived access tokens and long-lived refresh tokens stored hashed in the database",
          "Verify refresh tokens on each rotation and revoke on logout",
          "Attach user claims to the request after verification",
          "Return 401 on expired or invalid tokens with clear error messages"
        ]
      },
      {
        "input": "How do I add Google OAuth2 login to my Express app?",
        "output": [
          "Configure Passport Google Strategy with client ID and secret from environment variables",
          "Set up callback URL to handle the OAuth redirect and generate JWT tokens",
          "Store or find user by Google ID, creating new user if not found",
          "Redirect to frontend with access token attached"
        ]
      }
    ],
    "best_practices": [
      "Keep access tokens short-lived and rotate refresh tokens with secure storage",
      "Enforce strong password policies with bcrypt or argon2 hashing",
      "Apply rate limits on authentication endpoints to prevent brute force attacks"
    ],
    "anti_patterns": [
      "Storing JWTs in localStorage without XSS protections",
      "Skipping token expiration or refresh token rotation",
      "Authorizing requests only on the client side without server validation"
    ],
    "faq": [
      {
        "question": "Is this skill compatible with Node and Express apps?",
        "answer": "Yes, examples target Node and Express patterns, but concepts map to other stacks."
      },
      {
        "question": "What are the limits of the examples?",
        "answer": "They are illustrative snippets and not a complete application or framework."
      },
      {
        "question": "Can I integrate this with existing auth providers?",
        "answer": "Yes, the OAuth2 section shows provider-based flows you can adapt."
      },
      {
        "question": "Does this skill collect or store user data?",
        "answer": "No, it is documentation only and does not execute or transmit data."
      },
      {
        "question": "What should I check if tokens are rejected?",
        "answer": "Verify secrets match, token expiry, clock skew, and middleware parsing logic."
      },
      {
        "question": "How does this compare to a full auth library?",
        "answer": "It explains patterns and tradeoffs, while libraries provide ready-to-use implementations."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 635
    }
  ]
}
