{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-04T16:35:35.201Z",
    "slug": "wshobson-k8s-security-policies",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/kubernetes-operations/skills/k8s-security-policies",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "bf1e3e39aeb40bad5886b7f658ea441fef936d0a9b056adb01aa2ba595351eda",
    "tree_hash": "72ecbd83857e90b48243da9ce4c87ba3853c57ccffd5d7c6d377332a372bc962"
  },
  "skill": {
    "name": "k8s-security-policies",
    "description": "Implement Kubernetes security policies including NetworkPolicy, PodSecurityPolicy, and RBAC for production-grade security. Use when securing Kubernetes clusters, implementing network isolation, or enforcing pod security standards.",
    "summary": "Implement Kubernetes security policies including NetworkPolicy, PodSecurityPolicy, and RBAC for prod...",
    "icon": "üõ°Ô∏è",
    "version": "1.0.0",
    "author": "wshobson",
    "license": "MIT",
    "category": "security",
    "tags": [
      "kubernetes",
      "rbac",
      "networkpolicy",
      "pod-security",
      "gatekeeper"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure prompt-based knowledge skill containing only static markdown documentation and YAML templates. No executable code, network access, file system modifications, or data collection detected. Contains only Kubernetes security policy examples.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 6,
    "total_lines": 944,
    "audit_model": "claude",
    "audited_at": "2026-01-04T16:35:35.201Z"
  },
  "content": {
    "user_title": "Implement Kubernetes security policies",
    "value_statement": "Kubernetes security policies are complex and easy to misconfigure. This skill provides clear templates and guidance for NetworkPolicy, RBAC, and Pod Security Standards.",
    "seo_keywords": [
      "Kubernetes security",
      "NetworkPolicy",
      "RBAC",
      "Pod Security Standards",
      "OPA Gatekeeper",
      "Istio AuthorizationPolicy",
      "Claude",
      "Codex",
      "Claude Code",
      "cluster hardening"
    ],
    "actual_capabilities": [
      "Provide namespace label examples for Pod Security Standards",
      "Offer NetworkPolicy templates for default deny and DNS egress",
      "Show RBAC Role, ClusterRole, and RoleBinding examples",
      "Include Gatekeeper ConstraintTemplate and Constraint examples",
      "Document Istio mTLS and authorization policy examples"
    ],
    "limitations": [
      "Does not apply policies to a live cluster",
      "Does not validate policies against your CNI or admission tools",
      "Does not generate custom manifests beyond provided templates",
      "Does not audit existing RBAC or NetworkPolicy configurations"
    ],
    "use_cases": [
      {
        "target_user": "Platform engineer",
        "title": "Set namespace security labels",
        "description": "Use baseline and restricted label templates for production namespaces."
      },
      {
        "target_user": "DevOps engineer",
        "title": "Create network segmentation",
        "description": "Apply default deny and allow patterns for service to service traffic."
      },
      {
        "target_user": "Security analyst",
        "title": "Review RBAC scope",
        "description": "Use RBAC patterns to reduce permissions and document access."
      }
    ],
    "prompt_templates": [
      {
        "title": "Starter policies",
        "scenario": "New production namespace",
        "prompt": "Provide baseline Pod Security Standards labels and a default deny NetworkPolicy for a production namespace."
      },
      {
        "title": "Allow DNS egress",
        "scenario": "Pods need name resolution",
        "prompt": "Show a NetworkPolicy that allows UDP 53 to kube-system while keeping default deny."
      },
      {
        "title": "Least privilege RBAC",
        "scenario": "Service account access",
        "prompt": "Create a Role and RoleBinding that lets a service account read configmaps only."
      },
      {
        "title": "Gatekeeper enforcement",
        "scenario": "Require labels on Deployments",
        "prompt": "Provide a Gatekeeper constraint template and constraint to require app and environment labels."
      }
    ],
    "output_examples": [
      {
        "input": "Give me a safe default deny policy and allow DNS for a production namespace.",
        "output": [
          "Default deny ingress and egress for all pods in the namespace",
          "Allow UDP 53 egress to kube-system for DNS resolution",
          "Note required namespace and label placeholders for customization"
        ]
      }
    ],
    "best_practices": [
      "Start with default deny network policies before adding allow rules",
      "Use namespace scoped Roles when possible",
      "Run pods as non root with a read only filesystem"
    ],
    "anti_patterns": [
      "Granting wildcard verbs and resources in production RBAC",
      "Allowing unrestricted egress to the public internet",
      "Running privileged pods without a documented need"
    ],
    "faq": [
      {
        "question": "Is this compatible with all Kubernetes versions?",
        "answer": "It targets standard Kubernetes APIs and common add ons like Gatekeeper and Istio."
      },
      {
        "question": "What are the main limits of this skill?",
        "answer": "It provides templates and guidance, but does not apply or validate policies."
      },
      {
        "question": "Can I integrate this with GitOps workflows?",
        "answer": "Yes, the YAML examples can be stored and deployed with your GitOps tool."
      },
      {
        "question": "Does it access my cluster or data?",
        "answer": "No, it only provides static guidance and does not connect to your systems."
      },
      {
        "question": "What if a policy does not work as expected?",
        "answer": "Use the troubleshooting commands to check CNI support and RBAC permissions."
      },
      {
        "question": "How does this compare to a security scanner?",
        "answer": "This is a guidance and template skill, not a scanning or compliance tool."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "network-policy-template.yaml",
          "type": "file",
          "path": "assets/network-policy-template.yaml"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "rbac-patterns.md",
          "type": "file",
          "path": "references/rbac-patterns.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
