{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-17T07:58:27.126Z",
    "slug": "wshobson-k8s-security-policies",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/kubernetes-operations/skills/k8s-security-policies",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "bf1e3e39aeb40bad5886b7f658ea441fef936d0a9b056adb01aa2ba595351eda",
    "tree_hash": "68001b9177d5d2ce6da715f14ce60dcb7465c43aeb415eace00421e00d3c650e"
  },
  "skill": {
    "name": "k8s-security-policies",
    "description": "Implement Kubernetes security policies including NetworkPolicy, PodSecurityPolicy, and RBAC for production-grade security. Use when securing Kubernetes clusters, implementing network isolation, or enforcing pod security standards.",
    "summary": "Implement Kubernetes security policies including NetworkPolicy, PodSecurityPolicy, and RBAC for prod...",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "wshobson",
    "license": "MIT",
    "category": "security",
    "tags": [
      "kubernetes",
      "security",
      "rbac",
      "network-policy",
      "devops"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill contains Kubernetes security documentation and YAML templates. All static findings are false positives: the metadata endpoint IP is shown as an EXAMPLE OF WHAT TO BLOCK (security best practice), backtick patterns are markdown code fence syntax, and 'weak crypto' matches are Kubernetes resource names like 'cluster-admin'. No executable code or malicious patterns present.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "assets/network-policy-template.yaml",
            "line_start": 126,
            "line_end": 126
          },
          {
            "file": "assets/network-policy-template.yaml",
            "line_start": 124,
            "line_end": 124
          },
          {
            "file": "assets/network-policy-template.yaml",
            "line_start": 126,
            "line_end": 126
          },
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "references/rbac-patterns.md",
            "line_start": 6,
            "line_end": 15
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 15,
            "line_end": 18
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 18,
            "line_end": 28
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 28,
            "line_end": 31
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 31,
            "line_end": 44
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 44,
            "line_end": 47
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 47,
            "line_end": 72
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 72,
            "line_end": 75
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 75,
            "line_end": 90
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 90,
            "line_end": 95
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 95,
            "line_end": 111
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 111,
            "line_end": 114
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 114,
            "line_end": 125
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 125,
            "line_end": 131
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 131,
            "line_end": 143
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 143,
            "line_end": 146
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 146,
            "line_end": 149
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 149,
            "line_end": 152
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 152,
            "line_end": 155
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 155,
            "line_end": 157
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 157,
            "line_end": 161
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 161,
            "line_end": 162
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 162,
            "line_end": 163
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 163,
            "line_end": 164
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 164,
            "line_end": 165
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 165,
            "line_end": 166
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 166,
            "line_end": 167
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 167,
            "line_end": 168
          },
          {
            "file": "references/rbac-patterns.md",
            "line_start": 168,
            "line_end": 169
          },
          {
            "file": "SKILL.md",
            "line_start": 26,
            "line_end": 35
          },
          {
            "file": "SKILL.md",
            "line_start": 35,
            "line_end": 38
          },
          {
            "file": "SKILL.md",
            "line_start": 38,
            "line_end": 47
          },
          {
            "file": "SKILL.md",
            "line_start": 47,
            "line_end": 50
          },
          {
            "file": "SKILL.md",
            "line_start": 50,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 64
          },
          {
            "file": "SKILL.md",
            "line_start": 64,
            "line_end": 75
          },
          {
            "file": "SKILL.md",
            "line_start": 75,
            "line_end": 78
          },
          {
            "file": "SKILL.md",
            "line_start": 78,
            "line_end": 98
          },
          {
            "file": "SKILL.md",
            "line_start": 98,
            "line_end": 101
          },
          {
            "file": "SKILL.md",
            "line_start": 101,
            "line_end": 119
          },
          {
            "file": "SKILL.md",
            "line_start": 119,
            "line_end": 121
          },
          {
            "file": "SKILL.md",
            "line_start": 121,
            "line_end": 126
          },
          {
            "file": "SKILL.md",
            "line_start": 126,
            "line_end": 136
          },
          {
            "file": "SKILL.md",
            "line_start": 136,
            "line_end": 139
          },
          {
            "file": "SKILL.md",
            "line_start": 139,
            "line_end": 148
          },
          {
            "file": "SKILL.md",
            "line_start": 148,
            "line_end": 151
          },
          {
            "file": "SKILL.md",
            "line_start": 151,
            "line_end": 168
          },
          {
            "file": "SKILL.md",
            "line_start": 168,
            "line_end": 170
          },
          {
            "file": "SKILL.md",
            "line_start": 170,
            "line_end": 175
          },
          {
            "file": "SKILL.md",
            "line_start": 175,
            "line_end": 196
          },
          {
            "file": "SKILL.md",
            "line_start": 196,
            "line_end": 201
          },
          {
            "file": "SKILL.md",
            "line_start": 201,
            "line_end": 230
          },
          {
            "file": "SKILL.md",
            "line_start": 230,
            "line_end": 233
          },
          {
            "file": "SKILL.md",
            "line_start": 233,
            "line_end": 245
          },
          {
            "file": "SKILL.md",
            "line_start": 245,
            "line_end": 250
          },
          {
            "file": "SKILL.md",
            "line_start": 250,
            "line_end": 259
          },
          {
            "file": "SKILL.md",
            "line_start": 259,
            "line_end": 262
          },
          {
            "file": "SKILL.md",
            "line_start": 262,
            "line_end": 277
          },
          {
            "file": "SKILL.md",
            "line_start": 277,
            "line_end": 312
          },
          {
            "file": "SKILL.md",
            "line_start": 312,
            "line_end": 316
          },
          {
            "file": "SKILL.md",
            "line_start": 316,
            "line_end": 319
          },
          {
            "file": "SKILL.md",
            "line_start": 319,
            "line_end": 323
          },
          {
            "file": "SKILL.md",
            "line_start": 323,
            "line_end": 327
          },
          {
            "file": "SKILL.md",
            "line_start": 327,
            "line_end": 328
          },
          {
            "file": "SKILL.md",
            "line_start": 328,
            "line_end": 329
          },
          {
            "file": "SKILL.md",
            "line_start": 329,
            "line_end": 333
          },
          {
            "file": "SKILL.md",
            "line_start": 333,
            "line_end": 334
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 4,
    "total_lines": 900,
    "audit_model": "claude",
    "audited_at": "2026-01-17T07:58:27.126Z"
  },
  "content": {
    "user_title": "Implement Kubernetes Security Policies and RBAC Controls",
    "value_statement": "Kubernetes clusters need proper security policies to protect against unauthorized access and network attacks. This skill provides ready-to-use templates for NetworkPolicy, RBAC, and Pod Security Standards.",
    "seo_keywords": [
      "kubernetes security",
      "network policy",
      "rbac kubernetes",
      "pod security standards",
      "Claude",
      "Claude Code",
      "Codex",
      "k8s security",
      "container security",
      "cluster hardening"
    ],
    "actual_capabilities": [
      "Generate default-deny NetworkPolicy configurations for namespace isolation",
      "Create RBAC Roles and ClusterRoles with least-privilege permissions",
      "Apply Pod Security Standards labels to namespaces",
      "Configure OPA Gatekeeper ConstraintTemplates for admission control",
      "Set up Istio mTLS and AuthorizationPolicy for service mesh security",
      "Design ServiceAccount configurations with token auto-mount disabled"
    ],
    "limitations": [
      "Does not deploy policies directly to clusters",
      "Requires CNI plugin that supports NetworkPolicy enforcement",
      "OPA Gatekeeper templates need Gatekeeper installed on cluster"
    ],
    "use_cases": [
      {
        "target_user": "Platform Engineer",
        "title": "Secure Multi-Tenant Kubernetes Clusters",
        "description": "Implement namespace isolation with NetworkPolicy and RBAC to prevent cross-tenant access in shared clusters."
      },
      {
        "target_user": "DevOps Engineer",
        "title": "Achieve Compliance with Security Standards",
        "description": "Apply CIS Kubernetes Benchmark controls using Pod Security Standards and RBAC configurations."
      },
      {
        "target_user": "Application Developer",
        "title": "Configure Least-Privilege Access for Services",
        "description": "Create ServiceAccounts and RoleBindings that grant only the permissions your application needs."
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Default Deny Policy",
        "scenario": "Starting namespace security from scratch",
        "prompt": "Create a NetworkPolicy that denies all ingress and egress traffic by default for the payments namespace."
      },
      {
        "title": "Design RBAC for CI/CD",
        "scenario": "Setting up deployment pipeline permissions",
        "prompt": "Create a ClusterRole and RoleBinding that allows my CI/CD service account to deploy applications but not read secrets."
      },
      {
        "title": "Configure Pod Security Standards",
        "scenario": "Enforcing container security at namespace level",
        "prompt": "Apply restricted Pod Security Standards to my production namespace with audit logging for violations."
      },
      {
        "title": "Build Complete Security Policy Set",
        "scenario": "Comprehensive cluster hardening project",
        "prompt": "Design a complete security policy set for a microservices application with frontend, backend, and database tiers including NetworkPolicy, RBAC, and Pod Security contexts."
      }
    ],
    "output_examples": [
      {
        "input": "Create a NetworkPolicy that allows frontend pods to talk to backend on port 8080",
        "output": [
          "NetworkPolicy created for namespace 'production'",
          "Ingress rule: allows traffic from pods with label app=frontend",
          "Target: pods with label app=backend on TCP port 8080",
          "All other ingress traffic to backend pods is denied"
        ]
      },
      {
        "input": "Set up RBAC for a developer who needs read access to pods and deployments",
        "output": [
          "Role 'developer-read' created in namespace 'development'",
          "Permissions: get, list, watch on pods and deployments",
          "RoleBinding 'dev-team-read' binds role to user 'alice@company.com'",
          "No write or delete permissions granted"
        ]
      }
    ],
    "best_practices": [
      "Start with default-deny NetworkPolicy and add specific allow rules",
      "Use namespace-scoped Roles instead of ClusterRoles when possible",
      "Disable ServiceAccount token auto-mounting for pods that do not need API access"
    ],
    "anti_patterns": [
      "Do not use wildcard verbs or resources in production RBAC rules",
      "Do not skip Pod Security Standards enforcement in production namespaces",
      "Do not grant cluster-admin to application ServiceAccounts"
    ],
    "faq": [
      {
        "question": "Why is my NetworkPolicy not blocking traffic?",
        "answer": "Verify your CNI plugin supports NetworkPolicy. Calico, Cilium, and Weave support it. Flannel does not by default."
      },
      {
        "question": "What is the difference between Role and ClusterRole?",
        "answer": "Role is namespace-scoped and grants access within one namespace. ClusterRole is cluster-wide and can grant access across all namespaces."
      },
      {
        "question": "Should I use Pod Security Policies or Pod Security Standards?",
        "answer": "Use Pod Security Standards. PodSecurityPolicy is deprecated since Kubernetes 1.21 and removed in 1.25."
      },
      {
        "question": "How do I test if RBAC permissions are working?",
        "answer": "Use kubectl auth can-i command to test permissions. Example: kubectl auth can-i list pods --as system:serviceaccount:ns:sa"
      },
      {
        "question": "What Pod Security Standard level should I use for production?",
        "answer": "Use 'restricted' for production workloads. It enforces non-root users, read-only filesystems, and dropped capabilities."
      },
      {
        "question": "How do I allow DNS traffic with a default-deny policy?",
        "answer": "Add an egress rule allowing UDP port 53 to the kube-system namespace where CoreDNS runs."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "network-policy-template.yaml",
          "type": "file",
          "path": "assets/network-policy-template.yaml",
          "lines": 178
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "rbac-patterns.md",
          "type": "file",
          "path": "references/rbac-patterns.md",
          "lines": 188
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 335
    }
  ]
}
