{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-21T18:54:14.589Z",
    "slug": "wshobson-bats-testing-patterns",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/shell-scripting/skills/bats-testing-patterns",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "e89d87d22ded41adad20bb53004574f8867ab4d360ff84e1c35fd7576579aeb5",
    "tree_hash": "a36357728448b29b775d7b87d73794d3e8f97a5332b18a337bda552f416bcd88"
  },
  "skill": {
    "name": "bats-testing-patterns",
    "description": "Master Bash Automated Testing System (Bats) for comprehensive shell script testing. Use when writing tests for shell scripts, CI/CD pipelines, or requiring test-driven development of shell utilities.",
    "summary": "Comprehensive guide for writing unit tests for shell scripts using Bats framework",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "wshobson",
    "license": "MIT",
    "category": "devops",
    "tags": [
      "testing",
      "bash",
      "shell-scripts",
      "test-automation",
      "ci-cd"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Static analysis flagged 103 patterns including external commands, filesystem operations, and network references. All findings are false positives from educational code examples teaching Bats testing patterns. The skill contains no executable code, only documentation with test pattern examples. URLs reference legitimate documentation sites (GitHub, readthedocs.io). No security risks identified.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 1721,
    "audit_model": "claude",
    "audited_at": "2026-01-21T18:54:14.589Z"
  },
  "content": {
    "user_title": "Master Shell Testing with Bats Framework",
    "value_statement": "Writing reliable shell scripts without tests leads to production failures. This skill teaches comprehensive Bats testing patterns to validate shell scripts with unit tests, fixtures, and CI/CD integration.",
    "seo_keywords": [
      "Claude",
      "Codex",
      "Claude Code",
      "Bats testing",
      "shell script testing",
      "bash unit tests",
      "test automation",
      "CI/CD testing"
    ],
    "actual_capabilities": [
      "Generate Bats test files with proper structure and assertions",
      "Create setup and teardown functions for test fixtures",
      "Implement mocking and stubbing patterns for external dependencies",
      "Design test helpers and shared utilities for test suites",
      "Configure CI/CD integration with GitHub Actions and Make",
      "Write tests for error conditions and edge cases"
    ],
    "limitations": [
      "Provides testing patterns only, does not execute tests",
      "Requires Bats framework to be installed separately",
      "Examples assume bash environment, may need adjustment for other shells",
      "Does not cover performance testing or load testing scenarios"
    ],
    "use_cases": [
      {
        "title": "DevOps Engineer Testing Deployment Scripts",
        "description": "Write comprehensive unit tests for deployment automation scripts to validate behavior before production rollout. Test setup, teardown, error handling, and edge cases.",
        "target_user": "DevOps Engineer"
      },
      {
        "title": "Developer Implementing TDD for Shell Utilities",
        "description": "Apply test-driven development methodology to shell script development. Write tests first, then implement functionality to meet test specifications.",
        "target_user": "Software Developer"
      },
      {
        "title": "Site Reliability Engineer Validating System Scripts",
        "description": "Create automated test suites for system administration scripts in CI/CD pipelines. Validate scripts work across different environments and shell dialects.",
        "target_user": "SRE/System Administrator"
      }
    ],
    "prompt_templates": [
      {
        "title": "Generate Basic Bats Test File",
        "prompt": "Create a Bats test file for my script that validates command line argument parsing and exit codes",
        "scenario": "Starting a new test suite for an existing shell script"
      },
      {
        "title": "Add Setup and Teardown Functions",
        "prompt": "Add setup and teardown functions to my Bats test that create temporary directories and clean up test fixtures",
        "scenario": "Tests need isolated temporary environments"
      },
      {
        "title": "Mock External Dependencies",
        "prompt": "Show me how to mock the curl command in my Bats tests so I can test API functions without real network calls",
        "scenario": "Testing functions that depend on external commands"
      },
      {
        "title": "Integrate Tests into CI Pipeline",
        "prompt": "Create a GitHub Actions workflow that runs my Bats test suite on every pull request with TAP output format",
        "scenario": "Automating tests in continuous integration"
      }
    ],
    "output_examples": [
      {
        "input": "Create a Bats test to verify my backup script creates the correct files",
        "output": "Generated Bats test file with @test blocks for file creation validation, setup function creating temporary test directory, teardown cleaning up test files, and assertions checking file existence and permissions."
      },
      {
        "input": "Add error handling tests for my validation function",
        "output": "Created test cases for missing arguments, invalid input formats, permission denied scenarios, and helpful error messages. Each test uses run command and checks exit status and error output."
      },
      {
        "input": "Set up test fixtures for complex input scenarios",
        "output": "Implemented fixtures directory structure with sample input files, helper function to load fixtures in setup, and comparison assertions using diff against expected output files."
      }
    ],
    "best_practices": [
      "Use setup and teardown functions to create isolated test environments with temporary directories that are cleaned up after each test",
      "Mock external dependencies and commands to make tests fast, deterministic, and independent of external services or system state",
      "Write descriptive test names that clearly explain what is being validated, making test failures easier to diagnose and understand"
    ],
    "anti_patterns": [
      "Avoid tests that depend on specific system state or files outside the test directory, which makes tests fragile and non-portable",
      "Do not skip teardown cleanup, as leftover temporary files accumulate and can cause test failures or fill disk space",
      "Never test multiple unrelated behaviors in a single test case, which makes it difficult to identify which specific functionality failed"
    ],
    "faq": [
      {
        "question": "What is Bats and when should I use it?",
        "answer": "Bats is a testing framework for shell scripts that uses TAP output format. Use it when you need to validate shell script behavior with automated tests in CI/CD pipelines or during development."
      },
      {
        "question": "How do I install Bats on my system?",
        "answer": "Install via package managers: brew install bats-core on macOS, or npm install --global bats for Node.js environments, or clone from GitHub and run install script."
      },
      {
        "question": "Can I mock external commands in my tests?",
        "answer": "Yes, create stub scripts in a temporary directory, add it to PATH before the real commands, and the stubs will be called instead of the actual external commands."
      },
      {
        "question": "How do I test error conditions and failures?",
        "answer": "Use the run command to capture exit status and output, then assert that status is non-zero and output contains expected error messages for failure scenarios."
      },
      {
        "question": "Can Bats tests run in parallel?",
        "answer": "Yes, use the --parallel flag with a number to specify how many tests to run concurrently. Ensure tests are independent and use isolated temporary directories."
      },
      {
        "question": "How do I integrate Bats with CI/CD pipelines?",
        "answer": "Install Bats in your CI environment, run bats tests with --tap flag for TAP output, and configure your CI system to parse test results and fail builds on test failures."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 631
    }
  ]
}
