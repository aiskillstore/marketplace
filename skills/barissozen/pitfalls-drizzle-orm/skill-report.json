{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-16T18:13:01.160Z",
    "slug": "barissozen-pitfalls-drizzle-orm",
    "source_url": "https://github.com/BarisSozen/claude/tree/main/.claude/skills/pitfalls-drizzle-orm",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "35a2dacfa4c20af178cf5cb4a96c1cc7ccf85efdbddb341cb25d2a31c1440f6f",
    "tree_hash": "e24bada214625ddb52698af6e898b7ce43d2fdae1f32f8a2e49126f89672d883"
  },
  "skill": {
    "name": "pitfalls-drizzle-orm",
    "description": "Drizzle ORM patterns and migration safety rules. Use when defining schemas, running migrations, or debugging database issues. Triggers on: Drizzle, schema, migration, db:push, $inferSelect, array column.",
    "summary": "Drizzle ORM patterns and migration safety rules. Use when defining schemas, running migrations, or d...",
    "icon": "üóÑÔ∏è",
    "version": "1.0.0",
    "author": "BarisSozen",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "database",
      "orm",
      "typescript",
      "migration",
      "drizzle"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "filesystem",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation skill with no executable code. All static findings are false positives triggered by pattern matching on legitimate documentation content. The skill provides Drizzle ORM guidance and never executes commands, accesses networks, or modifies filesystems.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "skill-report.json",
            "line_start": 6,
            "line_end": 6
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 36,
            "line_end": 51
          },
          {
            "file": "SKILL.md",
            "line_start": 51,
            "line_end": 55
          },
          {
            "file": "SKILL.md",
            "line_start": 55,
            "line_end": 63
          },
          {
            "file": "SKILL.md",
            "line_start": 63,
            "line_end": 67
          },
          {
            "file": "SKILL.md",
            "line_start": 67,
            "line_end": 80
          },
          {
            "file": "SKILL.md",
            "line_start": 80,
            "line_end": 85
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 268,
    "audit_model": "claude",
    "audited_at": "2026-01-16T18:13:01.160Z"
  },
  "content": {
    "user_title": "Avoid Drizzle ORM pitfalls with best practices",
    "value_statement": "Drizzle ORM migrations and schema definitions often cause runtime errors and data loss. This skill provides proven patterns for safe migrations, correct array syntax, and proper type inference.",
    "seo_keywords": [
      "Drizzle ORM",
      "database migration",
      "schema definition",
      "TypeScript ORM",
      "PostgreSQL",
      "array columns",
      "type inference",
      "drizzle-zod",
      "Claude",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Identifies safe vs unsafe primary key changes in migrations",
      "Verifies correct array column syntax for Drizzle",
      "Provides type inference patterns using $inferSelect and $inferInsert",
      "Recommends drizzle-zod validation integration",
      "Lists migration safety checklist items",
      "Reviews Drizzle schema definitions for common errors"
    ],
    "limitations": [
      "Does not execute migrations or modify databases directly",
      "Cannot generate migration scripts automatically",
      "Does not connect to databases or verify schema validity",
      "Limited to pattern guidance rather than automated fixes"
    ],
    "use_cases": [
      {
        "target_user": "Backend developers",
        "title": "Safe production migrations",
        "description": "Avoid costly migration errors when changing primary key types or adding columns in production databases."
      },
      {
        "target_user": "Full-stack engineers",
        "title": "Correct array column syntax",
        "description": "Use the correct text().array() syntax instead of the broken array(text()) pattern."
      },
      {
        "target_user": "TypeScript developers",
        "title": "Type-safe database operations",
        "description": "Generate proper insert and select types from Drizzle schema definitions using $inferSelect."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic migration review",
        "scenario": "Checking migration safety",
        "prompt": "Review this Drizzle ORM migration for safety issues. Check for primary key type changes, array syntax errors, and missing type exports."
      },
      {
        "title": "Schema pattern check",
        "scenario": "Validating schema definitions",
        "prompt": "Check my Drizzle schema for common pitfalls. Verify array columns use correct syntax and types are properly exported."
      },
      {
        "title": "Type inference help",
        "scenario": "Creating type definitions",
        "prompt": "Help me create TypeScript types from my Drizzle schema using $inferSelect and $inferInsert patterns."
      },
      {
        "title": "Zod integration",
        "scenario": "Adding validation",
        "prompt": "Show me how to integrate drizzle-zod with my schema for input validation in my API routes."
      }
    ],
    "output_examples": [
      {
        "input": "Review this Drizzle schema for pitfalls",
        "output": [
          "Array columns use correct text().array() syntax",
          "No primary key type changes detected (safe for migration)",
          "$inferSelect and $inferInsert types are exported",
          "Consider adding drizzle-zod validation schema",
          "Recommendation: Test db:push in development before production"
        ]
      },
      {
        "input": "Help me fix array column queries",
        "output": [
          "Problem: array(text('column')) is incorrect syntax",
          "Solution: Use text('column').array() instead",
          "This fixes array operations and PostgreSQL compatibility",
          "Update your schema definition and regenerate types"
        ]
      },
      {
        "input": "How do I add validation to my API",
        "output": [
          "Use drizzle-zod for schema validation",
          "Import createInsertSchema from drizzle-zod",
          "Generate validation schemas from your Drizzle tables",
          "Use zod inference for request body types"
        ]
      }
    ],
    "best_practices": [
      "Never change primary key types (serial, varchar, uuid) in existing tables - this breaks migrations",
      "Always use text('column').array() syntax, never array(text('column')) for array columns",
      "Export $inferSelect and $inferInsert types from every schema module for type-safe queries"
    ],
    "anti_patterns": [
      "Changing primary key column types in production migrations causes data loss",
      "Using array(text('column')) syntax instead of text('column').array() breaks array operations",
      "Running db:push --force without backup in production risks irreversible data loss"
    ],
    "faq": [
      {
        "question": "Which databases are supported by Drizzle ORM?",
        "answer": "Drizzle supports PostgreSQL, MySQL, SQLite, and Cloudflare D1. Each has slightly different migration requirements."
      },
      {
        "question": "What are the limits on schema changes?",
        "answer": "Adding columns is safe. Renaming requires careful migration. Changing primary key types always breaks existing data."
      },
      {
        "question": "How do I integrate with existing code?",
        "answer": "Import your schema file, use $inferSelect for queries, $inferInsert for inserts, and drizzle-zod for validation."
      },
      {
        "question": "Is my data safe when using this skill?",
        "answer": "Yes. This skill only provides guidance. It never executes migrations or accesses your database directly."
      },
      {
        "question": "Why is my array column query failing?",
        "answer": "Check syntax. Use columnName: text('name').array() not array(text('name')). Drizzle requires the first format."
      },
      {
        "question": "How does this compare to Prisma or other ORMs?",
        "answer": "Drizzle offers faster performance and TypeScript-first design. Migration syntax differs - Drizzle uses SQL-like migrations."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 89
    }
  ]
}
