{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-21T15:17:16.053Z",
    "slug": "cleanexpo-stripe-agent",
    "source_url": "https://github.com/CleanExpo/Unite-Hub/tree/main/.claude/skills/stripe-agent",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "53fbf7a935f3c56a2c64f89c23313ca4185b43a1583fce1763d17a696ac2601c",
    "tree_hash": "6b08030b2c6a46afeb9ea018b1fe981eaf70ca6d48758c5c9bfe8eec2546c1b2"
  },
  "skill": {
    "name": "stripe-agent",
    "description": "Automates Stripe billing operations including product setup, subscription management, checkout sessions, and webhook handling with dual-mode support for test and live environments.",
    "summary": "Manages Stripe billing operations with dual-mode test and live environment support",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "CleanExpo",
    "license": "MIT",
    "category": "productivity",
    "tags": [
      "stripe",
      "billing",
      "payments",
      "subscriptions",
      "webhooks"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill provides legitimate Stripe payment integration functionality. Static analyzer flagged 102 potential issues, but manual review confirms these are false positives from documentation patterns and markdown code blocks. The skill properly uses environment variables for API credentials and follows Stripe integration best practices. Network access is legitimate for Stripe API communication.",
    "risk_factor_evidence": [
      {
        "factor": "network",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 69,
            "line_end": 70
          },
          {
            "file": "SKILL.md",
            "line_start": 345,
            "line_end": 350
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 166,
            "line_end": 174
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Environment Variable Access for API Credentials",
        "description": "The skill documentation references Stripe API keys stored in environment variables (STRIPE_TEST_SECRET_KEY, STRIPE_LIVE_SECRET_KEY). This is the proper security practice for managing API credentials. Users should ensure these variables are properly secured in their deployment environment.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 166,
            "line_end": 174
          }
        ]
      },
      {
        "title": "Network Communication with Stripe API",
        "description": "The skill makes network requests to Stripe API endpoints using the @stripe/mcp server. This is expected behavior for a Stripe billing integration. All communication is with legitimate Stripe services.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 69,
            "line_end": 70
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 1550,
    "audit_model": "claude",
    "audited_at": "2026-01-21T15:17:16.053Z"
  },
  "content": {
    "user_title": "Automate Stripe Billing and Subscription Management",
    "value_statement": "Managing Stripe billing manually is time-consuming and error-prone. This skill automates product setup, subscription lifecycle management, checkout sessions, and webhook processing with support for dual test and live environments.",
    "seo_keywords": [
      "Stripe integration",
      "payment automation",
      "subscription management",
      "billing automation",
      "Claude Code",
      "Claude",
      "Codex",
      "webhook handling",
      "checkout sessions",
      "Stripe API"
    ],
    "actual_capabilities": [
      "Create and manage Stripe products and pricing tiers with monthly and annual billing options",
      "Generate checkout sessions for customer subscription sign-ups with customizable success and cancel URLs",
      "Process Stripe webhook events including subscription lifecycle changes and payment status updates",
      "Manage customer records and subscription upgrades or downgrades with proration calculations",
      "Support dual-mode billing with separate test and live environments for staff and customer separation",
      "Generate billing reports with revenue breakdowns by tier and subscription metrics"
    ],
    "limitations": [
      "Requires valid Stripe API credentials configured in environment variables",
      "Depends on the @stripe/mcp server being properly installed and configured",
      "Does not handle payment method updates or customer portal access directly",
      "Webhook processing requires proper endpoint configuration in Stripe dashboard"
    ],
    "use_cases": [
      {
        "title": "SaaS Subscription Setup",
        "description": "Set up complete subscription billing for a SaaS product with multiple pricing tiers, automated checkout, and webhook-driven subscription activation.",
        "target_user": "SaaS founders launching subscription-based products"
      },
      {
        "title": "Billing System Audit",
        "description": "Audit existing Stripe configuration to verify all products, prices, and webhooks are properly configured across test and live environments.",
        "target_user": "DevOps engineers managing production billing infrastructure"
      },
      {
        "title": "Subscription Lifecycle Management",
        "description": "Handle customer subscription upgrades, downgrades, and cancellations with proper proration and database synchronization.",
        "target_user": "Backend developers building customer billing portals"
      }
    ],
    "prompt_templates": [
      {
        "title": "Setup Stripe Products",
        "prompt": "Create three Stripe products: Starter at $495/month, Professional at $895/month, and Elite at $1,295/month. Include both monthly and annual pricing with annual discount.",
        "scenario": "Initial product catalog setup for new SaaS launch"
      },
      {
        "title": "Create Checkout Session",
        "prompt": "Create a Stripe checkout session for user email@example.com subscribing to the Professional tier with monthly billing. Use workspace ID ws_123 and redirect to /dashboard on success.",
        "scenario": "User clicks subscribe button on pricing page"
      },
      {
        "title": "Process Subscription Upgrade",
        "prompt": "Upgrade subscription sub_abc123 from Starter to Professional tier with proration. Update the workspace tier in the database after successful upgrade.",
        "scenario": "Existing customer wants to upgrade their plan"
      },
      {
        "title": "Generate Billing Report",
        "prompt": "Generate a billing report for the current month showing total revenue, revenue by tier, active subscriptions, new subscriptions, churned subscriptions, and MRR.",
        "scenario": "Monthly financial reporting and metrics analysis"
      }
    ],
    "output_examples": [
      {
        "input": "Audit the Stripe configuration and check if all required environment variables are present",
        "output": [
          "Stripe Configuration Audit Results:",
          "Status: Healthy",
          "Environment Variables: All 12 required variables present",
          "Products: 3 products found (Starter, Professional, Elite)",
          "Prices: 6 prices configured (monthly and annual for each tier)",
          "Webhooks: Test webhook configured, Live webhook pending setup",
          "Recommendation: Add STRIPE_LIVE_WEBHOOK_SECRET to production environment"
        ]
      },
      {
        "input": "Create a checkout session for john@example.com subscribing to Professional tier monthly",
        "output": [
          "Checkout session created successfully",
          "Customer: cus_ABC123 (john@example.com)",
          "Price: Professional Monthly - $895.00 AUD",
          "Checkout URL: https://checkout.stripe.com/c/pay/cs_test_xyz789",
          "Session expires in 24 hours",
          "Workspace will be upgraded upon successful payment"
        ]
      },
      {
        "input": "List all active subscriptions for customer cus_ABC123",
        "output": [
          "Active Subscriptions for cus_ABC123:",
          "Subscription ID: sub_123456",
          "Tier: Professional",
          "Billing: Monthly ($895.00 AUD)",
          "Status: Active",
          "Current period: 2026-01-15 to 2026-02-15",
          "Next invoice: 2026-02-15"
        ]
      }
    ],
    "best_practices": [
      "Always use separate test and live API keys and configure them properly in environment variables to avoid mixing test and production data",
      "Implement webhook signature verification using webhook secrets to ensure incoming webhook events are genuine Stripe requests",
      "Store subscription and customer data in your database synchronized with Stripe to enable fast queries without repeated API calls"
    ],
    "anti_patterns": [
      "Avoid hardcoding API keys or price IDs directly in code instead of using environment variables and configuration management",
      "Do not process subscription changes without webhook confirmation as payments may fail or require additional authentication steps",
      "Never skip webhook signature verification as this exposes your billing system to forged webhook attacks and data manipulation"
    ],
    "faq": [
      {
        "question": "What Stripe API credentials do I need to configure?",
        "answer": "You need to set up test and live secret keys, webhook secrets, publishable keys, and price IDs for each tier in your environment variables. The skill documentation lists all 12 required variables."
      },
      {
        "question": "How does the dual-mode billing system work?",
        "answer": "The skill automatically routes staff users with specific roles or internal email domains to test mode, while real customers use live mode. This prevents test charges from mixing with production billing."
      },
      {
        "question": "Can this skill handle subscription upgrades and downgrades?",
        "answer": "Yes, the skill can process subscription changes with proration calculations and update your database to reflect the new tier. Users are charged or credited based on time remaining in the billing period."
      },
      {
        "question": "What webhook events does this skill handle?",
        "answer": "The skill processes checkout completion, subscription creation, updates and deletion, invoice paid and payment failed events. Each event triggers appropriate actions like activating subscriptions or sending notifications."
      },
      {
        "question": "Do I need the @stripe/mcp server installed?",
        "answer": "Yes, this skill depends on the official Stripe MCP server to communicate with the Stripe API. You need to install and configure it before using this skill."
      },
      {
        "question": "How can I test the billing flow without real payments?",
        "answer": "Use Stripe test mode with test card numbers provided in the documentation. The skill supports separate test webhooks and products for safe testing without affecting production data."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 475
    }
  ]
}
