{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:20:24.153Z",
    "slug": "aqualia-sharepoint-audit",
    "source_url": "https://github.com/Aqualia/Skills-Library/tree/main/sharepoint-audit-agent/wrappers/claude-skill",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "29108474e7a26caa995ba258e7ac2d29533a6511099c22f571d200a612c6a608",
    "tree_hash": "520603fa10cd5d12232aeca050e20445eb042087c257c9519a6ffd7d8056b608"
  },
  "skill": {
    "name": "sharepoint-audit",
    "description": "Guide and run a SharePoint audit locally. Collect inputs, confirm PowerShell 7.4+ and Python 3.10+ are available, call PowerShell with certificate auth via wrapper, parse audit.json, and render Markdown/HTML. Use only local shell commands.\n",
    "summary": "Guide and run a SharePoint audit locally. Collect inputs, confirm PowerShell 7.4+ and Python 3.10+ a...",
    "icon": "ðŸ“‹",
    "version": "1.0.0",
    "author": "Aqualia",
    "license": "MIT",
    "category": "security",
    "tags": [
      "sharepoint",
      "audit",
      "permissions",
      "powershell",
      "security"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "filesystem",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Prompt-based skill that provides instructions for running SharePoint audit scripts locally. Includes security-conscious rules and is appropriate for its stated administrative purpose.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 18,
            "line_end": 19
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 19,
            "line_end": 20
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 17,
            "line_end": 24
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "External command execution capability",
        "description": "The skill instructs users to execute local shell commands including PowerShell and Python scripts. This is the legitimate purpose of the skill but enables code execution if misused. Quote from SKILL.md lines 18-19: 'pwsh ./sharepoint-audit-agent/agent/powershell/Install-Modules.ps1' and 'python ./sharepoint-audit-agent/agent/python/audit_agent.py â€¦ --output ./runs'",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 18,
            "line_end": 19
          }
        ]
      },
      {
        "title": "Environment variable access for secrets",
        "description": "The skill reads PFX password from environment variable PFX_PASS. Quote from SKILL.md line 24: 'Never echo secrets. Read PFX password from env var.' This is appropriate for the use case but involves credential handling.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 17,
            "line_end": 24
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 26,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:20:24.153Z"
  },
  "content": {
    "user_title": "Audit SharePoint permissions",
    "value_statement": "Users need to audit SharePoint Online permissions for security compliance. This skill guides you through setting up certificate authentication, running local audit scripts, and generating permission reports for single sites or batches from CSV files.",
    "seo_keywords": [
      "SharePoint audit",
      "SharePoint permissions",
      "Claude Code skill",
      "Microsoft 365 security",
      "SharePoint Online audit",
      "PnP PowerShell",
      "Claude skill",
      "Codex skill",
      "permission audit",
      "tenant administration"
    ],
    "actual_capabilities": [
      "Collect SharePoint tenant and app credentials securely",
      "Verify PowerShell 7.4+ and Python 3.10+ requirements",
      "Run local audit scripts with certificate-based authentication",
      "Parse audit results and render Markdown or HTML reports",
      "Support single site or batch audit from CSV definitions",
      "Generate permission reports with sensitive data warnings"
    ],
    "limitations": [
      "Requires PowerShell 7.4+ and Python 3.10+ to be pre-installed locally",
      "Does not modify SharePoint permissions, read-only audit only",
      "Report files contain sensitive data and require secure handling",
      "Certificate authentication requires valid PFX file and password"
    ],
    "use_cases": [
      {
        "target_user": "Security auditors",
        "title": "Compliance permission review",
        "description": "Review SharePoint site permissions across multiple site collections to identify over-privileged access and ensure compliance."
      },
      {
        "target_user": "IT administrators",
        "title": "Tenant-wide audit workflow",
        "description": "Run systematic permission audits on SharePoint Online environments using certificate-based authentication for unattended operation."
      },
      {
        "target_user": "Data governance teams",
        "title": "Batch site reporting",
        "description": "Generate permission reports for hundreds of sites defined in CSV files for large-scale governance initiatives."
      }
    ],
    "prompt_templates": [
      {
        "title": "Single site audit",
        "scenario": "Audit one SharePoint site",
        "prompt": "Run a SharePoint audit for site https://contoso.sharepoint.com/sites/HRTeam. Tenant ID is my-tenant-id, App ID is my-app-id, PFX path is /certs/app.pfx. Output to ./reports."
      },
      {
        "title": "Batch CSV audit",
        "scenario": "Audit multiple sites from CSV",
        "prompt": "Run a SharePoint audit for all sites listed in sites.csv. Use certificate auth with tenant-id, app-id, and PFX at /certs/app.pfx. Output to ./batch-reports."
      },
      {
        "title": "Write permission audit",
        "scenario": "Audit with write access",
        "prompt": "Run a SharePoint audit for site https://contoso.sharepoint.com/sites/Finance with Sites.Selected permission set to Write. Tenant ID, App ID, and PFX path as configured."
      },
      {
        "title": "Automated audit script",
        "scenario": "Generate automation script",
        "prompt": "Create a shell script to automate SharePoint audits. It should prompt for all required inputs, run the audit, and save reports with timestamps."
      }
    ],
    "output_examples": [
      {
        "input": "Audit SharePoint site https://contoso.sharepoint.com/sites/Marketing with tenant-id, app-id, and PFX at /certs/app.pfx",
        "output": [
          "Audit completed successfully",
          "Report saved to: ./runs/20240110-143022/site-marketing/report.html",
          "Total sites audited: 1",
          "Permission levels found: Full Control, Edit, Read, View",
          "WARNING: Report contains sensitive permission data"
        ]
      }
    ],
    "best_practices": [
      "Store PFX certificates and passwords securely; never commit them to version control",
      "Use the default Sites.Selected Read permission scope unless Write access is explicitly required",
      "Review and delete audit reports containing sensitive data after completing your audit",
      "Run audits in isolated environments when possible to contain potential credential exposure"
    ],
    "anti_patterns": [
      "Echoing secrets or credentials in chat output - always read from environment variables",
      "Running audits without verifying the PFX certificate path and password first",
      "Leaving audit reports in shared directories without access controls",
      "Granting Write permissions when only Read access is needed for the audit"
    ],
    "faq": [
      {
        "question": "What versions of PowerShell and Python are required?",
        "answer": "PowerShell 7.4+ and Python 3.10+ must be installed locally. Check versions with 'pwsh -Version' and 'python --version' before starting."
      },
      {
        "question": "What authentication methods are supported?",
        "answer": "Certificate-based authentication using Azure AD app registration with PFX certificate. App requires Sites.Selected permissions for the target sites."
      },
      {
        "question": "How many sites can I audit at once?",
        "answer": "Single site audits or batch audits from CSV files. Batch size is limited only by Azure AD throttling and your patience waiting for results."
      },
      {
        "question": "Is my credential data safe?",
        "answer": "Credentials are read from environment variables and never echoed. Reports contain sensitive permission data - handle them securely and delete when done."
      },
      {
        "question": "Audit fails with connection error. What do I check?",
        "answer": "Verify tenant ID, app ID, PFX path, and PFX_PASS environment variable. Ensure the Azure AD app has Graph API permissions and site access."
      },
      {
        "question": "How does this compare to Microsoft Purview compliance audits?",
        "answer": "This skill audits SharePoint permission structures directly. Microsoft Purview focuses on compliance and data governance. Use both for comprehensive coverage."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
