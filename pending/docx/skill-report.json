{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T12:24:44.425Z",
    "slug": "docx",
    "source_url": "https://github.com/anthropics/skills/tree/main/skills/docx",
    "source_ref": "main",
    "model": "gemini",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "docx",
    "description": "Comprehensive document creation, editing, and analysis with support for tracked changes, comments, formatting preservation, and text extraction. When Claude needs to work with professional documents (.docx files) for: (1) Creating new documents, (2) Modifying or editing content, (3) Working with tracked changes, (4) Adding comments, or any other document tasks",
    "summary": "Comprehensive document creation, editing, and analysis with support for tracked changes, comments, f...",
    "icon": "üìù",
    "version": "1.0",
    "author": "Anthropic",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "productivity",
    "tags": [
      "docx",
      "word",
      "ooxml",
      "office",
      "automation",
      "redlining"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "network",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill consists of Python utility scripts for manipulating OOXML structures and documentation for using external tools. It uses 'defusedxml' for safe XML parsing, mitigating XXE risks. Subprocess calls to 'soffice' and 'git' are used for validation and diffing but appear to use safe argument handling. No malicious patterns found.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 59,
    "total_lines": 24725,
    "audit_model": "gemini",
    "audited_at": "2025-12-30T12:24:44.420Z"
  },
  "content": {
    "user_title": "Word Document Master",
    "value_statement": "A professional-grade toolkit for programmatic manipulation of Microsoft Word documents, specializing in complex editing, tracked changes (redlining), and comments.",
    "seo_keywords": [
      "docx editing",
      "python docx",
      "redlining automation",
      "word document analysis",
      "ooxml manipulation",
      "track changes programming"
    ],
    "actual_capabilities": [
      "Create new .docx files using JavaScript/TypeScript templates",
      "Edit existing .docx files via Python OOXML manipulation",
      "Programmatically add and reply to comments",
      "Implement tracked changes (insertions and deletions) systematically",
      "Extract text and converting documents to Markdown or Images",
      "Validate OOXML structure and schema compliance"
    ],
    "limitations": [
      "Requires external dependencies (pandoc, LibreOffice, Poppler) for some features",
      "Direct XML manipulation requires careful handling to avoid corruption (though safeguards are included)",
      "Redlining workflow is complex and requires strict adherence to patterns"
    ],
    "use_cases": [
      {
        "title": "Legal Contract Review",
        "description": "Programmatically reviewing legal documents, inserting comments for flagged clauses, and suggesting edits via tracked changes.",
        "target_user": "Legal Tech Developers"
      },
      {
        "title": "Automated Report Generation",
        "description": "Creating polished, formatted business reports from raw data using the 'docx-js' creation workflow.",
        "target_user": "Data Analysts"
      },
      {
        "title": "Document Sanitization",
        "description": "Analyzing and modifying document XML to remove specific metadata or hidden content.",
        "target_user": "Security Analysts"
      }
    ],
    "prompt_templates": [
      {
        "title": "Analyze and Edit Document",
        "prompt": "Unpack the document 'contract.docx', find the paragraph containing 'Liability Limit', and suggest a tracked change to increase the limit to $5M. Also add a comment explaining why.",
        "scenario": "Editing an existing file"
      },
      {
        "title": "Convert to Markdown",
        "prompt": "Convert 'specs.docx' to markdown using pandoc, preserving the tracked changes so I can see what was edited.",
        "scenario": "Reviewing content"
      }
    ],
    "output_examples": [
      {
        "input": "python ooxml/scripts/pack.py unpacked output.docx",
        "output": "Successfully packed 'unpacked' into 'output.docx'."
      }
    ],
    "best_practices": [
      "Always use the provided 'Document' class in Python for editing to ensure proper RSID and ID handling.",
      "Use 'pandoc' for text extraction instead of parsing XML manually when possible.",
      "Validate documents using the 'validate.py' script after any XML modification."
    ],
    "anti_patterns": [
      "Modifying 'word/document.xml' directly without updating relationship files or content types.",
      "Using string replacement on XML content without parsing it (risk of breaking tags).",
      "Nesting tracked changes incorrectly (e.g. putting deletions inside insertions without proper structure)."
    ],
    "faq": [
      {
        "question": "Why do I need to unpack the document?",
        "answer": "DOCX files are ZIP archives. Unpacking allows direct access to the internal XML structure for granular editing that isn't possible with standard libraries."
      },
      {
        "question": "What is 'Redlining'?",
        "answer": "Redlining refers to the process of editing a document with 'Track Changes' enabled, visually showing additions and deletions for review."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "python3",
        "node.js",
        "pandoc",
        "libreoffice (soffice)",
        "poppler-utils",
        "defusedxml (python pkg)",
        "docx (npm pkg)"
      ],
      "permissions": [
        "file_system_read",
        "file_system_write",
        "run_shell_command"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "ooxml",
      "type": "dir",
      "path": "ooxml",
      "children": [
        {
          "name": "schemas",
          "type": "dir",
          "path": "ooxml/schemas",
          "children": [
            {
              "name": "ecma",
              "type": "dir",
              "path": "ooxml/schemas/ecma",
              "children": [
                {
                  "name": "fouth-edition",
                  "type": "dir",
                  "path": "ooxml/schemas/ecma/fouth-edition"
                }
              ]
            },
            {
              "name": "ISO-IEC29500-4_2016",
              "type": "dir",
              "path": "ooxml/schemas/ISO-IEC29500-4_2016",
              "children": [
                {
                  "name": "dml-chart.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chart.xsd"
                },
                {
                  "name": "dml-chartDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chartDrawing.xsd"
                },
                {
                  "name": "dml-diagram.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-diagram.xsd"
                },
                {
                  "name": "dml-lockedCanvas.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-lockedCanvas.xsd"
                },
                {
                  "name": "dml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-main.xsd"
                },
                {
                  "name": "dml-picture.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-picture.xsd"
                },
                {
                  "name": "dml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "dml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "pml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/pml.xsd"
                },
                {
                  "name": "shared-additionalCharacteristics.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-additionalCharacteristics.xsd"
                },
                {
                  "name": "shared-bibliography.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-bibliography.xsd"
                },
                {
                  "name": "shared-commonSimpleTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-commonSimpleTypes.xsd"
                },
                {
                  "name": "shared-customXmlDataProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlDataProperties.xsd"
                },
                {
                  "name": "shared-customXmlSchemaProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlSchemaProperties.xsd"
                },
                {
                  "name": "shared-documentPropertiesCustom.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesCustom.xsd"
                },
                {
                  "name": "shared-documentPropertiesExtended.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesExtended.xsd"
                },
                {
                  "name": "shared-documentPropertiesVariantTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesVariantTypes.xsd"
                },
                {
                  "name": "shared-math.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-math.xsd"
                },
                {
                  "name": "shared-relationshipReference.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-relationshipReference.xsd"
                },
                {
                  "name": "sml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/sml.xsd"
                },
                {
                  "name": "vml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-main.xsd"
                },
                {
                  "name": "vml-officeDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-officeDrawing.xsd"
                },
                {
                  "name": "vml-presentationDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-presentationDrawing.xsd"
                },
                {
                  "name": "vml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "vml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "wml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/wml.xsd"
                },
                {
                  "name": "xml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/xml.xsd"
                }
              ]
            },
            {
              "name": "mce",
              "type": "dir",
              "path": "ooxml/schemas/mce",
              "children": [
                {
                  "name": "mc.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/mce/mc.xsd"
                }
              ]
            },
            {
              "name": "microsoft",
              "type": "dir",
              "path": "ooxml/schemas/microsoft",
              "children": [
                {
                  "name": "wml-2010.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2010.xsd"
                },
                {
                  "name": "wml-2012.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2012.xsd"
                },
                {
                  "name": "wml-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2018.xsd"
                },
                {
                  "name": "wml-cex-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cex-2018.xsd"
                },
                {
                  "name": "wml-cid-2016.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cid-2016.xsd"
                },
                {
                  "name": "wml-sdtdatahash-2020.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-sdtdatahash-2020.xsd"
                },
                {
                  "name": "wml-symex-2015.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-symex-2015.xsd"
                }
              ]
            }
          ]
        },
        {
          "name": "scripts",
          "type": "dir",
          "path": "ooxml/scripts",
          "children": [
            {
              "name": "validation",
              "type": "dir",
              "path": "ooxml/scripts/validation",
              "children": [
                {
                  "name": "__init__.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/__init__.py"
                },
                {
                  "name": "base.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/base.py"
                },
                {
                  "name": "docx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/docx.py"
                },
                {
                  "name": "pptx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/pptx.py"
                },
                {
                  "name": "redlining.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/redlining.py"
                }
              ]
            },
            {
              "name": "pack.py",
              "type": "file",
              "path": "ooxml/scripts/pack.py"
            },
            {
              "name": "unpack.py",
              "type": "file",
              "path": "ooxml/scripts/unpack.py"
            },
            {
              "name": "validate.py",
              "type": "file",
              "path": "ooxml/scripts/validate.py"
            }
          ]
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "templates",
          "type": "dir",
          "path": "scripts/templates",
          "children": [
            {
              "name": "comments.xml",
              "type": "file",
              "path": "scripts/templates/comments.xml"
            },
            {
              "name": "commentsExtended.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtended.xml"
            },
            {
              "name": "commentsExtensible.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtensible.xml"
            },
            {
              "name": "commentsIds.xml",
              "type": "file",
              "path": "scripts/templates/commentsIds.xml"
            },
            {
              "name": "people.xml",
              "type": "file",
              "path": "scripts/templates/people.xml"
            }
          ]
        },
        {
          "name": "__init__.py",
          "type": "file",
          "path": "scripts/__init__.py"
        },
        {
          "name": "document.py",
          "type": "file",
          "path": "scripts/document.py"
        },
        {
          "name": "utilities.py",
          "type": "file",
          "path": "scripts/utilities.py"
        }
      ]
    },
    {
      "name": "docx-js.md",
      "type": "file",
      "path": "docx-js.md"
    },
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "ooxml.md",
      "type": "file",
      "path": "ooxml.md"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}