{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-02T00:45:07.612Z",
    "slug": "wshobson-mtls-configuration",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/cloud-infrastructure/skills/mtls-configuration",
    "source_ref": "main",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community"
  },
  "skill": {
    "name": "mtls-configuration",
    "description": "Configure mutual TLS (mTLS) for zero-trust service-to-service communication. Use when implementing zero-trust networking, certificate management, or securing internal service communication.",
    "summary": "Configure mutual TLS (mTLS) for zero-trust service-to-service communication. Use when implementing z...",
    "icon": "üîê",
    "version": "1.0.0",
    "license": "MIT",
    "category": "security",
    "tags": [
      "mtls",
      "zero-trust",
      "istio",
      "linkerd",
      "certificates"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "No code execution, data access, or network calls are present. The content is documentation and configuration templates only.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 347,
    "audit_model": "codex",
    "audited_at": "2026-01-02T00:45:07.612Z"
  },
  "content": {
    "user_title": "Configure mTLS across service meshes",
    "value_statement": "Service-to-service traffic lacks strong identity and encryption. This skill provides clear mTLS templates and checks for secure zero-trust traffic.",
    "seo_keywords": [
      "mTLS configuration",
      "Istio mTLS",
      "Linkerd mTLS",
      "SPIFFE SPIRE",
      "cert-manager",
      "zero trust networking",
      "Claude",
      "Codex",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Provide Istio PeerAuthentication and DestinationRule templates",
      "Outline cert-manager issuer and certificate setup for Istio",
      "Describe SPIFFE and SPIRE integration steps",
      "List Linkerd mTLS verification and policy examples",
      "Share rotation and debugging command sequences"
    ],
    "limitations": [
      "Does not execute commands or apply manifests",
      "Does not generate real certificates or keys",
      "Focuses on Istio, Linkerd, and SPIRE only",
      "Does not validate cluster-specific policies"
    ],
    "use_cases": [
      {
        "target_user": "Platform engineer",
        "title": "Enforce mesh-wide mTLS",
        "description": "Set strict mTLS defaults and safe migration steps for production clusters."
      },
      {
        "target_user": "Security engineer",
        "title": "Design zero-trust certificates",
        "description": "Plan CA hierarchy, rotations, and SPIFFE identities for workloads."
      },
      {
        "target_user": "DevOps engineer",
        "title": "Troubleshoot mTLS failures",
        "description": "Check peer auth, destination rules, and proxy logs for TLS issues."
      }
    ],
    "prompt_templates": [
      {
        "title": "Enable Istio mTLS",
        "scenario": "New mesh with strict mTLS",
        "prompt": "Provide Istio PeerAuthentication and DestinationRule templates to enable mesh-wide strict mTLS with one permissive namespace."
      },
      {
        "title": "Cert-manager setup",
        "scenario": "Issue workload certificates",
        "prompt": "Show a cert-manager ClusterIssuer and Certificate for a service in a namespace using Istio CA."
      },
      {
        "title": "SPIRE integration",
        "scenario": "SPIFFE identities in Kubernetes",
        "prompt": "Outline SPIRE server and agent configuration needed for SPIFFE-based mTLS in Kubernetes."
      },
      {
        "title": "Debug mTLS",
        "scenario": "Handshake errors in mesh",
        "prompt": "List commands to verify mTLS status, peer auth, destination rules, and proxy TLS logs for a failing service."
      }
    ],
    "output_examples": [
      {
        "input": "I need strict mTLS for Istio with a permissive legacy namespace",
        "output": [
          "Mesh default PeerAuthentication set to STRICT in istio-system",
          "Legacy namespace PeerAuthentication set to PERMISSIVE",
          "DestinationRule enforces ISTIO_MUTUAL for internal traffic"
        ]
      }
    ],
    "best_practices": [
      "Start with PERMISSIVE for migration, then move to STRICT",
      "Use short-lived workload certificates and monitor expiry",
      "Rotate CAs on a defined schedule with rollback plans"
    ],
    "anti_patterns": [
      "Disabling mTLS in production for convenience",
      "Using self-signed certs without a CA hierarchy",
      "Skipping certificate chain verification"
    ],
    "faq": [
      {
        "question": "Is this compatible with Claude, Codex, and Claude Code?",
        "answer": "Yes. It is plain guidance and templates that any assistant can apply."
      },
      {
        "question": "What are the main limits of this skill?",
        "answer": "It does not apply manifests or generate certificates in your environment."
      },
      {
        "question": "Can I integrate this with cert-manager?",
        "answer": "Yes. It includes ClusterIssuer and Certificate examples for cert-manager."
      },
      {
        "question": "Does it access or send my data?",
        "answer": "No. It contains only static documentation and configuration templates."
      },
      {
        "question": "What should I do if mTLS fails to connect?",
        "answer": "Check peer auth, destination rules, and proxy logs with the listed commands."
      },
      {
        "question": "How does this compare to a generic TLS guide?",
        "answer": "It focuses on service mesh mTLS with Istio, Linkerd, and SPIRE examples."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}