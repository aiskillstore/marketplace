# Stack Analyzer Recommendations Configuration
#
# This file defines which skills to activate or scaffold based on detected stack.
#
# Structure:
# - activate_skills: Generic skills that exist in the plugin (activate only)
# - scaffold_templates: Project-specific skills to create in target repo

# =============================================================================
# GENERIC SKILLS TO ACTIVATE
# =============================================================================
# These skills already exist in plugins/ai-dev-kit/skills/
# They are framework-generic and work with any codebase using that technology.

activate_skills:
  # BAML Integration
  # Activates for any project using BAML for type-safe LLM prompting
  baml-integration:
    detect:
      files:
        - "baml_src/**/*.baml"
        - "baml/**/*.baml"
      dependencies:
        - "baml-py"
        - "baml"
        - "@boundaryml/baml"
    priority: high
    description: "Generic BAML patterns for type-safe LLM prompting"

  # Supabase Patterns
  # Activates for any project using Supabase for backend
  supabase-patterns:
    detect:
      files:
        - "supabase/migrations/**"
        - "supabase/config.toml"
      dependencies:
        - "supabase"
        - "@supabase/supabase-js"
        - "supabase-py"
    priority: high
    description: "General Supabase best practices (RLS, realtime, storage)"

  # Schema Alignment
  # Activates for any project with database ORM
  schema-alignment:
    detect:
      files:
        - "alembic/**"
        - "migrations/**"
        - "prisma/schema.prisma"
        - "**/models/*.py"
      dependencies:
        - "sqlalchemy"
        - "alembic"
        - "prisma"
        - "@prisma/client"
        - "django"
        - "typeorm"
        - "sequelize"
        - "drizzle-orm"
    priority: high
    description: "Database/code drift detection (works with any ORM)"

  # Tree-sitter Patterns
  # Activates for projects using tree-sitter for code parsing
  treesitter-patterns:
    detect:
      files:
        - "**/tree_sitter/**"
        - "**/queries/*.scm"
      dependencies:
        - "tree-sitter"
        - "tree_sitter"
        - "tree-sitter-python"
        - "tree-sitter-typescript"
    priority: medium
    description: "Universal language parsing patterns"

  # Security Audit
  # Always recommended for production codebases
  security-audit:
    detect:
      always: true
      except_if_files:
        - ".security-exempt"
    priority: low
    description: "Common vulnerability detection (SQL injection, bare excepts, etc.)"

  # MCP Patterns
  # For projects building or using MCP servers
  mcp-patterns:
    detect:
      files:
        - "**/*mcp*.py"
        - "**/*mcp*.ts"
        - ".mcp.json"
      dependencies:
        - "mcp"
        - "@modelcontextprotocol/sdk"
        - "mcp-python"
    priority: medium
    description: "Model Context Protocol server patterns"

  # FastAPI Patterns
  # For Python backend projects using FastAPI
  fastapi-patterns:
    detect:
      files:
        - "**/routes/**/*.py"
        - "**/routers/**/*.py"
        - "**/api/**/*.py"
      dependencies:
        - "fastapi"
        - "uvicorn"
    priority: medium
    description: "FastAPI endpoint patterns and middleware"

  # React Patterns
  # For frontend projects using React
  react-patterns:
    detect:
      files:
        - "src/components/**/*.tsx"
        - "src/components/**/*.jsx"
        - "app/**/*.tsx"
      dependencies:
        - "react"
        - "react-dom"
        - "next"
    priority: medium
    description: "React component patterns and hooks"

# =============================================================================
# PROJECT-SPECIFIC SKILLS TO SCAFFOLD
# =============================================================================
# These are templates that get customized and placed in the target repo.
# They persist after plugin uninstall and are tracked in _generated.json.

scaffold_templates:
  # Research Patterns
  # For projects with research-oriented AI subagents
  project-research:
    detect:
      files:
        - ".claude/commands/**/research/**"
        - ".claude/agents/**research**.md"
        - "baml_src/**research**.baml"
      patterns:
        - "subagent.*research"
        - "research.*agent"
    template_dir: "templates/project-research"
    output_pattern: ".claude/skills/{project}-research/"
    description: "Research workflow patterns specific to this project"

  # Domain Vocabulary
  # For projects with rich domain models
  project-domain:
    detect:
      files:
        - "src/models/**/*.py"
        - "src/models/**/*.ts"
        - "services/domain/**"
        - "domain/**/*.py"
        - "baml_src/types/**"
    min_files: 5
    template_dir: "templates/project-domain"
    output_pattern: ".claude/skills/{project}-domain/"
    description: "Domain vocabulary and entity relationships for this project"

  # Custom Testing
  # For projects with non-standard testing requirements
  project-testing:
    detect:
      files:
        - "tests/fixtures/**"
        - "tests/e2e/**"
        - "tests/integration/**"
        - "playwright/**"
      dependencies:
        - "playwright"
        - "@playwright/test"
        - "cypress"
    min_files: 10
    template_dir: "templates/project-testing"
    output_pattern: ".claude/skills/{project}-testing/"
    description: "Custom test patterns and fixtures for this project"

  # API Documentation
  # For projects with extensive API surface
  project-api:
    detect:
      files:
        - "openapi/**"
        - "specs/api/**"
        - "**/swagger.json"
        - "**/openapi.yaml"
      dependencies:
        - "openapi"
        - "@redocly/cli"
    template_dir: "templates/project-api"
    output_pattern: ".claude/skills/{project}-api/"
    description: "API patterns and documentation for this project"

# =============================================================================
# SKILL PRIORITY WEIGHTS
# =============================================================================
# Used to order recommendations in the report

priority_weights:
  high: 3
  medium: 2
  low: 1

# =============================================================================
# OUTPUT SETTINGS
# =============================================================================

output:
  manifest_path: ".claude/skills/_generated.json"
  report_format: "markdown"
  include_inactive_recommendations: true
  show_detection_details: true
