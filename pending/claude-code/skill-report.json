{
  "meta": {
    "generated_at": "2025-12-29T08:41:52Z",
    "model": "gpt-5.2:high",
    "source_url": "https://github.com/anthropics/claude-code",
    "source_ref": "d213a74fc8e3b6efded52729196e0c2d4c3abb3e",
    "analysis_version": "2.0.0"
  },
  "security_audit": {
    "risk_level": "safe",
    "should_block": false,
    "safe_to_publish": true,
    "summary": "The repository contains a single Markdown documentation file (SKILL.md) describing how to write Hookify rules. It includes no executable code, no network logic, and no filesystem access routines. The only shell snippet shown is an optional local regex-testing command; there are no mechanisms for data exfiltration, persistence, payload download/execute, or covert communications.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "category": "Deceptive Behaviors / Social Engineering Surface",
        "description": "Documentation provides examples of patterns to match dangerous commands (e.g., rm -rf, sudo), but does not execute them. The included example shell/python one-liner is benign and intended for local regex testing; risk is limited to user misuse if they copy/paste without understanding."
      }
    ],
    "files_analyzed": 1,
    "dangerous_patterns_found": [
      {
        "pattern_type": "Example-only dangerous command strings",
        "examples": [
          "rm\\s+-rf",
          "sudo\\s+",
          "chmod\\s+777",
          "dd\\s+if=",
          "mkfs"
        ],
        "context": "These appear only as documentation examples for Hookify rule matching, not as executed commands."
      }
    ],
    "files_scanned": 1,
    "total_lines": 374
  },
  "content": {
    "user_title": "Create Hookify Rules to Catch Risky Changes Early",
    "value_statement": "Teams often miss risky commands or insecure code patterns until review or production. This skill helps you write clear Hookify rules (simple regex or multi-condition) that warn or block on specific bash/file/prompt/stop events.",
    "seo_keywords": [
      "Hookify rules",
      "Claude Code",
      "Anthropic Claude",
      "regex pattern matching",
      "pre-commit safety",
      "DevSecOps guardrails",
      "CI checklist automation",
      "bash command blocking",
      "VS Code workflow",
      "GitHub repository hygiene"
    ],
    "actual_capabilities": [
      "Explains Hookify rule file structure (YAML frontmatter + markdown message body)",
      "Guides choosing events (bash, file, stop, prompt, all) and writing match patterns",
      "Provides advanced multi-condition rule syntax (field/operator/pattern) for precise triggers",
      "Offers practical regex tips, pitfalls, and local testing method for patterns",
      "Recommends rule naming, storage location, and gitignore practices for local rules"
    ],
    "limitations": [
      "Does not execute or validate rules automatically; it documents how to author them",
      "Cannot inspect your repository or enforce policies by itself without Hookify reading the rule files",
      "Examples are illustrative; you must tailor patterns/conditions to your project conventions",
      "No guarantee of perfect detection—regex-based rules can have false positives/negatives"
    ],
    "use_cases": [
      {
        "target_user": "Security-conscious developers",
        "title": "Block dangerous shell commands",
        "description": "Create bash-event rules that block or warn on high-risk commands (e.g., rm -rf, chmod 777, sudo usage) before they run."
      },
      {
        "target_user": "Frontend/backend teams",
        "title": "Prevent insecure code patterns",
        "description": "Write file-event rules to flag eval, innerHTML assignments, or debug statements (console.log/debugger) when editing source files."
      },
      {
        "target_user": "Tech leads and maintainers",
        "title": "Standardize completion checklists",
        "description": "Use stop-event rules to remind contributors to run tests, update docs, and verify builds before ending an agent session."
      }
    ],
    "prompt_templates": [
      {
        "name": "Beginner: warn on console.log",
        "prompt": "Write a Hookify rule that warns (not blocks) when I add `console.log(` to any `.ts` or `.tsx` file. Include a short message with alternatives.",
        "expected_output": "A `.claude/hookify.console-log.local.md` rule with file event conditions and a helpful markdown warning."
      },
      {
        "name": "Intermediate: block rm -rf",
        "prompt": "Create a Hookify rule to block bash commands that contain `rm -rf` (including extra whitespace variations). Provide a safer alternative message.",
        "expected_output": "A bash-event rule using a regex like `rm\\s+-rf` and `action: block` plus guidance in the message body."
      },
      {
        "name": "Advanced: sensitive .env edits",
        "prompt": "Write an advanced Hookify rule that triggers only when editing a `.env` file AND the new text contains `API_KEY` or `SECRET`. Warn to ensure `.env` is gitignored.",
        "expected_output": "A multi-condition file-event rule matching `file_path` and `new_text` content checks."
      },
      {
        "name": "Expert: process enforcement on stop",
        "prompt": "Create a stop-event Hookify rule that always triggers and shows a completion checklist (tests, lint, build, docs). Keep it concise and team-friendly.",
        "expected_output": "A stop-event rule with `pattern: .*` and a markdown checklist message."
      }
    ],
    "output_examples": [
      {
        "title": "Example Hookify rule (file event with conditions)",
        "description": "Generates a ready-to-drop-in markdown rule file with YAML frontmatter (name/enabled/event/conditions) and a clear warning message tailored to your pattern (e.g., `.env` + `API_KEY`)."
      }
    ],
    "best_practices": [
      "Prefer multi-condition rules (file_path + new_text) to reduce false positives",
      "Keep regex unquoted in YAML when possible to avoid escaping issues",
      "Store rules as `.claude/hookify.{descriptive-name}.local.md` and add `.claude/*.local.md` to `.gitignore`"
    ],
    "anti_patterns": [
      "Using overly broad patterns like `log` that match unrelated text (e.g., login/dialog)",
      "Hard-coding exact command strings/paths that miss common variations (whitespace, flags, directories)",
      "Triggering on all files/events when you only need a narrow scope (increases noise and rule fatigue)"
    ],
    "faq": [
      {
        "q": "What is this skill compatible with?",
        "a": "It’s documentation for authoring Hookify rule markdown files used by Claude/Hookify-style workflows; it does not depend on a specific language runtime."
      },
      {
        "q": "Does it run commands or change my files automatically?",
        "a": "No. It only describes rule syntax and recommended file placement; Hookify (or your tooling) must load and enforce the rules."
      },
      {
        "q": "How does it integrate with my repo?",
        "a": "Create files like `.claude/hookify.{name}.local.md` in your project root and (optionally) add `.claude/*.local.md` to `.gitignore` for local-only rules."
      },
      {
        "q": "Is it safe with sensitive data?",
        "a": "Yes—there is no executable code, no networking, and no file-reading behavior in the repository; it contains only written guidance and examples."
      },
      {
        "q": "My rule doesn’t trigger—how do I troubleshoot?",
        "a": "Verify the `event` matches the tool action, confirm `enabled: true`, and test the regex locally (e.g., with a Python `re.search`) against representative text."
      },
      {
        "q": "How is this different from pre-commit hooks or linters?",
        "a": "Hookify rules are lightweight pattern-based guardrails that can trigger on multiple event types (bash/file/prompt/stop); linters are language-aware and typically run at commit/build time."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "A Hookify-capable runner/tooling that reads `.claude/hookify.*.local.md` files (not included in this repo)"
      ],
      "permissions_needed": [
        "Read access to the rule files by your Hookify/agent tooling",
        "Optional: ability to create/edit files under `.claude/` in your repository"
      ],
      "estimated_complexity": "low",
      "setup_time_minutes": 5
    }
  }
}
