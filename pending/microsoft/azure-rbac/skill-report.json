{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-02-21T08:39:38.295Z",
    "slug": "microsoft-azure-rbac",
    "source_url": "https://github.com/microsoft/github-copilot-for-azure/tree/main/plugin/skills/azure-rbac/",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "7e25510bb3c50de0ac26cc60b2a1aa5cee74ce8c344adaaa25989ced7d761a72",
    "tree_hash": "9ef290db95c5b934564d884a62a0cae1a920409ab0d37df16b9678c6f604b3e5"
  },
  "skill": {
    "name": "azure-rbac",
    "description": "Helps users find the right Azure RBAC role for an identity with least privilege access, then generate CLI commands and Bicep code to assign it. USE FOR: \"what role should I assign\", \"least privilege role\", \"RBAC role for\", \"role to read blobs\", \"role for managed identity\", \"custom role definition\", \"assign role to identity\". DO NOT USE FOR: creating or configuring managed identities, or general Azure security hardening; those are out of scope for this role-selection skill.",
    "summary": "Find the right Azure RBAC role for least privilege access and generate CLI and Bicep code to assign it",
    "icon": "ðŸ“¦",
    "version": "1.0.0",
    "author": "microsoft",
    "license": "MIT",
    "tags": [
      "azure",
      "rbac",
      "access-control",
      "security",
      "bicep"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Static analysis flagged 4 instances of 'Weak cryptographic algorithm' at SKILL.md lines 3 and 8. These are FALSE POSITIVES. Line 3 contains YAML syntax (description: >-) for multiline strings. Line 8 references Azure MCP tools (azure__documentation, azure__extension_cli_generate). The skill is a legitimate Microsoft Azure RBAC helper that recommends least-privilege roles and generates infrastructure code.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [
      {
        "title": "Weak Cryptographic Algorithm (False Positive)",
        "description": "Static scanner incorrectly flagged YAML multiline syntax and tool references as cryptographic patterns. Line 3 'description: >-' is YAML folded scalar syntax. Line 8 'azure__documentation' references Azure MCP tools.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 3,
            "line_end": 3
          },
          {
            "file": "SKILL.md",
            "line_start": 8,
            "line_end": 8
          }
        ],
        "confidence": 0.95,
        "confidence_reasoning": "Pattern found is YAML syntax and tool name references - no cryptographic operations present in this 9-line skill definition file"
      }
    ],
    "files_scanned": 1,
    "total_lines": 9,
    "audit_model": "claude",
    "audited_at": "2026-02-21T08:39:38.295Z",
    "risk_factors": [],
    "risk_factor_evidence": []
  },
  "content": {
    "user_title": "Assign Azure RBAC Roles with Least Privilege",
    "value_statement": "This skill helps Azure administrators find the minimal RBAC role needed for specific permissions and generates the CLI commands and Bicep code to assign it securely.",
    "seo_keywords": [
      "Azure RBAC",
      "role assignment",
      "least privilege access",
      "Azure security",
      "Bicep code generation",
      "Azure CLI",
      "custom role definition",
      "Claude Code",
      "Codex",
      "Claude"
    ],
    "actual_capabilities": [
      "Find the minimal built-in Azure RBAC role for specific permissions",
      "Generate Azure CLI commands to assign roles to identities",
      "Create custom role definitions when built-in roles do not match requirements",
      "Produce Bicep code snippets for infrastructure-as-code deployments",
      "Recommend least-privilege roles for managed identities and service principals"
    ],
    "limitations": [
      "Does not create or configure managed identities",
      "Does not perform general Azure security hardening",
      "Does not audit existing role assignments",
      "Does not support Azure AD Privileged Identity Management"
    ],
    "use_cases": [
      {
        "title": "Grant read access to blob storage",
        "description": "Find the minimal role needed for a service principal to read blobs in a specific storage account",
        "target_user": "Azure administrators managing storage access"
      },
      {
        "title": "Create custom role for API permissions",
        "description": "Define a custom RBAC role with specific API permissions when built-in roles are too broad",
        "target_user": "Security architects implementing fine-grained access"
      },
      {
        "title": "Automate role assignment in CI/CD",
        "description": "Generate Bicep code for role assignments that can be deployed via Azure DevOps or GitHub Actions",
        "target_user": "DevOps engineers automating infrastructure"
      }
    ],
    "prompt_templates": [
      {
        "title": "Find role for storage read",
        "prompt": "What is the minimum RBAC role needed to read blobs in an Azure Storage account?",
        "scenario": "User needs to grant read access to storage blobs"
      },
      {
        "title": "Role for managed identity",
        "prompt": "What RBAC role should I assign to a managed identity so it can list virtual machines in a resource group?",
        "scenario": "User configuring managed identity permissions"
      },
      {
        "title": "Generate role assignment CLI",
        "prompt": "Generate the Azure CLI command to assign the Storage Blob Data Reader role to a user-assigned managed identity on a storage account.",
        "scenario": "User wants CLI command for role assignment"
      },
      {
        "title": "Create custom role definition",
        "prompt": "Create a custom RBAC role definition that allows read and list on storage containers and blobs, but not delete or write operations.",
        "scenario": "User needs custom role with specific permissions"
      }
    ],
    "output_examples": [
      {
        "input": "What role should I assign for a managed identity to read blobs?",
        "output": [
          "Storage Blob Data Reader (preview) is the recommended built-in role for read-only access to blob storage.",
          "Resource scope: The role can be assigned at storage account, container, or blob level.",
          "For least privilege, assign at the specific container level rather than the entire storage account."
        ]
      },
      {
        "input": "Generate Bicep code to assign a role to a service principal",
        "output": [
          "resource roleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {\n  name: guid(subscription().id, servicePrincipalId, roleDefinitionId)\n  properties: {\n    principalId: servicePrincipalId\n    roleDefinitionId: roleDefinitionId\n    principalType: 'ServicePrincipal'\n  }\n}"
        ]
      }
    ],
    "best_practices": [
      "Always assign roles at the narrowest scope possible (resource or resource group vs subscription)",
      "Use built-in roles when possible instead of custom roles for easier maintenance",
      "Document the business justification for each role assignment"
    ],
    "anti_patterns": [
      "Assigning Owner or Contributor roles when more specific roles are available",
      "Assigning roles at subscription or management group scope when resource-level scope would suffice",
      "Using wildcard (*) permissions in custom role definitions"
    ],
    "faq": [
      {
        "question": "What is the difference between Storage Blob Data Reader and Storage Blob Data Owner?",
        "answer": "Storage Blob Data Reader provides read-only access to blobs and containers. Storage Blob Data Owner provides full access including write, delete, and set ACL permissions. Always use Reader for least privilege."
      },
      {
        "question": "Can I assign RBAC roles to managed identities?",
        "answer": "Yes, you can assign RBAC roles to both user-assigned and system-assigned managed identities. Use the principalId of the managed identity in the role assignment."
      },
      {
        "question": "How do I find the role definition ID for a built-in role?",
        "answer": "Use Azure CLI: az role definition list --role-name \"Storage Blob Data Reader\" to get the roleDefinitionId (the fully qualified ID like /providers/Microsoft.Authorization/roleDefinitions/2a2b9908-6bc1-4aae-9c59-2c7b10959305)."
      },
      {
        "question": "What scope should I use for role assignments?",
        "answer": "Use the narrowest scope possible. Assign at resource level for single resources, resource group for multiple resources in the same group, and subscription only when organization-wide access is required."
      },
      {
        "question": "Can this skill help with Azure AD entitlement management?",
        "answer": "No, this skill focuses on RBAC role assignments. Azure AD Privileged Identity Management (PIM) and entitlement management are separate systems and not within scope."
      },
      {
        "question": "How do I audit existing role assignments in my subscription?",
        "answer": "Use Azure CLI: az role assignment list --all --output table to list all assignments, or Azure Resource Graph queries for subscription-wide auditing. This skill does not provide auditing capabilities."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 9
    }
  ]
}
