{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-23T08:08:53.892Z",
    "slug": "jimliu-baoyu-compress-image",
    "source_url": "https://github.com/jimliu/baoyu-skills/tree/main/skills/baoyu-compress-image/",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "bd1ad1d66cbc872dc8f0aa424c1cc6644b72481a3096080bec84226b29a7846a",
    "tree_hash": "9498aec8a45f370f6d629d954b11a2fb4032f48cc32907b26d299ef542d59d79"
  },
  "skill": {
    "name": "baoyu-compress-image",
    "description": "Cross-platform image compression skill. Converts images to WebP by default with PNG-to-PNG support. Uses system tools (sips, cwebp, ImageMagick) with Sharp fallback.",
    "summary": "Compress images to WebP or other formats using system tools or Sharp library",
    "icon": "üóúÔ∏è",
    "version": "1.0.0",
    "author": "jimliu",
    "license": "MIT",
    "tags": [
      "image",
      "compression",
      "webp",
      "optimization",
      "format-conversion"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "external_commands",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Legitimate image compression utility with no security concerns. All static findings are false positives: dynamic import is for lazy-loading Sharp library, child_process spawn uses hardcoded validated arguments for image tools only, template literals were misidentified as shell backticks, and documentation references are not executable code.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "scripts/main.ts",
            "line_start": 83,
            "line_end": 83
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "scripts/main.ts",
            "line_start": 4,
            "line_end": 4
          },
          {
            "file": "scripts/main.ts",
            "line_start": 32,
            "line_end": 32
          },
          {
            "file": "scripts/main.ts",
            "line_start": 55,
            "line_end": 55
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/main.ts",
            "line_start": 1,
            "line_end": 2
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [
      {
        "title": "Dynamic Import for Optional Dependency",
        "description": "Code uses dynamic import() at line 83 to load Sharp library as a fallback compressor when system tools are unavailable.",
        "locations": [
          {
            "file": "scripts/main.ts",
            "line_start": 83,
            "line_end": 83
          }
        ],
        "verdict": "FALSE_POSITIVE",
        "confidence": 0.95,
        "confidence_reasoning": "Dynamic import is for lazy-loading Sharp, a well-known image processing library. Import path is hardcoded, not user-controlled."
      },
      {
        "title": "Child Process Spawn for Image Tools",
        "description": "Code uses child_process.spawn to run system image compression tools (sips, cwebp, convert).",
        "locations": [
          {
            "file": "scripts/main.ts",
            "line_start": 32,
            "line_end": 32
          },
          {
            "file": "scripts/main.ts",
            "line_start": 55,
            "line_end": 55
          }
        ],
        "verdict": "FALSE_POSITIVE",
        "confidence": 0.95,
        "confidence_reasoning": "Spawn arguments are hardcoded or validated against allowlist. No shell=True usage. Commands limited to known image tools."
      }
    ],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 505,
    "audit_model": "claude",
    "audited_at": "2026-01-23T08:08:53.892Z"
  },
  "content": {
    "user_title": "Compress images to WebP with quality control",
    "value_statement": "Large image files slow down websites and waste storage. This skill compresses images to WebP, PNG, or JPEG formats with adjustable quality settings, supporting single files and entire directories.",
    "seo_keywords": [
      "image compression",
      "compress images",
      "WebP converter",
      "image optimizer",
      "reduce image size",
      "Claude Code",
      "Codex",
      "Claude Code skill",
      "image format conversion",
      "photo compression"
    ],
    "actual_capabilities": [
      "Compress images to WebP format (default) with automatic quality optimization",
      "Convert between PNG, JPEG, and WebP formats with preserved transparency",
      "Process directories recursively to compress multiple images at once",
      "Customize output quality from 0-100 for fine-tuned file size control",
      "Auto-detect best available compressor (sips, cwebp, ImageMagick, or Sharp)",
      "Keep original files or replace them with compressed versions"
    ],
    "limitations": [
      "Cannot animate GIF files - only compresses static images (PNG, JPEG, WebP, TIFF)",
      "Requires at least one compressor tool to be installed (sips, cwebp, ImageMagick, or Sharp)",
      "Output quality below 60 may cause visible artifacts on complex images"
    ],
    "use_cases": [
      {
        "title": "Optimize website images for faster loading",
        "description": "Compress screenshots and photos to WebP format to reduce page load times and improve Core Web Vitals scores.",
        "target_user": "Web developers and content creators"
      },
      {
        "title": "Batch process photo collections",
        "description": "Compress entire folders of images with consistent quality settings for storage optimization or sharing.",
        "target_user": "Photographers and digital asset managers"
      },
      {
        "title": "Prepare assets for deployment",
        "description": "Reduce image file sizes before deploying to production, balancing quality and performance requirements.",
        "target_user": "DevOps engineers and CI/CD pipelines"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic image compression",
        "prompt": "Compress this image to WebP format with default quality (80):\n\n${SKILL_DIR}/scripts/main.ts path/to/image.png",
        "scenario": "Quick compression with standard settings"
      },
      {
        "title": "Custom quality compression",
        "prompt": "Compress this image to WebP at 70% quality:\n\n${SKILL_DIR}/scripts/main.ts path/to/image.png -q 70",
        "scenario": "Balanced quality and file size"
      },
      {
        "title": "Batch directory compression",
        "prompt": "Compress all images in this directory recursively with 75% quality:\n\n${SKILL_DIR}/scripts/main.ts ./images/ -r -q 75",
        "scenario": "Processing multiple images"
      },
      {
        "title": "Quality optimization workflow",
        "prompt": "Test different quality levels to find the best compression ratio under 100KB:\n\n${SKILL_DIR}/scripts/main.ts image.png -q 90 --json\n${SKILL_DIR}/scripts/main.ts image.png -q 80 --json\n${SKILL_DIR}/scripts/main.ts image.png -q 70 --json",
        "scenario": "Finding optimal quality settings"
      }
    ],
    "output_examples": [
      {
        "input": "photo.png (2.4MB)",
        "output": "photo.webp (340KB, 86% reduction)"
      },
      {
        "input": "screenshot.png (890KB)",
        "output": "screenshot.webp (156KB, 82% reduction)"
      },
      {
        "input": "./images/ directory (12 files)",
        "output": "12.5MB ‚Üí 4.2MB (66% reduction)"
      }
    ],
    "best_practices": [
      "Test different quality levels with --json output to find optimal settings before batch processing",
      "Use --keep flag when testing new compression settings to preserve originals",
      "Set quality between 70-85 for best balance between file size and visual quality"
    ],
    "anti_patterns": [
      "Using quality below 60 for complex images causes visible artifacts",
      "Compressing already compressed images may increase file size",
      "Running without --json flag when scripting makes parsing results difficult"
    ],
    "faq": [
      {
        "question": "What image formats are supported?",
        "answer": "PNG, JPEG, WebP, GIF, and TIFF files are supported. Animated GIFs are not compressed."
      },
      {
        "question": "Does this replace the original file?",
        "answer": "By default, yes. Use the --keep flag to preserve the original file."
      },
      {
        "question": "What quality setting should I use?",
        "answer": "Quality 80 is the default and works well for most images. Use 70-85 for web images, 90+ for print or high-detail images."
      },
      {
        "question": "Can I process a whole directory?",
        "answer": "Yes. Pass a directory path and use -r for recursive processing through subdirectories."
      },
      {
        "question": "Which compressor is used?",
        "answer": "The skill auto-detects: sips (macOS), cwebp (Google tool), ImageMagick, or Sharp (npm package)."
      },
      {
        "question": "How do I get machine-readable output?",
        "answer": "Use the --json flag for structured output suitable for scripting and automation."
      }
    ]
  },
  "file_structure": [
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "main.ts",
          "type": "file",
          "path": "scripts/main.ts",
          "lines": 316
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 189
    }
  ]
}
