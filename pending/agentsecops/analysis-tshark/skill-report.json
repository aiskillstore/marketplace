{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:14:33.533Z",
    "slug": "agentsecops-analysis-tshark",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/offsec/analysis-tshark",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "322873e3050dffb7765c2b805fb246cbbb076795d3450906eb2f1a3ce2d3ba0e",
    "tree_hash": "6fd333a725e1665d33333bec1c5f01139d9f794a8ffc65a62a048b50cabef03c"
  },
  "skill": {
    "name": "analysis-tshark",
    "description": "Network protocol analyzer and packet capture tool for traffic analysis, security investigations, and forensic examination using Wireshark's command-line interface. Use when: (1) Analyzing network traffic for security incidents and malware detection, (2) Capturing and filtering packets for forensic analysis, (3) Extracting credentials and sensitive data from network captures, (4) Investigating network anomalies and attack patterns, (5) Validating encryption and security controls, (6) Performing protocol analysis for vulnerability research.\n",
    "summary": "Network protocol analyzer and packet capture tool for traffic analysis, security investigations, and...",
    "icon": "ðŸ”",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "proprietary",
    "category": "offsec",
    "tags": [
      "packet-capture",
      "network-analysis",
      "forensics",
      "tshark",
      "wireshark",
      "traffic-analysis"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a prompt-only documentation skill containing no executable code. All content describes legitimate security operations using TShark (Wireshark CLI). The documentation includes proper authorization warnings and defensive considerations. No network calls, file system access, or code execution capabilities exist in this skill.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 5,
    "total_lines": 1823,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:14:33.533Z"
  },
  "content": {
    "user_title": "Analyze network traffic with TShark",
    "value_statement": "Network security professionals need to capture and analyze packet data for incident response and forensic investigations. TShark provides command-line packet analysis capabilities for traffic inspection, credential extraction, malware detection, and protocol analysis without requiring a GUI interface.",
    "seo_keywords": [
      "tshark",
      "network analysis",
      "packet capture",
      "wireshark cli",
      "network forensics",
      "traffic analysis",
      "security investigation",
      "claude",
      "codex",
      "claude-code"
    ],
    "actual_capabilities": [
      "Capture network packets on specified interfaces with capture filters",
      "Apply display filters to analyze captured traffic for security indicators",
      "Extract credentials from HTTP, FTP, NTLM, Kerberos, and email protocols",
      "Export files and objects from packet captures (HTTP, SMB, DICOM, IMF)",
      "Detect malware indicators including C2 beaconing, DNS tunneling, and port scanning",
      "Generate protocol hierarchy statistics and conversation summaries"
    ],
    "limitations": [
      "Requires tshark to be installed on the system (not bundled)",
      "Cannot capture packets without proper system permissions (sudo or wireshark group)",
      "Only provides documentation and guidance, no automated execution of tshark commands",
      "TLS traffic decryption requires access to SSL key logs or private keys"
    ],
    "use_cases": [
      {
        "target_user": "Security analysts",
        "title": "Incident response analysis",
        "description": "Capture and analyze network traffic during security incidents to identify attack patterns and extract indicators of compromise"
      },
      {
        "target_user": "Forensic investigators",
        "title": "Network forensics",
        "description": "Examine packet captures to reconstruct network conversations, extract transmitted files, and document evidence for investigations"
      },
      {
        "target_user": "SOC engineers",
        "title": "Malware traffic detection",
        "description": "Analyze captured traffic to identify C2 beaconing, data exfiltration, and suspicious network behavior from malware"
      }
    ],
    "prompt_templates": [
      {
        "title": "Capture network packets",
        "scenario": "Starting packet capture",
        "prompt": "Use tshark to capture 1000 packets on interface eth0 and save to incident_capture.pcap"
      },
      {
        "title": "Analyze HTTP traffic",
        "scenario": "Examining web traffic",
        "prompt": "Analyze capture.pcap for HTTP requests and show source IP, host, and request URI"
      },
      {
        "title": "Extract credentials",
        "scenario": "Finding authentication data",
        "prompt": "Extract HTTP Basic authentication credentials and FTP usernames/passwords from the packet capture"
      },
      {
        "title": "Detect C2 beaconing",
        "scenario": "Identifying malware patterns",
        "prompt": "Analyze malware_traffic.pcap for C2 beaconing patterns and suspicious DNS queries indicating domain generation algorithms"
      }
    ],
    "output_examples": [
      {
        "input": "Analyze capture.pcap for suspicious traffic",
        "output": [
          "Key findings:",
          "â€¢ 15 unique external IP contacts detected",
          "â€¢ HTTP POST requests with large data transfers (>1MB) to 3 IPs",
          "â€¢ DNS queries with abnormally long domain names (>50 chars) suggesting tunneling",
          "â€¢ 3 connections using suspicious User-Agents (python-requests, curl)",
          "Recommendation: Review the flagged IPs and DNS queries for potential data exfiltration"
        ]
      }
    ],
    "best_practices": [
      "Obtain written authorization before capturing network traffic to ensure legal compliance",
      "Use capture filters (BPF) during capture to reduce file size and focus on relevant traffic",
      "Apply data minimization principles and securely delete capture files per retention policy"
    ],
    "anti_patterns": [
      "Capturing traffic on interfaces without verifying legal authorization",
      "Storing packet captures unencrypted on shared or public systems",
      "Sharing raw packet captures containing sensitive data without proper anonymization"
    ],
    "faq": [
      {
        "question": "What operating systems support tshark?",
        "answer": "TShark runs on Linux, Windows, macOS, and most Unix-like systems. Install via package manager (apt, yum, brew) or from wireshark.org."
      },
      {
        "question": "What are the permission requirements for packet capture?",
        "answer": "Packet capture requires root privileges or membership in the wireshark group. Use sudo or configure setcap for permanent access."
      },
      {
        "question": "Can this skill execute tshark commands?",
        "answer": "No. This skill provides documentation and guidance for using tshark. Users must have tshark installed and run commands themselves."
      },
      {
        "question": "How are sensitive credentials in packet captures protected?",
        "answer": "Treat extracted credentials as highly sensitive. Use encrypted storage, restrict access, and follow data retention and deletion policies."
      },
      {
        "question": "Why am I seeing no interfaces found?",
        "answer": "Verify tshark is installed (tshark --version). Use sudo tshark -D to list interfaces. Check interface status with ip link show."
      },
      {
        "question": "How does this compare to Wireshark GUI?",
        "answer": "TShark provides the same parsing capabilities as Wireshark but via command line. Ideal for headless servers, automation, and remote analysis via SSH."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "ci-config-template.yml",
          "type": "file",
          "path": "assets/ci-config-template.yml"
        },
        {
          "name": "rule-template.yaml",
          "type": "file",
          "path": "assets/rule-template.yaml"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "EXAMPLE.md",
          "type": "file",
          "path": "references/EXAMPLE.md"
        },
        {
          "name": "WORKFLOW_CHECKLIST.md",
          "type": "file",
          "path": "references/WORKFLOW_CHECKLIST.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
