{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:33:35.154Z",
    "slug": "agentsecops-forensics-osquery",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/incident-response/forensics-osquery",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "22bb0c868c78ee15791c5d3891747eb46af4e878332c311370f4a12476bd39f2",
    "tree_hash": "72935399d02962599872c31ef57b7c3a90949a6bea9b484274fda58b8590cdce"
  },
  "skill": {
    "name": "forensics-osquery",
    "description": "SQL-powered forensic investigation and system interrogation using osquery to query operating systems as relational databases. Enables rapid evidence collection, threat hunting, and incident response across Linux, macOS, and Windows endpoints. Use when: (1) Investigating security incidents and collecting forensic artifacts, (2) Threat hunting across endpoints for suspicious activity, (3) Analyzing running processes, network connections, and persistence mechanisms, (4) Collecting system state during incident response, (5) Querying file hashes, user activity, and system configuration for compromise indicators, (6) Building detection queries for continuous monitoring with osqueryd.\n",
    "summary": "SQL-powered forensic investigation and system interrogation using osquery to query operating systems...",
    "icon": "üîç",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "MIT",
    "category": "incident-response",
    "tags": [
      "forensics",
      "osquery",
      "incident-response",
      "threat-hunting",
      "endpoint-detection",
      "dfir",
      "live-forensics",
      "sql"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Pure documentation and configuration skill. Contains SQL query examples and osquery configuration templates for forensic investigation. No executable code, scripts, or network communication capabilities detected.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 10,
    "total_lines": 2870,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:33:35.154Z"
  },
  "content": {
    "user_title": "Query endpoints with SQL for forensics",
    "value_statement": "Investigate security incidents by querying operating systems as databases. Collect forensic evidence, hunt for threats, and analyze processes, persistence, and network activity across Windows, Linux, and macOS.",
    "seo_keywords": [
      "osquery",
      "forensics",
      "incident response",
      "threat hunting",
      "endpoint detection",
      "SQL queries",
      "Claude",
      "Codex",
      "Claude Code",
      "digital forensics"
    ],
    "actual_capabilities": [
      "Query running processes with SQL to detect suspicious activity",
      "Analyze network connections and listening ports across platforms",
      "Detect persistence mechanisms including cron jobs, registry keys, and services",
      "Investigate file modifications and file system changes",
      "Monitor user activity and authentication events",
      "Execute MITRE ATT&CK mapped detection queries"
    ],
    "limitations": [
      "Requires osquery installed on target systems",
      "Cannot perform live memory acquisition",
      "Queries are read-only; no system modification capabilities",
      "Depends on osquery table availability per platform"
    ],
    "use_cases": [
      {
        "target_user": "Incident Responders",
        "title": "Rapid triage collection",
        "description": "Collect system state during active incidents including processes, connections, and persistence"
      },
      {
        "target_user": "Threat Hunters",
        "title": "Indicator of compromise hunting",
        "description": "Search for MITRE ATT&CK techniques using pre-built SQL detection queries"
      },
      {
        "target_user": "Security Analysts",
        "title": "Endpoint investigation",
        "description": "Query file hashes, user activity, and system configuration for compromise indicators"
      }
    ],
    "prompt_templates": [
      {
        "title": "List running processes",
        "scenario": "Get process overview",
        "prompt": "Show me all running processes with their paths, command lines, and user IDs"
      },
      {
        "title": "Find suspicious ports",
        "scenario": "Detect listening services",
        "prompt": "Identify processes listening on non-standard ports and map them to executable paths"
      },
      {
        "title": "Check persistence",
        "scenario": "Find startup mechanisms",
        "prompt": "Find all cron jobs, registry run keys, and services that start automatically"
      },
      {
        "title": "Hunt for malware",
        "scenario": "Detect persistence techniques",
        "prompt": "Detect processes with deleted executables and suspicious memory mappings"
      }
    ],
    "output_examples": [
      {
        "input": "Find processes with network connections to external addresses",
        "output": [
          "Processes with external connections:",
          "  - ssh (PID 1234) connecting to 203.0.113.50:22",
          "  - chrome (PID 5678) connecting to 198.51.100.25:443",
          "  - suspicious (PID 9012) connecting to 192.0.2.100:4444"
        ]
      }
    ],
    "best_practices": [
      "Test queries in a lab environment before production use",
      "Use WHERE clauses to limit query scope and reduce performance impact",
      "Export query results for evidence preservation using JSON or CSV format"
    ],
    "anti_patterns": [
      "Running unbounded queries without filters on production systems",
      "Modifying system state during active investigations",
      "Sharing raw query results containing sensitive data without sanitization"
    ],
    "faq": [
      {
        "question": "Does this skill work offline?",
        "answer": "Yes. All content is local documentation. Queries execute only when osquery is installed and the user runs them."
      },
      {
        "question": "What platforms are supported?",
        "answer": "Linux, macOS, and Windows are fully supported with platform-specific tables and queries."
      },
      {
        "question": "Can queries modify the system?",
        "answer": "No. osquery queries are read-only by design. The skill contains only SELECT statements."
      },
      {
        "question": "Does this skill collect data remotely?",
        "answer": "No. Queries run locally on systems where osquery is installed. No remote data collection occurs."
      },
      {
        "question": "What permissions are required?",
        "answer": "Root or administrator privileges are needed for sensitive tables like kernel_modules and process_memory_map."
      },
      {
        "question": "How does this compare to other tools?",
        "answer": "Osquery uses SQL which is familiar to security analysts. It complements tools like Sysinternals and auditd with cross-platform consistency."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "forensic-packs",
          "type": "dir",
          "path": "assets/forensic-packs",
          "children": [
            {
              "name": "credential-access.conf",
              "type": "file",
              "path": "assets/forensic-packs/credential-access.conf"
            },
            {
              "name": "ir-triage.conf",
              "type": "file",
              "path": "assets/forensic-packs/ir-triage.conf"
            },
            {
              "name": "lateral-movement.conf",
              "type": "file",
              "path": "assets/forensic-packs/lateral-movement.conf"
            },
            {
              "name": "persistence-hunt.conf",
              "type": "file",
              "path": "assets/forensic-packs/persistence-hunt.conf"
            }
          ]
        },
        {
          "name": "osquery.conf",
          "type": "file",
          "path": "assets/osquery.conf"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "mitre-attack-queries.md",
          "type": "file",
          "path": "references/mitre-attack-queries.md"
        },
        {
          "name": "osqueryd-deployment.md",
          "type": "file",
          "path": "references/osqueryd-deployment.md"
        },
        {
          "name": "platform-differences.md",
          "type": "file",
          "path": "references/platform-differences.md"
        },
        {
          "name": "table-guide.md",
          "type": "file",
          "path": "references/table-guide.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
