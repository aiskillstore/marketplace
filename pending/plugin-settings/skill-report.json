{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T09:55:50.806Z",
    "slug": "plugin-settings",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/plugin-settings",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "Plugin Settings",
    "description": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", \"user-configurable plugin\", \".local.md files\", \"plugin state files\", \"read YAML frontmatter\", \"per-project plugin settings\", or wants to make plugin behavior configurable. Documents the .claude/plugin-name.local.md pattern for storing plugin-specific configuration with YAML frontmatter and markdown content.",
    "summary": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", ...",
    "icon": "⚙️",
    "version": "0.1.0",
    "author": "Anthropic",
    "license": "Not specified",
    "category": "development",
    "tags": [
      "plugin-development",
      "configuration",
      "yaml",
      "settings",
      "hooks",
      "state-management"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "OFFICIAL skill from Anthropic with no security concerns. All example code follows security best practices including input validation, path traversal prevention, and safe file operations.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 8,
    "total_lines": 1978,
    "audit_model": "claude",
    "audited_at": "2025-12-30T09:55:50.805Z"
  },
  "content": {
    "user_title": "Plugin Settings Manager",
    "value_statement": "Enables plugin developers to create user-configurable, per-project settings files that control plugin behavior through YAML frontmatter and markdown content.",
    "seo_keywords": [
      "plugin configuration",
      "yaml frontmatter",
      "local settings",
      "hook configuration",
      "plugin state",
      "per-project config",
      "claude code plugins",
      "settings pattern"
    ],
    "actual_capabilities": [
      "Store plugin configuration in .claude/plugin-name.local.md files",
      "Parse YAML frontmatter from bash hooks and scripts",
      "Support both structured config (YAML) and freeform content (markdown)",
      "Enable/disable plugin features per project",
      "Manage agent state and coordination data",
      "Create gitignored, user-local configuration",
      "Validate settings file structure and values",
      "Extract individual fields or markdown body content"
    ],
    "limitations": [
      "Requires Claude Code restart to apply settings changes",
      "Hooks cannot be hot-swapped within a session",
      "Limited to bash parsing techniques (sed, awk, grep)",
      "No built-in schema validation for YAML",
      "Settings are project-specific, not global"
    ],
    "use_cases": [
      {
        "title": "Multi-Agent Coordination",
        "description": "Store agent state including task assignments, PR numbers, dependencies, and coordinator session information for managing multiple agents working on different parts of a project",
        "target_user": "Plugin developers building multi-agent workflows"
      },
      {
        "title": "Configurable Hook Behavior",
        "description": "Control hook activation and validation levels (strict/standard/lenient) without editing hooks.json, allowing temporary activation of security scans or custom validations",
        "target_user": "Developers wanting flexible, project-specific hook configurations"
      },
      {
        "title": "Loop State Management",
        "description": "Track iteration counts, max iterations, and completion promises for plugins that loop Claude's output back as input until a task is complete",
        "target_user": "Plugin developers building iterative automation workflows"
      },
      {
        "title": "Feature Flags and Preferences",
        "description": "Enable/disable experimental features, set notification levels, file size limits, and other user preferences on a per-project basis",
        "target_user": "Plugin users wanting to customize plugin behavior for different projects"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Plugin Settings",
        "prompt": "Create a settings file at .claude/my-plugin.local.md with enabled: true, validation_mode: strict, and max_file_size: 1000000",
        "scenario": "Initial plugin configuration"
      },
      {
        "title": "Parse Settings in Hook",
        "prompt": "Show me how to parse the enabled and strict_mode fields from .claude/my-plugin.local.md in a bash hook",
        "scenario": "Implementing settings-aware hooks"
      },
      {
        "title": "Update State File",
        "prompt": "Update the iteration field in .claude/ralph-loop.local.md from 1 to 2 atomically",
        "scenario": "Incrementing loop counters or updating state"
      },
      {
        "title": "Validate Settings File",
        "prompt": "Validate that .claude/my-plugin.local.md has proper frontmatter structure and required fields",
        "scenario": "Debugging configuration issues"
      }
    ],
    "output_examples": [
      {
        "input": "Create a basic plugin settings file",
        "output": "Created .claude/my-plugin.local.md:\n---\nenabled: true\nmode: standard\nmax_file_size: 1000000\n---\n\n# Plugin Configuration\n\nYour plugin is configured with standard validation mode.\nTo modify settings, edit this file and restart Claude Code."
      },
      {
        "input": "Parse enabled field from settings",
        "output": "FRONTMATTER=$(sed -n '/^---$/,/^---$/{ /^---$/d; p; }' \".claude/my-plugin.local.md\")\nENABLED=$(echo \"$FRONTMATTER\" | grep '^enabled:' | sed 's/enabled: *//')\n\nif [[ \"$ENABLED\" == \"true\" ]]; then\n  # Plugin is enabled\nfi"
      }
    ],
    "best_practices": [
      "Use .claude/plugin-name.local.md naming convention",
      "Add .claude/*.local.md to .gitignore",
      "Implement quick-exit pattern (check file exists before parsing)",
      "Use atomic file updates with temp files when modifying settings",
      "Provide sensible defaults when settings file doesn't exist",
      "Validate field values after parsing (types, ranges, allowed values)",
      "Quote variables in bash scripts to handle special characters",
      "Document that settings changes require Claude Code restart",
      "Use enabled: true/false flag for temporary activation/deactivation",
      "Strip surrounding quotes from YAML values during parsing"
    ],
    "anti_patterns": [
      "Hardcoding absolute paths instead of relative .claude/ paths",
      "Using sed -i for updates instead of atomic temp file + move",
      "Not providing defaults when settings file is missing",
      "Ignoring validation of user input when creating settings",
      "Allowing path traversal in file path settings",
      "Re-parsing the entire file for each field extraction",
      "Not handling empty or null field values",
      "Using unquoted variables in bash scripts",
      "Creating settings files without .local suffix (may be committed)",
      "Not documenting the restart requirement"
    ],
    "faq": [
      {
        "question": "Where should plugin settings files be stored?",
        "answer": "In .claude/plugin-name.local.md within the project root directory. Always use the .local.md suffix and match your plugin name exactly."
      },
      {
        "question": "Do settings changes take effect immediately?",
        "answer": "No, you must restart Claude Code after editing settings files. Hooks cannot be hot-swapped within a session."
      },
      {
        "question": "Should settings files be committed to git?",
        "answer": "No, add .claude/*.local.md to .gitignore. These are user-local, per-project configurations that should not be shared."
      },
      {
        "question": "What's the difference between frontmatter and markdown body?",
        "answer": "YAML frontmatter (between ---) stores structured configuration fields. The markdown body contains freeform content like prompts, documentation, or additional context."
      },
      {
        "question": "How do I parse settings from bash hooks?",
        "answer": "Use sed to extract frontmatter: FRONTMATTER=$(sed -n '/^---$/,/^---$/{ /^---$/d; p; }' \"$FILE\"), then grep specific fields. See parsing-techniques.md for complete examples."
      },
      {
        "question": "Can I use complex YAML structures like nested objects?",
        "answer": "Basic sed/grep parsing supports simple fields, booleans, numbers, and simple lists. For complex structures, consider using yq (YAML processor), but this adds a dependency."
      },
      {
        "question": "What happens if the settings file doesn't exist?",
        "answer": "Your hook/command should exit early (exit 0) or use default values. Always check file existence with [[ ! -f \"$FILE\" ]] before parsing."
      },
      {
        "question": "How do I update settings atomically?",
        "answer": "Write to a temp file, then atomically move: TEMP=\"${FILE}.tmp.$$\"; sed \"s/field: .*/field: $VALUE/\" \"$FILE\" > \"$TEMP\"; mv \"$TEMP\" \"$FILE\""
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "bash (for parsing scripts)",
        "sed, awk, grep (standard Unix utilities)",
        "jq (for JSON construction in hooks)",
        "yq (optional, for complex YAML parsing)"
      ],
      "permissions": [
        "Read access to .claude/ directory",
        "Write access to create/modify .local.md files",
        "Execute permissions for validation scripts"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "create-settings-command.md",
          "type": "file",
          "path": "examples/create-settings-command.md"
        },
        {
          "name": "example-settings.md",
          "type": "file",
          "path": "examples/example-settings.md"
        },
        {
          "name": "read-settings-hook.sh",
          "type": "file",
          "path": "examples/read-settings-hook.sh"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "parsing-techniques.md",
          "type": "file",
          "path": "references/parsing-techniques.md"
        },
        {
          "name": "real-world-examples.md",
          "type": "file",
          "path": "references/real-world-examples.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "parse-frontmatter.sh",
          "type": "file",
          "path": "scripts/parse-frontmatter.sh"
        },
        {
          "name": "validate-settings.sh",
          "type": "file",
          "path": "scripts/validate-settings.sh"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}