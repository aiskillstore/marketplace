{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T09:27:20.809Z",
    "slug": "plugin-settings",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/plugin-settings",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "Plugin Settings",
    "description": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", \"user-configurable plugin\", \".local.md files\", \"plugin state files\", \"read YAML frontmatter\", \"per-project plugin settings\", or wants to make plugin behavior configurable. Documents the .claude/plugin-name.local.md pattern for storing plugin-specific configuration with YAML frontmatter and markdown content.",
    "summary": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", ...",
    "icon": "⚙️",
    "version": "0.1.0",
    "author": "Anthropic",
    "license": "Not specified",
    "category": "development",
    "tags": [
      "configuration",
      "plugins",
      "yaml",
      "settings",
      "state-management",
      "hooks",
      "development-tools"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill providing documentation and examples for plugin configuration patterns. Contains educational bash scripts with proper input validation and security best practices.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 8,
    "total_lines": 1978,
    "audit_model": "claude",
    "audited_at": "2025-12-30T09:27:20.808Z"
  },
  "content": {
    "user_title": "Plugin Settings: Configure Claude Code Plugins Per-Project",
    "value_statement": "Store and manage plugin-specific configuration using YAML frontmatter files, enabling per-project customization without modifying plugin code.",
    "seo_keywords": [
      "plugin configuration",
      "yaml frontmatter",
      "claude code settings",
      "per-project config",
      "hook settings",
      "plugin state management",
      "local settings files"
    ],
    "actual_capabilities": [
      "Store plugin configuration in .claude/plugin-name.local.md files with YAML frontmatter",
      "Parse YAML frontmatter from bash hooks and scripts",
      "Read markdown body content for prompts and additional context",
      "Manage plugin state across sessions",
      "Enable/disable plugins per project",
      "Configure hook behavior without editing hooks.json",
      "Coordinate multi-agent workflows with shared state",
      "Validate settings file structure and values"
    ],
    "limitations": [
      "Changes require Claude Code restart to take effect (hooks cannot be hot-swapped)",
      "Requires bash scripting knowledge to implement parsing in hooks",
      "Files must follow specific naming convention (.claude/*.local.md)",
      "YAML parsing uses sed/grep (basic parsing, not full YAML spec)",
      "Settings files are user-local and should not be committed to git"
    ],
    "use_cases": [
      {
        "title": "Enable/Disable Plugins Per Project",
        "description": "Use an enabled: true/false flag in settings to control whether a plugin's hooks run in specific projects without modifying hooks.json",
        "target_user": "Plugin developers who want per-project activation control"
      },
      {
        "title": "Multi-Agent Coordination",
        "description": "Store agent state (task assignments, PR numbers, coordinator sessions) in settings files to coordinate multiple Claude instances working on different tasks",
        "target_user": "Teams using multi-agent workflows to parallelize development tasks"
      },
      {
        "title": "Configurable Hook Behavior",
        "description": "Store validation modes, file size limits, and other configuration in settings files to customize hook behavior without editing hook scripts",
        "target_user": "Plugin users who need project-specific validation rules or policies"
      },
      {
        "title": "Iterative Loop State Management",
        "description": "Track iteration counts, completion promises, and loop prompts to implement persistent loop behaviors like the ralph-wiggum pattern",
        "target_user": "Developers building autonomous agent loops or iterative workflows"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Plugin Settings File",
        "prompt": "Create a settings file at .claude/my-plugin.local.md with enabled: true, validation_mode: standard, and max_file_size: 1000000. Add it to .gitignore.",
        "scenario": "Initial setup for a plugin that needs per-project configuration"
      },
      {
        "title": "Read and Apply Settings in Hook",
        "prompt": "Show me how to read the enabled flag from .claude/security-check.local.md in a bash hook and skip execution if disabled",
        "scenario": "Implementing settings-aware hook behavior"
      },
      {
        "title": "Parse Configuration Values",
        "prompt": "Parse the validation_level field from .claude/my-plugin.local.md and apply different validation logic based on strict/standard/lenient modes",
        "scenario": "Implementing mode-based plugin behavior"
      },
      {
        "title": "Update State Values",
        "prompt": "Increment the iteration counter in .claude/ralph-loop.local.md atomically using a temp file",
        "scenario": "Managing iterative state across sessions"
      }
    ],
    "output_examples": [
      {
        "input": "Create a basic plugin settings file for my-plugin with enabled and mode fields",
        "output": "```markdown\n---\nenabled: true\nmode: standard\n---\n\n# My Plugin Configuration\n\nPlugin is active in standard mode.\nEdit this file to change settings, then restart Claude Code.\n```"
      },
      {
        "input": "Show me bash code to parse the enabled field",
        "output": "```bash\nFRONTMATTER=$(sed -n '/^---$/,/^---$/{ /^---$/d; p; }' \".claude/my-plugin.local.md\")\nENABLED=$(echo \"$FRONTMATTER\" | grep '^enabled:' | sed 's/enabled: *//')\nif [[ \"$ENABLED\" != \"true\" ]]; then\n  exit 0\nfi\n```"
      }
    ],
    "best_practices": [
      "Always use quick-exit pattern: check file existence first before parsing",
      "Include enabled: true/false flag for explicit activation control",
      "Use atomic updates with temp files (never sed -i) to prevent corruption",
      "Provide sensible defaults when settings file doesn't exist",
      "Add .claude/*.local.md to .gitignore to prevent committing user-local settings",
      "Validate parsed values before using them (check types, ranges, allowed values)",
      "Quote all bash variables to handle spaces and special characters safely",
      "Document that settings changes require Claude Code restart",
      "Use consistent naming: .claude/plugin-name.local.md matching plugin name",
      "Strip surrounding quotes from YAML values to handle both quoted and unquoted formats"
    ],
    "anti_patterns": [
      "Using sed -i for in-place edits (can corrupt files if interrupted)",
      "Hardcoding absolute paths instead of relative .claude/ paths",
      "Not quoting bash variables (breaks with spaces or special characters)",
      "Failing to provide defaults when settings file is missing",
      "Using non-atomic updates that can leave files in inconsistent state",
      "Forgetting to document restart requirement for settings changes",
      "Not validating field values before using them",
      "Assuming exactly 2 --- markers (markdown body can contain ---)",
      "Committing .local.md files to git (should be user-local only)",
      "Not handling missing or empty fields gracefully"
    ],
    "faq": [
      {
        "question": "Why use .local.md instead of .json or .yaml?",
        "answer": "The .local.md format combines structured YAML frontmatter for configuration with markdown body for human-readable content, prompts, or documentation. The .local suffix indicates user-local files that should not be committed to git."
      },
      {
        "question": "Do I need to restart Claude Code after changing settings?",
        "answer": "Yes, hooks are loaded at startup and cannot be hot-swapped. After editing settings files, exit and restart Claude Code for changes to take effect."
      },
      {
        "question": "How do I disable a plugin temporarily?",
        "answer": "Set enabled: false in the settings file and restart Claude Code. The plugin's hooks should check this flag and exit early if disabled."
      },
      {
        "question": "Can I use complex YAML features like lists and nested objects?",
        "answer": "Basic parsing with sed/grep supports simple lists in bracket notation [\"item1\", \"item2\"]. For complex structures, install yq for proper YAML parsing. Keep settings simple for best compatibility."
      },
      {
        "question": "Should settings files be committed to git?",
        "answer": "No, .local.md files are user-local and project-specific. Add .claude/*.local.md to .gitignore. Provide a template in your plugin's README for users to create their own."
      },
      {
        "question": "How do I validate settings file structure?",
        "answer": "Use the provided scripts/validate-settings.sh utility or implement validation in your hooks: check file exists, has frontmatter markers, required fields are present, and values are in valid ranges."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "bash (for parsing scripts)",
        "sed (for frontmatter extraction)",
        "awk (for body extraction)",
        "grep (for field extraction)",
        "jq (optional, for JSON construction)",
        "yq (optional, for advanced YAML parsing)"
      ],
      "permissions": [
        "Read access to .claude/ directory",
        "Write access for creating/updating settings files"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "create-settings-command.md",
          "type": "file",
          "path": "examples/create-settings-command.md"
        },
        {
          "name": "example-settings.md",
          "type": "file",
          "path": "examples/example-settings.md"
        },
        {
          "name": "read-settings-hook.sh",
          "type": "file",
          "path": "examples/read-settings-hook.sh"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "parsing-techniques.md",
          "type": "file",
          "path": "references/parsing-techniques.md"
        },
        {
          "name": "real-world-examples.md",
          "type": "file",
          "path": "references/real-world-examples.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "parse-frontmatter.sh",
          "type": "file",
          "path": "scripts/parse-frontmatter.sh"
        },
        {
          "name": "validate-settings.sh",
          "type": "file",
          "path": "scripts/validate-settings.sh"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}