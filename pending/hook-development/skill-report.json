{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T16:34:13.345Z",
    "slug": "anthropics-hook-development",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/hook-development",
    "source_ref": "main",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "official"
  },
  "skill": {
    "name": "Hook Development",
    "description": "This skill should be used when the user asks to \"create a hook\", \"add a PreToolUse/PostToolUse/Stop hook\", \"validate tool use\", \"implement prompt-based hooks\", \"use ${CLAUDE_PLUGIN_ROOT}\", \"set up event-driven automation\", \"block dangerous commands\", or mentions hook events (PreToolUse, PostToolUse, Stop, SubagentStop, SessionStart, SessionEnd, UserPromptSubmit, PreCompact, Notification). Provides comprehensive guidance for creating and implementing Claude Code plugin hooks with focus on advanced prompt-based hooks API.",
    "summary": "This skill should be used when the user asks to \"create a hook\", \"add a PreToolUse/PostToolUse/Stop ...",
    "icon": "ü™ù",
    "version": "0.1.0",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "hooks",
      "automation",
      "validation",
      "plugins",
      "scripting"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official skill sourced from an Anthropic repository. Minimal audit performed and no security issues identified. Content focuses on safe hook development practices.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 11,
    "total_lines": 2770,
    "audit_model": "codex",
    "audited_at": "2025-12-31T16:34:13.344Z"
  },
  "content": {
    "user_title": "Build Claude Code hooks with confidence",
    "value_statement": "Hook development is complex and easy to misconfigure. This skill gives clear guidance and scripts to validate, test, and lint hooks.",
    "seo_keywords": [
      "Claude",
      "Codex",
      "Claude Code",
      "hook development",
      "PreToolUse",
      "PostToolUse",
      "prompt hooks",
      "hooks.json",
      "plugin automation",
      "bash hooks"
    ],
    "actual_capabilities": [
      "Validate hooks.json structure, event names, hook types, and timeouts",
      "Generate sample test inputs for hook events",
      "Run hook scripts with timeouts and environment setup",
      "Lint hook scripts for safety and best practices",
      "Provide example PreToolUse validation hooks for Bash and Write",
      "Show SessionStart context loading example with env exports"
    ],
    "limitations": [
      "Requires bash and jq to run the scripts",
      "Does not execute or deploy hooks inside Claude Code",
      "Prompt hooks are only supported for specific events",
      "Examples focus on shell scripts, not other languages"
    ],
    "use_cases": [
      {
        "target_user": "Plugin developer",
        "title": "Validate hook configuration",
        "description": "Check hooks.json for correct structure and safe settings before shipping a plugin."
      },
      {
        "target_user": "Security engineer",
        "title": "Enforce safe tool usage",
        "description": "Design PreToolUse rules that block risky commands and sensitive file writes."
      },
      {
        "target_user": "Team lead",
        "title": "Migrate to prompt hooks",
        "description": "Convert legacy command hooks into prompt-based policies with clear criteria."
      }
    ],
    "prompt_templates": [
      {
        "title": "Create a basic hook",
        "scenario": "Need a simple PreToolUse Bash validator",
        "prompt": "Create a PreToolUse hook that blocks rm -rf and asks for sudo. Provide hooks.json and a bash script using jq."
      },
      {
        "title": "Validate file writes",
        "scenario": "Protect sensitive paths in Write tool",
        "prompt": "Write a PreToolUse hook for Write and Edit that denies /etc and /sys, and warns on .env files. Include test steps."
      },
      {
        "title": "Hybrid validation plan",
        "scenario": "Combine fast checks with prompt analysis",
        "prompt": "Design a hybrid PreToolUse hook for Bash with a quick command check and a prompt hook. Include timeouts and rationale."
      },
      {
        "title": "Migration to prompt hooks",
        "scenario": "Replace legacy scripts with prompts",
        "prompt": "Create a migration checklist and new hooks.json to replace command hooks with prompt hooks. Highlight performance and safety."
      }
    ],
    "output_examples": [
      {
        "input": "Create a PreToolUse hook that blocks destructive Bash commands and warns on sudo usage.",
        "output": [
          "Uses a command hook to detect rm -rf, mkfs, and writes to /dev",
          "Returns a deny decision with a clear system message for destructive cases",
          "Flags sudo commands for user confirmation",
          "Includes a 5 to 15 second timeout range and testing steps"
        ]
      }
    ],
    "best_practices": [
      "Use set -euo pipefail and quote all variables",
      "Keep hooks fast and add timeouts per event",
      "Test hooks with sample inputs before deployment"
    ],
    "anti_patterns": [
      "Assuming hooks run in a fixed order",
      "Running long commands that exceed timeouts",
      "Using hardcoded absolute paths without CLAUDE_PLUGIN_ROOT"
    ],
    "faq": [
      {
        "question": "Is this compatible with Claude Code and Codex?",
        "answer": "Yes, it targets Claude Code hooks and uses general shell patterns that Codex users can adapt."
      },
      {
        "question": "What are the main limits of these scripts?",
        "answer": "They require bash and jq, and they only validate inputs and outputs, not full runtime behavior."
      },
      {
        "question": "How do I integrate this into my plugin?",
        "answer": "Add hooks.json entries that call your scripts and validate them using the provided tools."
      },
      {
        "question": "Does it store or transmit my data?",
        "answer": "No, the scripts run locally and do not send data unless you add external integrations."
      },
      {
        "question": "What should I check if a hook fails?",
        "answer": "Verify executable permissions, JSON validity, and exit codes. Then rerun test-hook.sh with verbose mode."
      },
      {
        "question": "How does this compare to custom scripts?",
        "answer": "It provides tested patterns and linting utilities, while custom scripts can add project specific logic."
      }
    ]
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "load-context.sh",
          "type": "file",
          "path": "examples/load-context.sh"
        },
        {
          "name": "validate-bash.sh",
          "type": "file",
          "path": "examples/validate-bash.sh"
        },
        {
          "name": "validate-write.sh",
          "type": "file",
          "path": "examples/validate-write.sh"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "advanced.md",
          "type": "file",
          "path": "references/advanced.md"
        },
        {
          "name": "migration.md",
          "type": "file",
          "path": "references/migration.md"
        },
        {
          "name": "patterns.md",
          "type": "file",
          "path": "references/patterns.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "hook-linter.sh",
          "type": "file",
          "path": "scripts/hook-linter.sh"
        },
        {
          "name": "README.md",
          "type": "file",
          "path": "scripts/README.md"
        },
        {
          "name": "test-hook.sh",
          "type": "file",
          "path": "scripts/test-hook.sh"
        },
        {
          "name": "validate-hook-schema.sh",
          "type": "file",
          "path": "scripts/validate-hook-schema.sh"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}