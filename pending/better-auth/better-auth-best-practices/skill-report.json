{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-23T07:20:18.143Z",
    "slug": "better-auth-better-auth-best-practices",
    "source_url": "https://github.com/better-auth/skills/tree/main/better-auth/best-practices/",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "d67a75a83202355fe76e2db21775cce12e4948189c7b51106989e824bb1da43c",
    "tree_hash": "c7cd712c729822cde9f86416cd0c84fdc05471809361f63fb7cb2d9937115b39"
  },
  "skill": {
    "name": "better-auth-best-practices",
    "description": "Comprehensive reference skill for integrating Better Auth, the TypeScript-first authentication framework. Provides quick access to configuration options, database adapters, session management, security settings, and plugin configurations.",
    "summary": "Quick reference for Better Auth framework integration including config options, security settings, and plugin usage.",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "better-auth",
    "license": "MIT",
    "category": "security",
    "tags": [
      "authentication",
      "better-auth",
      "security",
      "typescript",
      "oauth"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "All 149 static findings are FALSE POSITIVES. This is a documentation-only skill containing markdown reference material. The scanner misinterpreted inline code examples (CLI commands, config snippets) as executable code. No network calls, file system access, or credential handling exists in this skill. Safe for publication.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [
      {
        "title": "External Command Patterns in Documentation",
        "description": "Scanner detected backtick-wrapped code patterns (e.g., `openssl rand`, `npx @better-auth/cli migrate`) and flagged as shell execution. These are inline code examples in markdown documentation, not actual command execution.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 17,
            "line_end": 28
          }
        ],
        "verdict": "FALSE_POSITIVE",
        "confidence": 0.98,
        "confidence_reasoning": "Markdown backticks format code for display. No actual shell execution occurs. The file is pure documentation with zero executable content."
      },
      {
        "title": "Network URL Patterns in Documentation",
        "description": "Scanner detected hardcoded URLs (better-auth.com, GitHub, example.com) as external network calls. These are documentation links, not actual network requests.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 8,
            "line_end": 166
          }
        ],
        "verdict": "FALSE_POSITIVE",
        "confidence": 0.98,
        "confidence_reasoning": "Static documentation links are displayed to users, not programmatically fetched. No fetch/xhr/network code exists in this file."
      },
      {
        "title": "Credential Access Patterns in Documentation",
        "description": "Scanner flagged references to authCookies, password.hash(), and similar terms as credential access. These are documentation mentions of authentication concepts.",
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 95,
            "line_end": 116
          }
        ],
        "verdict": "FALSE_POSITIVE",
        "confidence": 0.95,
        "confidence_reasoning": "Documentation describes authentication configuration options. No actual credential files or secret access occurs in this documentation skill."
      }
    ],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 166,
    "audit_model": "claude",
    "audited_at": "2026-01-23T07:20:18.143Z"
  },
  "content": {
    "user_title": "Set up Better Auth with best practices",
    "value_statement": "Authentication setup requires navigating complex configuration options and security settings. This skill provides quick access to Better Auth's complete reference for environment setup, database adapters, session management, and security configurations.",
    "seo_keywords": [
      "Better Auth",
      "Claude",
      "Codex",
      "Claude Code",
      "authentication",
      "TypeScript auth",
      "OAuth",
      "session management",
      "passkey authentication",
      "two-factor auth"
    ],
    "actual_capabilities": [
      "Generate secure environment variable configurations for Better Auth",
      "Configure database adapters for PostgreSQL, MySQL, MongoDB, SQLite, Prisma, and Drizzle",
      "Set up session management with cookie cache strategies (compact, JWT, JWE)",
      "Configure security settings including secure cookies, CSRF protection, and rate limiting",
      "Implement OAuth providers and social login with Google, GitHub, and other services",
      "Add plugins for two-factor auth, passkeys, magic links, and organizations"
    ],
    "limitations": [
      "This is a reference skill that provides documentation and examples, not executable code generation",
      "Does not create project files or modify local configuration",
      "Does not run database migrations or generate schema files",
      "Requires users to manually implement the configurations in their projects"
    ],
    "use_cases": [
      {
        "title": "New authentication project setup",
        "description": "Quickly configure Better Auth for a new project by retrieving environment variables, database adapter settings, and security configurations.",
        "target_user": "Developers starting new projects with authentication requirements"
      },
      {
        "title": "Security configuration review",
        "description": "Reference security settings like cookie configuration, CSRF protection, and rate limiting when auditing or improving existing auth implementations.",
        "target_user": "Security engineers and code auditors"
      },
      {
        "title": "Plugin integration lookup",
        "description": "Find the correct import paths and configuration options for popular plugins like two-factor, organization, passkey, and magic link authentication.",
        "target_user": "Full-stack developers extending authentication features"
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic configuration help",
        "prompt": "I need to set up Better Auth with {database}. What are the required environment variables and configuration options?",
        "scenario": "Getting started with Better Auth integration"
      },
      {
        "title": "Security settings",
        "prompt": "How do I configure {security_option} in Better Auth? What are the security implications?",
        "scenario": "Configuring specific security features"
      },
      {
        "title": "Plugin configuration",
        "prompt": "How do I add {plugin_name} plugin to Better Auth? Show me the import path and configuration options.",
        "scenario": "Adding authentication plugins"
      },
      {
        "title": "Session management",
        "prompt": "Explain the difference between cookie cache strategies in Better Auth: compact vs JWT vs JWE. When should I use each?",
        "scenario": "Optimizing session handling"
      }
    ],
    "output_examples": [
      {
        "input": "How do I configure Better Auth with Prisma?",
        "output": [
          "Environment: BETTER_AUTH_SECRET (32+ chars), BETTER_AUTH_URL",
          "Database adapter: Import from 'better-auth/adapters/prisma'",
          "Configuration: Pass your Prisma client instance to the database option",
          "Schema: Run 'npx @better-auth/cli@latest generate' to create Prisma schema",
          "Note: Use model names (e.g., 'user'), not table names in config"
        ]
      },
      {
        "input": "What are the security settings I should enable?",
        "output": [
          "Essential: useSecureCookies (HTTPS only)",
          "Rate limiting: enabled with window and max options",
          "CSRF: Keep default protection, avoid disableCSRFCheck",
          "IP headers: Configure ipAddressHeaders for proxy setups",
          "Cookie: Set appropriate expiresIn and updateAge values"
        ]
      }
    ],
    "best_practices": [
      "Always use environment variables for secrets (BETTER_AUTH_SECRET) instead of hardcoding values",
      "Run the CLI migration command after adding or changing plugins to update the schema",
      "Use secondaryStorage (Redis/KV) for sessions in production for better scalability",
      "Choose the appropriate cookie cache strategy: compact for size, JWT for readability, JWE for maximum security"
    ],
    "anti_patterns": [
      "Hardcoding secrets or credentials in configuration files",
      "Using table names instead of ORM model names when configuring adapters",
      "Skipping the CLI migration step after plugin changes",
      "Disabling CSRF or origin checks without understanding the security implications"
    ],
    "faq": [
      {
        "question": "What database adapters does Better Auth support?",
        "answer": "Better Auth supports direct connections to PostgreSQL, MySQL, SQLite (including bun:sqlite), and MongoDB. It also has official adapters for Prisma, Drizzle, and Mongoose."
      },
      {
        "question": "How do I add OAuth providers like Google or GitHub?",
        "answer": "Configure socialProviders in your auth config with your clientId and clientSecret. Import the provider name directly (e.g., google, github) and add it to the plugins array."
      },
      {
        "question": "What is the difference between compact, JWT, and JWE cookie cache?",
        "answer": "Compact uses Base64url with HMAC (smallest size). JWT is standard JSON Web Token (readable but signed). JWE is encrypted JWT (maximum security, larger size). Choose based on your security and size requirements."
      },
      {
        "question": "How do I implement two-factor authentication?",
        "answer": "Add the twoFactor plugin from 'better-auth/plugins/two-factor'. Configure it with emailAndPassword enabled. Users can then set up TOTP authenticators through the authentication flow."
      },
      {
        "question": "Where should I store session data?",
        "answer": "Configure secondaryStorage with Redis or KV store for production. Sessions go to secondaryStorage by default. Set session.storeSessionInDatabase to also persist to your database. Stateless mode works without database when using cookieCache."
      },
      {
        "question": "How do I invalidate all user sessions?",
        "answer": "Change the session.cookieCache.version value in your configuration. This forces all existing sessions to revalidate and effectively logs out all users."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 166
    }
  ]
}
