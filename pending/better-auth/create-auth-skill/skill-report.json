{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-23T08:08:53.574Z",
    "slug": "better-auth-create-auth-skill",
    "source_url": "https://github.com/better-auth/skills/tree/main/better-auth/create-auth/",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "7334700b51f3bc9e52fdacf346d12eb3379fb2a572079784a78782af96714b22",
    "tree_hash": "0bba11fd4b137d3ad820414ec103ad2bf8cbbc01283c1c4065d9709994b4ff36"
  },
  "skill": {
    "name": "create-auth-skill",
    "description": "Skill for creating auth layers in TypeScript/JavaScript apps using Better Auth.",
    "summary": "Add authentication to TypeScript/JavaScript apps using Better Auth framework with plugins and OAuth support.",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "better-auth",
    "license": "MIT",
    "tags": [
      "authentication",
      "better-auth",
      "oauth",
      "security"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Documentation-only skill containing only markdown content. All 112 static findings are false positives: backtick-like Unicode box-drawing characters in decision trees (lines 16-202) were misidentified as shell execution; documentation URLs (lines 10, 63, 210-214) were misidentified as network calls; example .env patterns (line 64) were misidentified as secret access. No executable code, no network calls, no command execution. Safe for publication.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 214,
    "audit_model": "claude",
    "audited_at": "2026-01-23T08:08:53.574Z"
  },
  "content": {
    "user_title": "Add Authentication with Better Auth",
    "value_statement": "Implementing authentication from scratch is complex and error-prone. Better Auth provides a comprehensive, plugin-based authentication framework with built-in OAuth, 2FA, and organization support for TypeScript applications.",
    "seo_keywords": [
      "Claude",
      "Codex",
      "Claude Code",
      "better-auth",
      "authentication",
      "OAuth",
      "TypeScript auth",
      "user authentication",
      "social login"
    ],
    "actual_capabilities": [
      "Generate complete auth configuration for server and client",
      "Set up OAuth providers (Google, GitHub, etc.) with proper callback routing",
      "Configure database adapters for SQLite, PostgreSQL, MySQL, Prisma, Drizzle, MongoDB",
      "Add plugins for 2FA, organizations, admin panels, and enterprise SSO",
      "Implement session management with secure cookies and rate limiting",
      "Create protected routes with session validation on server and client"
    ],
    "limitations": [
      "Does not provide pre-built UI components (users must implement their own forms)",
      "Does not handle database schema creation beyond generating migration files",
      "Does not include email sending infrastructure (requires external service)",
      "Limited to frameworks supported by Better Auth adapters (React, Vue, Svelte, Solid, Express, Next.js, SvelteKit, Hono)"
    ],
    "use_cases": [
      {
        "title": "Add authentication to a new Next.js project",
        "description": "Set up Better Auth in a fresh Next.js application with email/password auth, Google OAuth, and protected routes.",
        "target_user": "Full-stack developers building new React/Next.js applications"
      },
      {
        "title": "Migrate existing auth to Better Auth",
        "description": "Move from custom auth or another library to Better Auth with minimal downtime using incremental migration strategies.",
        "target_user": "Developors modernizing legacy authentication systems"
      },
      {
        "title": "Add enterprise SSO with organization features",
        "description": "Enable SAML/OIDC single sign-on for enterprise customers with team and organization management.",
        "target_user": "Platform engineers building B2B SaaS products"
      }
    ],
    "prompt_templates": [
      {
        "title": "New Project Setup",
        "prompt": "I want to add authentication to my [framework: Next.js/Express/SvelteKit/Hono] project using Better Auth. The project uses [database: PostgreSQL/MySQL/SQLite/Prisma/Drizzle]. Set up email/password auth with Google OAuth. Show me the server config, client config, and route handler code.",
        "scenario": "Starting authentication implementation in a new project"
      },
      {
        "title": "Existing Project Integration",
        "prompt": "I have an existing [framework] project with [database]. How do I integrate Better Auth? Show me how to create auth.ts, auth-client.ts, and the route handler. Also show how to protect my existing routes.",
        "scenario": "Adding auth to an established project"
      },
      {
        "title": "OAuth Provider Configuration",
        "prompt": "Configure Better Auth with [provider: Google/GitHub/Facebook/Apple] OAuth. Show the environment variables needed, the socialProviders config, and how to handle the OAuth callback. Include redirect URI guidance.",
        "scenario": "Setting up social authentication"
      },
      {
        "title": "Plugins and Advanced Features",
        "prompt": "I want to add [plugin: twoFactor/organization/admin/passkey/sso] to my Better Auth setup. Show the server plugin config, client plugin setup, and any required database migrations.",
        "scenario": "Extending auth with advanced features"
      }
    ],
    "output_examples": [
      {
        "input": "Set up Better Auth in my Next.js project with Prisma and Google OAuth",
        "output": [
          "Server config (src/lib/auth.ts):",
          "- Import createAuth, google from better-auth",
          "- Configure database with prismaAdapter",
          "- Add socialProviders with Google client ID/secret",
          "",
          "Client config (src/lib/auth-client.ts):",
          "- Import createAuthClient from better-auth/react",
          "- Pass plugins array to client",
          "",
          "Route handler (app/api/auth/[...all]/route.ts):",
          "- Import toNextJsHandler",
          "- Export GET and POST handlers"
        ]
      },
      {
        "input": "How do I protect a route and check the session on the server?",
        "output": [
          "Server-side session check:",
          "const session = await auth.api.getSession({",
          "  headers: await headers()",
          "})",
          "",
          "If session is null, redirect to /sign-in",
          "Use session.data.user for user info in protected pages"
        ]
      }
    ],
    "best_practices": [
      "Generate a strong BETTER_AUTH_SECRET (32+ characters) using a cryptographically secure random generator",
      "Enable advanced.useSecureCookies in production to ensure cookies are only sent over HTTPS",
      "Configure trustedOrigins with all your production domains to prevent origin validation errors",
      "Re-run CLI migrate or generate commands whenever you add or update plugins"
    ],
    "anti_patterns": [
      "Do not disable CSRF protection unless you fully understand the security implications",
      "Do not use hardcoded secrets in auth config; always use environment variables",
      "Do not skip email verification for production applications handling sensitive user data",
      "Do not forget to re-run database migrations after adding new plugins"
    ],
    "faq": [
      {
        "question": "What databases does Better Auth support?",
        "answer": "Better Auth supports built-in Kysely with SQLite, PostgreSQL, MySQL, plus adapters for Prisma, Drizzle, and MongoDB. Pass your database instance or pool directly to the auth config."
      },
      {
        "question": "Can I use Better Auth with multiple OAuth providers?",
        "answer": "Yes. Add multiple providers to the socialProviders object in your auth config. Each provider requires its own client ID and secret environment variables."
      },
      {
        "question": "How do I implement protected routes?",
        "answer": "Check the session on the server using auth.api.getSession with headers. If the session is null, redirect to your sign-in page. On the client, use the useSession hook."
      },
      {
        "question": "What plugins are available?",
        "answer": "Official plugins include twoFactor (2FA), organization (teams), admin (user management), bearer (API tokens), openAPI (API docs), passkey (WebAuthn), and sso (enterprise SAML/OIDC)."
      },
      {
        "question": "Do I need to run migrations when adding plugins?",
        "answer": "Yes. After adding any plugin, run npx @better-auth/cli@latest migrate (for Kysely) or regenerate your schema (for Prisma/Drizzle) and apply migrations."
      },
      {
        "question": "How does Better Auth handle session security?",
        "answer": "Better Auth uses secure, HTTP-only cookies with CSRF protection. Rate limiting prevents brute-force attacks. Sessions can be configured with expiry times and cookie caching for security."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 214
    }
  ]
}
