{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T08:33:58.602Z",
    "slug": "plugin-settings",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/plugin-settings",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "Plugin Settings",
    "description": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", \"user-configurable plugin\", \".local.md files\", \"plugin state files\", \"read YAML frontmatter\", \"per-project plugin settings\", or wants to make plugin behavior configurable. Documents the .claude/plugin-name.local.md pattern for storing plugin-specific configuration with YAML frontmatter and markdown content.",
    "summary": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", ...",
    "icon": "⚙️",
    "version": "0.1.0",
    "author": "Anthropic",
    "license": "Not specified",
    "category": "development",
    "tags": [
      "plugin-configuration",
      "yaml",
      "settings",
      "state-management",
      "hooks",
      "bash-scripting",
      "frontmatter",
      "per-project-config"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill with no security concerns. Contains safe bash parsing utilities and documentation for plugin configuration patterns. All example code follows secure practices including input validation, path traversal prevention, and atomic file updates.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 8,
    "total_lines": 1978,
    "audit_model": "claude",
    "audited_at": "2025-12-30T08:33:58.602Z"
  },
  "content": {
    "user_title": "Plugin Settings Manager",
    "value_statement": "Enable your Claude Code plugins to store user-configurable settings and state using a simple YAML frontmatter + markdown pattern that's version-control friendly and easy to parse from hooks and commands.",
    "seo_keywords": [
      "plugin configuration",
      "yaml frontmatter",
      "claude code settings",
      "per-project config",
      "plugin state management",
      "bash yaml parsing",
      "local settings files",
      "hook configuration"
    ],
    "actual_capabilities": [
      "Create .claude/plugin-name.local.md configuration files with YAML frontmatter",
      "Parse YAML frontmatter from bash hooks and scripts",
      "Store both structured configuration (YAML) and freeform content (markdown)",
      "Implement user-configurable plugin behavior without code changes",
      "Manage plugin state and coordination data across sessions",
      "Validate settings file structure and field values",
      "Generate configuration file templates for users"
    ],
    "limitations": [
      "Changes require Claude Code restart to take effect (hooks cannot be hot-swapped)",
      "Requires bash scripting knowledge to implement parsing in hooks",
      "Complex YAML structures (nested objects, arrays) require additional tools like yq",
      "Settings files are user-local and should not be committed to git",
      "No automatic settings migration or validation on schema changes"
    ],
    "use_cases": [
      {
        "title": "Configurable Plugin Activation",
        "description": "Allow users to enable/disable plugins per-project by reading an 'enabled' flag from settings, providing finer control than global hooks.json configuration",
        "target_user": "Plugin developers who want users to control plugin behavior per-project"
      },
      {
        "title": "Multi-Agent State Coordination",
        "description": "Store agent task assignments, dependencies, and coordinator session information to enable multiple Claude instances to collaborate on a project",
        "target_user": "Teams using multi-agent workflows to parallelize development tasks"
      },
      {
        "title": "Validation Mode Configuration",
        "description": "Let users configure strict/standard/lenient validation modes for security or compliance hooks, adapting to project requirements",
        "target_user": "Security-conscious developers who need flexible validation policies"
      },
      {
        "title": "Loop State Management",
        "description": "Track iteration counts, completion promises, and prompts for self-looping workflows where Claude repeatedly processes tasks until criteria are met",
        "target_user": "Developers automating repetitive tasks like fixing lint errors or running tests"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Plugin Settings",
        "prompt": "Create a settings file at .claude/my-plugin.local.md with enabled=true, validation_mode=standard, and max_file_size=1000000. Include instructions in the markdown body.",
        "scenario": "Setting up a new plugin for the first time in a project"
      },
      {
        "title": "Read Settings in Hook",
        "prompt": "Show me how to read the 'strict_mode' setting from .claude/security-scan.local.md in a bash hook and apply different validation logic based on its value",
        "scenario": "Implementing configurable hook behavior"
      },
      {
        "title": "Validate Settings File",
        "prompt": "Validate the structure of .claude/my-plugin.local.md and check that all required fields (enabled, mode, max_retries) are present and have valid values",
        "scenario": "Debugging settings file issues or ensuring correctness"
      },
      {
        "title": "Update Agent State",
        "prompt": "Update the pr_number field in .claude/multi-agent-swarm.local.md to 5678 after creating a pull request",
        "scenario": "Updating plugin state during workflow execution"
      }
    ],
    "output_examples": [
      {
        "input": "Create a settings file for my-plugin with strict mode enabled",
        "output": "Created .claude/my-plugin.local.md:\n---\nenabled: true\nstrict_mode: true\nmax_file_size: 1000000\nnotify_on_errors: true\n---\n\n# My Plugin Configuration\n\nStrict mode is enabled for maximum security.\nEdit this file and restart Claude Code to change settings."
      },
      {
        "input": "Parse the enabled field from .claude/my-plugin.local.md",
        "output": "Bash code:\nFRONTMATTER=$(sed -n '/^---$/,/^---$/{ /^---$/d; p; }' \".claude/my-plugin.local.md\")\nENABLED=$(echo \"$FRONTMATTER\" | grep '^enabled:' | sed 's/enabled: *//')\nif [[ \"$ENABLED\" == \"true\" ]]; then\n  echo \"Plugin is enabled\"\nfi"
      }
    ],
    "best_practices": [
      "Always use the 'quick exit' pattern: check if settings file exists before parsing to avoid errors",
      "Include an 'enabled' field to allow users to temporarily disable plugins without deleting settings",
      "Use atomic file updates (temp file + mv) when modifying settings to prevent corruption",
      "Provide sensible defaults when settings file doesn't exist or fields are missing",
      "Add .claude/*.local.md to .gitignore to prevent committing user-local settings",
      "Document that settings changes require Claude Code restart in your plugin README",
      "Validate field values and handle missing/invalid data gracefully",
      "Use sed/grep for simple fields, yq for complex YAML structures with nested data",
      "Quote all bash variables to handle values with spaces or special characters",
      "Store structured config in frontmatter, freeform content (prompts, instructions) in markdown body"
    ],
    "anti_patterns": [
      "Hardcoding file paths instead of using relative paths from project root",
      "Using sed -i for in-place updates (non-atomic, can corrupt file if interrupted)",
      "Not providing defaults when settings file or fields are missing",
      "Ignoring edge cases like quotes in YAML values or '---' in markdown body",
      "Using unquoted bash variables that can break with spaces or special characters",
      "Creating .md files without .local suffix (risk of committing to git)",
      "Not validating numeric ranges or enum values from settings",
      "Assuming exactly 2 '---' markers (fails if '---' appears in body)",
      "Storing sensitive data like API keys in settings files",
      "Expecting hot-reloading of settings without Claude Code restart"
    ],
    "faq": [
      {
        "question": "Do I need to restart Claude Code after changing settings?",
        "answer": "Yes. Hooks are loaded at startup and cannot be hot-swapped within a session. After editing .claude/plugin-name.local.md, you must exit and restart Claude Code for changes to take effect."
      },
      {
        "question": "Should settings files be committed to git?",
        "answer": "No. Settings files with .local.md suffix are user-local configuration and should be added to .gitignore. They may contain per-user preferences or session-specific state that shouldn't be shared."
      },
      {
        "question": "How do I parse complex YAML like nested objects or arrays?",
        "answer": "For simple fields, use sed/grep as shown in examples. For complex structures, install yq (brew install yq) and use it to parse YAML properly. The skill documentation includes examples for both approaches."
      },
      {
        "question": "Can I use this pattern for cross-session state?",
        "answer": "Yes. The ralph-wiggum and multi-agent-swarm plugins demonstrate storing iteration counts, task assignments, and other state that persists across Claude Code sessions."
      },
      {
        "question": "What's the difference between frontmatter and markdown body?",
        "answer": "Frontmatter (between ---) stores structured configuration as YAML key-value pairs. The markdown body stores freeform content like prompts, instructions, or documentation. Hooks can read both sections for different purposes."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "bash (for parsing scripts)",
        "sed (for frontmatter extraction)",
        "awk (for body extraction)",
        "grep (for field extraction)",
        "jq (for JSON output in hooks)",
        "yq (optional, for complex YAML parsing)"
      ],
      "permissions": [
        "Read access to .claude/ directory",
        "Write access to create/update .local.md files",
        "Execute permissions for bash scripts"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "create-settings-command.md",
          "type": "file",
          "path": "examples/create-settings-command.md"
        },
        {
          "name": "example-settings.md",
          "type": "file",
          "path": "examples/example-settings.md"
        },
        {
          "name": "read-settings-hook.sh",
          "type": "file",
          "path": "examples/read-settings-hook.sh"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "parsing-techniques.md",
          "type": "file",
          "path": "references/parsing-techniques.md"
        },
        {
          "name": "real-world-examples.md",
          "type": "file",
          "path": "references/real-world-examples.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "parse-frontmatter.sh",
          "type": "file",
          "path": "scripts/parse-frontmatter.sh"
        },
        {
          "name": "validate-settings.sh",
          "type": "file",
          "path": "scripts/validate-settings.sh"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}