{
  "meta": {
    "generated_at": "2025-12-29T15:58:10Z",
    "model": "gpt-5.2:high",
    "source_url": "https://github.com/anthropics/claude-code",
    "source_ref": "d213a74fc8e3b6efded52729196e0c2d4c3abb3e",
    "analysis_version": "2.0.0"
  },
  "security_audit": {
    "risk_level": "safe",
    "should_block": false,
    "safe_to_publish": true,
    "summary": "No executable code present. The file is documentation describing Hookify rule syntax and examples, with no filesystem reads, network access, subprocess execution, or dynamic behavior.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 222,
            "line_end": 224
          }
        ],
        "title": "Mentions sensitive directories in guidance",
        "description": "The document references storing rules under `.claude/` and suggests gitignore patterns. This is not malicious, but it touches a potentially sensitive config area and should remind users not to include secrets in rule bodies."
      },
      {
        "locations": [
          {
            "file": "SKILL.md",
            "line_start": 201,
            "line_end": 203
          }
        ],
        "title": "Links to third-party regex testing site",
        "description": "Recommends using an online regex tester (regex101.com). Low risk, but users may paste sensitive text into third-party services."
      }
    ],
    "files_analyzed": 1,
    "dangerous_patterns_found": [],
    "files_scanned": 1,
    "total_lines": 374
  },
  "content": {
    "user_title": "Create Hookify Rules for Claude Code Safety",
    "value_statement": "Stop unsafe commands and risky edits from slipping into your workflow. Define Hookify rules that warn or block actions based on events and patterns.",
    "seo_keywords": [
      "Claude Code Hookify rules",
      "Claude Hookify rule syntax",
      "Claude Code safety rules",
      "hookify regex patterns",
      "Claude Code workflow guardrails",
      "hook events bash file stop prompt",
      "prevent dangerous rm commands",
      "detect console.log in commits",
      "rule-based developer checklists"
    ],
    "actual_capabilities": [
      "Explain Hookify rule file structure with YAML frontmatter and markdown message bodies",
      "Guide creation of rules for `bash`, `file`, `stop`, `prompt`, and `all` events",
      "Provide examples for simple `pattern` rules and advanced multi-condition rules",
      "Teach regex pattern writing tips, escaping rules, and common pitfalls"
    ],
    "limitations": [
      "Does not execute or validate Hookify rules automatically; it provides guidance and examples",
      "Regex behavior depends on Hookify and Python-regex semantics; edge cases may need local testing",
      "Cannot determine your project policies; you must decide what should warn vs block"
    ],
    "use_cases": [
      {
        "target_user": "Team Lead",
        "title": "Guardrail Setup",
        "description": "Create rules that warn or block risky commands and enforce consistent engineering checks."
      },
      {
        "target_user": "Security Engineer",
        "title": "Sensitive Change Detection",
        "description": "Draft file rules that flag edits to secrets files and unsafe APIs like eval or innerHTML."
      },
      {
        "target_user": "Individual Developer",
        "title": "Local Workflow Reminders",
        "description": "Add stop-event checklists for tests, builds, and documentation before ending a session."
      }
    ],
    "prompt_templates": [
      {
        "title": "First Rule",
        "scenario": "Basic guardrail",
        "prompt": "Write a Hookify rule that warns when a bash command contains rm -rf. Use a clear message and a safe alternative."
      },
      {
        "title": "File Edit Warning",
        "scenario": "Prevent risky code patterns",
        "prompt": "Create a Hookify file rule that warns when new_text contains console.log( in .ts or .tsx files."
      },
      {
        "title": "Multi-Condition Rule",
        "scenario": "Target specific files and content",
        "prompt": "Create an advanced Hookify rule with conditions: file_path matches \\.env$ and new_text contains API_KEY. Include guidance to add the file to .gitignore."
      },
      {
        "title": "Process Checklist",
        "scenario": "Enforce completion steps",
        "prompt": "Write a stop-event Hookify rule that always triggers and shows a short checklist for tests, build, and docs."
      }
    ],
    "output_examples": [
      {
        "input": "Create a Hookify rule that blocks chmod 777 in bash commands",
        "output": [
          "Creates a rule file plan for `.claude/hookify.block-chmod-777.local.md`",
          "Frontmatter includes: name, enabled, event: bash, action: block, and a regex pattern for chmod 777",
          "Message explains why chmod 777 is risky and suggests safer permissions like 755 or 750",
          "Notes how to disable the rule by setting enabled: false"
        ]
      }
    ],
    "best_practices": [
      "Use specific regex patterns to reduce false positives",
      "Start with `warn` actions before switching to `block`",
      "Test patterns locally with small representative examples before relying on them"
    ],
    "anti_patterns": [
      "Avoid overly broad patterns like `log` that match unrelated text",
      "Avoid embedding secrets in rule messages or examples",
      "Avoid blocking common commands without providing safe alternatives in the message"
    ],
    "faq": [
      {
        "question": "Is this compatible with Claude Code?",
        "answer": "Yes. It describes Hookify rule files and events used in Claude Code workflows."
      },
      {
        "question": "What events can a rule target?",
        "answer": "It covers `bash`, `file`, `stop`, `prompt`, and `all` events."
      },
      {
        "question": "Can a rule block actions?",
        "answer": "Yes. Use `action: block` to prevent operations when the rule matches, depending on the event type."
      },
      {
        "question": "Does it send data over the network?",
        "answer": "No. The skill content is documentation-only and contains no code that reads files, collects environment variables, or makes network requests."
      },
      {
        "question": "How do I store rules safely?",
        "answer": "Use `.claude/hookify.{name}.local.md` and add `.claude/*.local.md` to `.gitignore` to avoid committing local policy files."
      },
      {
        "question": "How is this different from a linter?",
        "answer": "A linter analyzes code with language-aware rules, while Hookify rules match patterns and conditions on tool events like commands and file edits."
      }
    ],
    "technical_requirements": {
      "dependencies": [],
      "permissions_needed": [],
      "estimated_complexity": "low",
      "setup_time_minutes": 2
    }
  }
}
