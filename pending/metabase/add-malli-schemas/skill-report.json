{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T16:21:47.227Z",
    "slug": "metabase-add-malli-schemas",
    "source_url": "https://github.com/metabase/metabase/tree/master/.claude/skills/add-malli-schemas",
    "source_ref": "master",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community"
  },
  "skill": {
    "name": "add-malli-schemas",
    "description": "Efficiently add Malli schemas to API endpoints in the Metabase codebase with proper patterns, validation timing, and error handling",
    "summary": "Efficiently add Malli schemas to API endpoints in the Metabase codebase with proper patterns, valida...",
    "icon": "ðŸ§©",
    "version": "1.0.0",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "clojure",
      "api",
      "schemas",
      "malli",
      "validation"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "No data theft, malicious execution, or obfuscation patterns were found. The content is instructional and focused on schema patterns and validation guidance.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 420,
    "audit_model": "codex",
    "audited_at": "2025-12-31T16:21:47.227Z"
  },
  "content": {
    "user_title": "Add Malli schemas to Metabase endpoints",
    "value_statement": "You need consistent request and response validation for Metabase API endpoints. This skill provides patterns, examples, and pitfalls to apply Malli schemas correctly.",
    "seo_keywords": [
      "Malli schemas",
      "Metabase API",
      "Clojure validation",
      "API schema patterns",
      "Claude",
      "Codex",
      "Claude Code",
      "Malli examples",
      "Clojure endpoints"
    ],
    "actual_capabilities": [
      "Show patterns for route, query, and body parameter schemas",
      "Provide response schema examples, including named schemas",
      "Explain validation timing for request and response schemas",
      "List common schema types in the ms namespace and built-in Malli types",
      "Highlight common pitfalls and how to avoid them",
      "Outline a testing checklist for schema changes"
    ],
    "limitations": [
      "Does not inspect your codebase or determine actual return types",
      "Focused on Metabase and Malli conventions, not other frameworks",
      "Does not run tests or apply changes automatically",
      "Requires you to supply endpoint context for precise schemas"
    ],
    "use_cases": [
      {
        "target_user": "Backend developer",
        "title": "Add schemas to new endpoint",
        "description": "Apply consistent Malli validation for a new Metabase API route."
      },
      {
        "target_user": "Maintainer",
        "title": "Standardize response schemas",
        "description": "Create reusable named response schemas across related endpoints."
      },
      {
        "target_user": "Reviewer",
        "title": "Audit schema changes",
        "description": "Check for optional params, defaults, and temporal field handling."
      }
    ],
    "prompt_templates": [
      {
        "title": "Add route schema",
        "scenario": "Simple GET endpoint with id param",
        "prompt": "Add a Malli route param schema for GET /api/item/:id using ms/PositiveInt and show the updated defendpoint signature."
      },
      {
        "title": "Add query schema",
        "scenario": "GET endpoint with optional filters",
        "prompt": "Create a query param schema with optional include and limit fields, using :optional true and :default where needed."
      },
      {
        "title": "Add response schema",
        "scenario": "Endpoint returns a list of items",
        "prompt": "Define a named response schema for a list of items with id and name, then apply it to the endpoint."
      },
      {
        "title": "Complex validation",
        "scenario": "POST with nested data",
        "prompt": "Design request and response schemas for a POST endpoint with nested data, and note where :maybe and :any are required."
      }
    ],
    "output_examples": [
      {
        "input": "Add schemas to GET /api/field/:id/related and explain the response shape.",
        "output": [
          "Define ::RelatedEntity with tables and fields sequences",
          "Use ms/PositiveInt for ids and string? for names",
          "Attach ::RelatedEntity to the endpoint response schema"
        ]
      }
    ],
    "best_practices": [
      "Use ms namespace schemas for request validation",
      "Separate route, query, and body params in distinct maps",
      "Use :any for temporal fields in response schemas"
    ],
    "anti_patterns": [
      "Using ms/TemporalString in response schemas",
      "Forgetting :optional true for optional query params",
      "Mixing route, query, and body params in one map"
    ],
    "faq": [
      {
        "question": "Is this compatible with all Clojure APIs?",
        "answer": "It targets Metabase and Malli conventions, but many patterns apply to other Clojure APIs."
      },
      {
        "question": "What are the main limits of this skill?",
        "answer": "It does not inspect your code or infer actual return types."
      },
      {
        "question": "Can I integrate it into my review workflow?",
        "answer": "Yes, use the checklists and pitfalls to guide code reviews."
      },
      {
        "question": "Does it access my files or secrets?",
        "answer": "No, it only provides guidance based on the skill content."
      },
      {
        "question": "What if validation errors are unclear?",
        "answer": "Use custom error messages and verify schemas with targeted tests."
      },
      {
        "question": "How does it compare to general schema advice?",
        "answer": "It is tailored to Metabase, Malli, and API endpoint patterns."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}