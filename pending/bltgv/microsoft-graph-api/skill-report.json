{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:50:29.416Z",
    "slug": "bltgv-microsoft-graph-api",
    "source_url": "https://github.com/BLTGV/agent-skills/tree/master/skills/microsoft-graph",
    "source_ref": "master",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "1b6e98ed17e1c3b15dfabe198412694417b9725c112dbadcb085aa82e9d3bd38",
    "tree_hash": "e98786e65fd2aa25aaa6e99d41a90d89766fa34924dd327ba60e6bc1345dcd34"
  },
  "skill": {
    "name": "Microsoft Graph API",
    "description": "This skill should be used when the user asks to \"read my emails\", \"send an email\", \"compose email\", \"check my calendar\", \"get calendar events\", \"create a meeting\", \"schedule an event\", \"add calendar event\", \"search emails\", \"list mail folders\", \"show unread messages\", \"what meetings do I have\", \"fetch emails from Microsoft\", \"access Outlook\", or mentions Microsoft Graph, Office 365 email, or Outlook calendar integration.",
    "summary": "This skill should be used when the user asks to \"read my emails\", \"send an email\", \"compose email\", ...",
    "icon": "ðŸ“§",
    "version": "0.3.0",
    "author": "BLTGV",
    "license": "MIT",
    "category": "office",
    "tags": [
      "microsoft-365",
      "email",
      "calendar",
      "outlook",
      "productivity"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "network",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Legitimate Microsoft Graph API integration for email and calendar access. Uses standard OAuth2 device code flow with official MSAL library. Credentials stored in user home directory only. All network calls go to verified Microsoft endpoints. No code execution vulnerabilities or data exfiltration risks detected.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "scripts/emails.ts",
            "line_start": 1,
            "line_end": 350
          },
          {
            "file": "scripts/calendar.ts",
            "line_start": 1,
            "line_end": 421
          },
          {
            "file": "scripts/auth.ts",
            "line_start": 1,
            "line_end": 210
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "scripts/lib/graph-client.ts",
            "line_start": 155,
            "line_end": 162
          },
          {
            "file": "scripts/lib/device-code.ts",
            "line_start": 38,
            "line_end": 68
          },
          {
            "file": "scripts/lib/device-code.ts",
            "line_start": 73,
            "line_end": 131
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/lib/credentials.ts",
            "line_start": 6,
            "line_end": 25
          },
          {
            "file": "scripts/lib/pending-auth.ts",
            "line_start": 29,
            "line_end": 54
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 11,
    "total_lines": 1356,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:50:29.416Z"
  },
  "content": {
    "user_title": "Access Microsoft 365 email and calendar",
    "value_statement": "Managing emails and calendar events across Microsoft 365 requires switching between applications and manually logging in. This skill provides a unified interface to read, send, search emails and manage calendar events through Microsoft Graph API with secure OAuth2 authentication.",
    "seo_keywords": [
      "Microsoft Graph API skill",
      "Microsoft 365 email",
      "Outlook calendar integration",
      "Claude email skill",
      "Claude calendar skill",
      "Bun script email",
      "Office 365 automation",
      "Microsoft Graph authentication",
      "email automation Claude",
      "calendar automation Claude Code"
    ],
    "actual_capabilities": [
      "List, read, and search emails from Microsoft 365 inbox",
      "Send emails with TO, CC, BCC recipients and HTML support",
      "List calendar events and create new meetings with attendees",
      "Handle OAuth2 device code authentication automatically",
      "Support multiple credential profiles for different accounts",
      "Search emails and calendar events with query filters"
    ],
    "limitations": [
      "Requires valid Microsoft 365 account with Graph API access",
      "Cannot access shared mailboxes or delegated calendars",
      "Rate limited by Microsoft Graph API (2000 requests per second)",
      "Refresh tokens expire after approximately 90 days"
    ],
    "use_cases": [
      {
        "target_user": "Office workers",
        "title": "Manage daily communications",
        "description": "Quickly check emails, find messages, and send updates without leaving your workflow"
      },
      {
        "target_user": "Meeting organizers",
        "title": "Schedule meetings efficiently",
        "description": "Create calendar events with attendees and locations directly from natural language requests"
      },
      {
        "target_user": "Professionals",
        "title": "Search and retrieve information",
        "description": "Find specific emails or calendar items using search queries without opening Outlook"
      }
    ],
    "prompt_templates": [
      {
        "title": "List recent emails",
        "scenario": "Read inbox messages",
        "prompt": "List my recent emails from Microsoft 365. Show me the last 10 messages with their subjects, senders, and dates."
      },
      {
        "title": "Send email",
        "scenario": "Compose and send message",
        "prompt": "Send an email to team@example.com with the subject 'Weekly Update' and the body summarizing our project progress."
      },
      {
        "title": "Check calendar",
        "scenario": "View upcoming events",
        "prompt": "What meetings do I have this week? Show me all calendar events from today through Sunday."
      },
      {
        "title": "Create meeting",
        "scenario": "Schedule new event",
        "prompt": "Create a calendar event for tomorrow at 2pm called 'Design Review'. Include john@example.com and sarah@example.com as attendees. Set the end time for 3pm."
      }
    ],
    "output_examples": [
      {
        "input": "List my recent emails",
        "output": [
          "From: manager@company.com - Project Update - Today 9:30 AM",
          "From: hr@company.com - Benefits Enrollment Deadline - Yesterday 3:15 PM",
          "From: client@partner.com - Contract Review - Yesterday 11:00 AM",
          "Subject: Team Meeting scheduled - Friday 10:00 AM"
        ]
      }
    ],
    "best_practices": [
      "Use specific profiles for different Microsoft accounts to keep credentials separate",
      "Re-authenticate promptly when scripts indicate expired refresh tokens",
      "Encode special characters in search queries to avoid API errors"
    ],
    "anti_patterns": [
      "Do not share authentication codes displayed during device code flow",
      "Avoid storing credentials in scripts or environment variables directly",
      "Do not attempt to bypass Microsoft Graph rate limits with repeated requests"
    ],
    "faq": [
      {
        "question": "Which Microsoft accounts are supported?",
        "answer": "Personal Microsoft accounts, work accounts, and school accounts with Microsoft 365 are supported through the Graph API."
      },
      {
        "question": "What are the rate limits?",
        "answer": "Microsoft Graph allows 2000 requests per second per app and 10000 requests per user per 10 minutes."
      },
      {
        "question": "Can I use my own Azure app registration?",
        "answer": "Yes, provide your client ID and tenant ID using the --client-id and --tenant-id options for custom app registration."
      },
      {
        "question": "Is my credential data secure?",
        "answer": "Credentials are stored in ~/.config/api-skills/ with file system permissions restricting access to the owning user only."
      },
      {
        "question": "Authentication keeps asking for code",
        "answer": "Device codes expire after 15 minutes. Complete authentication promptly or restart the script to get a fresh code."
      },
      {
        "question": "How does this compare to Outlook web access?",
        "answer": "This skill provides scriptable access to Graph API with structured JSON output, suitable for automation and integration workflows."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "graph-api.md",
          "type": "file",
          "path": "references/graph-api.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "lib",
          "type": "dir",
          "path": "scripts/lib",
          "children": [
            {
              "name": "auth-handler.ts",
              "type": "file",
              "path": "scripts/lib/auth-handler.ts"
            },
            {
              "name": "credentials.ts",
              "type": "file",
              "path": "scripts/lib/credentials.ts"
            },
            {
              "name": "device-code.ts",
              "type": "file",
              "path": "scripts/lib/device-code.ts"
            },
            {
              "name": "graph-client.ts",
              "type": "file",
              "path": "scripts/lib/graph-client.ts"
            },
            {
              "name": "pending-auth.ts",
              "type": "file",
              "path": "scripts/lib/pending-auth.ts"
            },
            {
              "name": "types.ts",
              "type": "file",
              "path": "scripts/lib/types.ts"
            }
          ]
        },
        {
          "name": "auth.ts",
          "type": "file",
          "path": "scripts/auth.ts"
        },
        {
          "name": "calendar.ts",
          "type": "file",
          "path": "scripts/calendar.ts"
        },
        {
          "name": "emails.ts",
          "type": "file",
          "path": "scripts/emails.ts"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
