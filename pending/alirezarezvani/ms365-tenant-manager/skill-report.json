{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-15T11:40:35.844Z",
    "slug": "alirezarezvani-ms365-tenant-manager",
    "source_url": "https://github.com/alirezarezvani/claude-skills/tree/main/engineering-team/ms365-tenant-manager",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "8a219cd88f0b9eeb40af161df48d786c2a2d95905dab8f50317a38f378f1d851",
    "tree_hash": "68b7f11751614eebc43df032ebad56dc77174c6e05d8958ac5a4f7743115fab7"
  },
  "skill": {
    "name": "ms365-tenant-manager",
    "description": "Comprehensive Microsoft 365 tenant administration skill for setup, configuration, user management, security policies, and organizational structure optimization for Global Administrators",
    "summary": "Comprehensive Microsoft 365 tenant administration skill for setup, configuration, user management, s...",
    "icon": "ðŸ“‹",
    "version": "1.0.0",
    "author": "alirezarezvani",
    "license": "MIT",
    "category": "office",
    "tags": [
      "microsoft-365",
      "tenant-management",
      "powershell",
      "security",
      "automation"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "network",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "All 155 static findings are false positives. This skill generates documentation and PowerShell scripts as strings - it never executes external commands, makes network requests, or accesses credentials. The static scanner detected PowerShell command names within generated script templates and documentation URLs, misinterpreting them as executable threats.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "expected_output.json",
            "line_start": 50,
            "line_end": 50
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 8,
            "line_end": 10
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 10,
            "line_end": 13
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 13,
            "line_end": 15
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 15,
            "line_end": 18
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 18,
            "line_end": 20
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 20,
            "line_end": 23
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 23,
            "line_end": 25
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 25,
            "line_end": 28
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 28,
            "line_end": 30
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 30,
            "line_end": 33
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 33,
            "line_end": 35
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 35,
            "line_end": 38
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 38,
            "line_end": 40
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 40,
            "line_end": 154
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 154,
            "line_end": 159
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 159,
            "line_end": 204
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 204,
            "line_end": 215
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 14,
            "line_end": 14
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 78,
            "line_end": 78
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 108,
            "line_end": 108
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 114,
            "line_end": 114
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 151,
            "line_end": 151
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 153,
            "line_end": 153
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 154,
            "line_end": 154
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 158,
            "line_end": 158
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 168,
            "line_end": 168
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 169,
            "line_end": 169
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 203,
            "line_end": 203
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 205,
            "line_end": 205
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 223,
            "line_end": 223
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 223,
            "line_end": 223
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 230,
            "line_end": 230
          },
          {
            "file": "powershell_generator.py",
            "line_start": 90,
            "line_end": 90
          },
          {
            "file": "powershell_generator.py",
            "line_start": 91,
            "line_end": 91
          },
          {
            "file": "powershell_generator.py",
            "line_start": 157,
            "line_end": 157
          },
          {
            "file": "powershell_generator.py",
            "line_start": 181,
            "line_end": 181
          },
          {
            "file": "powershell_generator.py",
            "line_start": 190,
            "line_end": 190
          },
          {
            "file": "powershell_generator.py",
            "line_start": 204,
            "line_end": 204
          },
          {
            "file": "powershell_generator.py",
            "line_start": 204,
            "line_end": 204
          },
          {
            "file": "powershell_generator.py",
            "line_start": 213,
            "line_end": 213
          },
          {
            "file": "powershell_generator.py",
            "line_start": 232,
            "line_end": 232
          },
          {
            "file": "powershell_generator.py",
            "line_start": 254,
            "line_end": 254
          },
          {
            "file": "powershell_generator.py",
            "line_start": 265,
            "line_end": 265
          },
          {
            "file": "powershell_generator.py",
            "line_start": 272,
            "line_end": 272
          },
          {
            "file": "powershell_generator.py",
            "line_start": 273,
            "line_end": 273
          },
          {
            "file": "powershell_generator.py",
            "line_start": 274,
            "line_end": 274
          },
          {
            "file": "powershell_generator.py",
            "line_start": 274,
            "line_end": 274
          },
          {
            "file": "powershell_generator.py",
            "line_start": 275,
            "line_end": 275
          },
          {
            "file": "powershell_generator.py",
            "line_start": 278,
            "line_end": 278
          },
          {
            "file": "powershell_generator.py",
            "line_start": 279,
            "line_end": 279
          },
          {
            "file": "powershell_generator.py",
            "line_start": 283,
            "line_end": 283
          },
          {
            "file": "powershell_generator.py",
            "line_start": 283,
            "line_end": 283
          },
          {
            "file": "powershell_generator.py",
            "line_start": 283,
            "line_end": 283
          },
          {
            "file": "powershell_generator.py",
            "line_start": 283,
            "line_end": 283
          },
          {
            "file": "powershell_generator.py",
            "line_start": 357,
            "line_end": 357
          },
          {
            "file": "powershell_generator.py",
            "line_start": 415,
            "line_end": 415
          },
          {
            "file": "powershell_generator.py",
            "line_start": 421,
            "line_end": 421
          },
          {
            "file": "powershell_generator.py",
            "line_start": 423,
            "line_end": 423
          },
          {
            "file": "powershell_generator.py",
            "line_start": 2,
            "line_end": 2
          },
          {
            "file": "powershell_generator.py",
            "line_start": 9,
            "line_end": 9
          },
          {
            "file": "powershell_generator.py",
            "line_start": 10,
            "line_end": 10
          },
          {
            "file": "powershell_generator.py",
            "line_start": 29,
            "line_end": 29
          },
          {
            "file": "powershell_generator.py",
            "line_start": 111,
            "line_end": 111
          },
          {
            "file": "powershell_generator.py",
            "line_start": 314,
            "line_end": 314
          },
          {
            "file": "SKILL.md",
            "line_start": 59,
            "line_end": 59
          },
          {
            "file": "SKILL.md",
            "line_start": 60,
            "line_end": 60
          },
          {
            "file": "SKILL.md",
            "line_start": 61,
            "line_end": 61
          },
          {
            "file": "SKILL.md",
            "line_start": 62,
            "line_end": 62
          },
          {
            "file": "SKILL.md",
            "line_start": 63,
            "line_end": 63
          },
          {
            "file": "SKILL.md",
            "line_start": 173,
            "line_end": 173
          },
          {
            "file": "SKILL.md",
            "line_start": 174,
            "line_end": 174
          },
          {
            "file": "SKILL.md",
            "line_start": 175,
            "line_end": 175
          },
          {
            "file": "SKILL.md",
            "line_start": 176,
            "line_end": 176
          },
          {
            "file": "SKILL.md",
            "line_start": 177,
            "line_end": 177
          },
          {
            "file": "SKILL.md",
            "line_start": 177,
            "line_end": 177
          },
          {
            "file": "SKILL.md",
            "line_start": 178,
            "line_end": 178
          },
          {
            "file": "SKILL.md",
            "line_start": 20,
            "line_end": 20
          },
          {
            "file": "SKILL.md",
            "line_start": 36,
            "line_end": 36
          },
          {
            "file": "SKILL.md",
            "line_start": 42,
            "line_end": 42
          },
          {
            "file": "SKILL.md",
            "line_start": 52,
            "line_end": 52
          },
          {
            "file": "SKILL.md",
            "line_start": 63,
            "line_end": 63
          },
          {
            "file": "SKILL.md",
            "line_start": 63,
            "line_end": 63
          },
          {
            "file": "SKILL.md",
            "line_start": 95,
            "line_end": 95
          },
          {
            "file": "SKILL.md",
            "line_start": 145,
            "line_end": 145
          },
          {
            "file": "SKILL.md",
            "line_start": 170,
            "line_end": 170
          },
          {
            "file": "SKILL.md",
            "line_start": 176,
            "line_end": 176
          },
          {
            "file": "SKILL.md",
            "line_start": 186,
            "line_end": 186
          },
          {
            "file": "SKILL.md",
            "line_start": 193,
            "line_end": 193
          },
          {
            "file": "SKILL.md",
            "line_start": 193,
            "line_end": 193
          },
          {
            "file": "tenant_setup.py",
            "line_start": 281,
            "line_end": 281
          },
          {
            "file": "tenant_setup.py",
            "line_start": 283,
            "line_end": 283
          },
          {
            "file": "tenant_setup.py",
            "line_start": 286,
            "line_end": 286
          },
          {
            "file": "tenant_setup.py",
            "line_start": 355,
            "line_end": 355
          },
          {
            "file": "user_management.py",
            "line_start": 90,
            "line_end": 91
          },
          {
            "file": "user_management.py",
            "line_start": 92,
            "line_end": 93
          },
          {
            "file": "user_management.py",
            "line_start": 94,
            "line_end": 95
          },
          {
            "file": "user_management.py",
            "line_start": 96,
            "line_end": 97
          },
          {
            "file": "user_management.py",
            "line_start": 98,
            "line_end": 136
          },
          {
            "file": "user_management.py",
            "line_start": 217,
            "line_end": 218
          },
          {
            "file": "user_management.py",
            "line_start": 219,
            "line_end": 251
          },
          {
            "file": "user_management.py",
            "line_start": 75,
            "line_end": 75
          },
          {
            "file": "user_management.py",
            "line_start": 87,
            "line_end": 87
          },
          {
            "file": "user_management.py",
            "line_start": 116,
            "line_end": 116
          },
          {
            "file": "user_management.py",
            "line_start": 130,
            "line_end": 130
          },
          {
            "file": "user_management.py",
            "line_start": 175,
            "line_end": 175
          },
          {
            "file": "user_management.py",
            "line_start": 190,
            "line_end": 190
          },
          {
            "file": "user_management.py",
            "line_start": 199,
            "line_end": 199
          },
          {
            "file": "user_management.py",
            "line_start": 98,
            "line_end": 136
          },
          {
            "file": "user_management.py",
            "line_start": 25,
            "line_end": 25
          },
          {
            "file": "user_management.py",
            "line_start": 31,
            "line_end": 31
          },
          {
            "file": "user_management.py",
            "line_start": 148,
            "line_end": 148
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "HOW_TO_USE.md",
            "line_start": 220,
            "line_end": 220
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 221,
            "line_end": 221
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 222,
            "line_end": 222
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 223,
            "line_end": 223
          },
          {
            "file": "HOW_TO_USE.md",
            "line_start": 224,
            "line_end": 224
          },
          {
            "file": "SKILL.md",
            "line_start": 191,
            "line_end": 191
          },
          {
            "file": "SKILL.md",
            "line_start": 192,
            "line_end": 192
          },
          {
            "file": "SKILL.md",
            "line_start": 193,
            "line_end": 193
          },
          {
            "file": "SKILL.md",
            "line_start": 195,
            "line_end": 195
          },
          {
            "file": "tenant_setup.py",
            "line_start": 44,
            "line_end": 44
          },
          {
            "file": "tenant_setup.py",
            "line_start": 356,
            "line_end": 356
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "powershell_generator.py",
            "line_start": 31,
            "line_end": 31
          },
          {
            "file": "powershell_generator.py",
            "line_start": 32,
            "line_end": 32
          },
          {
            "file": "powershell_generator.py",
            "line_start": 33,
            "line_end": 33
          },
          {
            "file": "powershell_generator.py",
            "line_start": 34,
            "line_end": 34
          },
          {
            "file": "tenant_setup.py",
            "line_start": 19,
            "line_end": 19
          },
          {
            "file": "tenant_setup.py",
            "line_start": 20,
            "line_end": 20
          },
          {
            "file": "tenant_setup.py",
            "line_start": 21,
            "line_end": 21
          },
          {
            "file": "tenant_setup.py",
            "line_start": 22,
            "line_end": 22
          },
          {
            "file": "tenant_setup.py",
            "line_start": 23,
            "line_end": 23
          },
          {
            "file": "tenant_setup.py",
            "line_start": 24,
            "line_end": 24
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 7,
    "total_lines": 1867,
    "audit_model": "claude",
    "audited_at": "2026-01-15T11:40:35.844Z"
  },
  "content": {
    "user_title": "Manage Microsoft 365 tenants with automation",
    "value_statement": "This skill provides Microsoft 365 Global Administrators with automated tenant setup, security policy configuration, and PowerShell script generation for user management and compliance tasks.",
    "seo_keywords": [
      "microsoft 365 tenant management",
      "claude code skill",
      "powershell automation",
      "m365 admin",
      "conditional access policy",
      "user provisioning",
      "license management",
      "security compliance",
      "exchange online",
      "microsoft teams administration"
    ],
    "actual_capabilities": [
      "Generates step-by-step tenant setup checklists with phase-by-phase implementation plans",
      "Creates ready-to-use PowerShell scripts for Microsoft Graph, Exchange Online, and Teams administration",
      "Provides security baseline recommendations including MFA, Conditional Access, and audit logging",
      "Analyzes user roles and recommends appropriate Microsoft 365 license tiers (E3, E5, Business)",
      "Generates DNS record configurations for custom domain setup (MX, TXT, CNAME, SRV)",
      "Creates user onboarding and offboarding scripts with mailbox conversion and license removal"
    ],
    "limitations": [
      "Requires Global Administrator or role-based permissions to execute generated scripts",
      "Cannot directly execute scripts - generates PowerShell scripts for manual execution",
      "Some features require specific license tiers (E3, E5) or Premium P2 capabilities",
      "Microsoft Graph API rate limits apply for bulk operations"
    ],
    "use_cases": [
      {
        "target_user": "IT Administrators",
        "title": "New Tenant Deployment",
        "description": "Deploy a new Microsoft 365 tenant with security best practices, DNS configuration, and compliance settings for a company of any size."
      },
      {
        "target_user": "Security Teams",
        "title": "Security Hardening",
        "description": "Generate MFA enforcement scripts, Conditional Access policies, and security audit reports to harden tenant security posture."
      },
      {
        "target_user": "HR and IT Teams",
        "title": "User Lifecycle Management",
        "description": "Automate user onboarding with license assignment and create secure offboarding scripts with mailbox conversion and access revocation."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic Setup Request",
        "scenario": "Initial tenant configuration",
        "prompt": "Set up a new Microsoft 365 tenant for a [company size] person company including security best practices, DNS configuration, and recommended license distribution."
      },
      {
        "title": "Security Script",
        "scenario": "Generate security policy script",
        "prompt": "Create a PowerShell script to configure Conditional Access policy requiring MFA for all admin accounts in my tenant."
      },
      {
        "title": "User Management",
        "scenario": "Bulk user provisioning",
        "prompt": "Generate a PowerShell script to create 50 new users from a CSV file and assign Microsoft 365 Business Standard licenses to each."
      },
      {
        "title": "Compliance Report",
        "scenario": "Security audit and compliance",
        "prompt": "Create a comprehensive security audit script that checks MFA status, admin role assignments, inactive users, and generates a compliance report for my tenant."
      }
    ],
    "output_examples": [
      {
        "input": "Set up a Microsoft 365 tenant for a 100-person company with security best practices",
        "output": [
          "Phase 1: Initial Tenant Configuration (30 min) - Admin Center setup, organization profile",
          "Phase 2: Custom Domain Configuration (45 min) - DNS records for MX, SPF, DKIM, DMARC",
          "Phase 3: Security Baseline Configuration (60 min) - MFA enforcement, Conditional Access, named locations",
          "Generated PowerShell script: Initial_Tenant_Setup.ps1 with Connect-MgGraph, Set-OrganizationConfig",
          "License distribution: 5 E5 ($285/mo), 20 E3 ($720/mo), 70 Business Standard ($875/mo), 5 Business Basic ($30/mo)"
        ]
      },
      {
        "input": "Create a secure offboarding script for user john.doe@company.com",
        "output": [
          "Script generates: Disable account sign-in with Update-MgUser -AccountEnabled $false",
          "Revoke all active sessions with Revoke-MgUserSignInSession",
          "Convert mailbox to shared mailbox: Set-Mailbox -Identity $userEmail -Type Shared",
          "Remove all licenses: Set-MgUserLicense with RemoveLicenses parameter",
          "Configure auto-reply message and hide from Global Address List",
          "Export offboarding report to CSV for audit trail"
        ]
      }
    ],
    "best_practices": [
      "Test all generated PowerShell scripts in non-production environments before deploying to production tenants",
      "Use the -WhatIf parameter when available to preview script actions without making changes",
      "Follow the principle of least privilege by using specific admin roles instead of Global Administrator when possible"
    ],
    "anti_patterns": [
      "Do not execute generated scripts without reviewing the code first - always understand what each command does",
      "Avoid running scripts without proper backup and rollback procedures in place",
      "Do not hardcode credentials in scripts - use Azure Key Vault or managed identities for automation"
    ],
    "faq": [
      {
        "question": "What permissions are needed to use this skill?",
        "answer": "Global Administrator is required for full tenant setup. User Administrator for user management. Security Administrator for policies."
      },
      {
        "question": "Does this skill execute PowerShell commands?",
        "answer": "No. The skill generates PowerShell scripts as output strings. You must execute them separately in your environment."
      },
      {
        "question": "What Microsoft 365 licenses are supported?",
        "answer": "Supports all Microsoft 365 licenses including Business Basic, Business Standard, Business Premium, E3, and E5 tiers."
      },
      {
        "question": "Can I use this skill for hybrid AD environments?",
        "answer": "Yes, but additional configuration for Azure AD Connect is required. The skill focuses on cloud-based management."
      },
      {
        "question": "Does this skill work with PowerShell 7?",
        "answer": "Yes. Generated scripts are compatible with both PowerShell 7 and Windows PowerShell 5.1."
      },
      {
        "question": "How long does initial tenant setup take?",
        "answer": "Plan for approximately 3.5 hours for a complete setup across all 5 phases including security baseline and service configuration."
      }
    ]
  },
  "file_structure": [
    {
      "name": "expected_output.json",
      "type": "file",
      "path": "expected_output.json",
      "lines": 87
    },
    {
      "name": "HOW_TO_USE.md",
      "type": "file",
      "path": "HOW_TO_USE.md",
      "lines": 234
    },
    {
      "name": "powershell_generator.py",
      "type": "file",
      "path": "powershell_generator.py",
      "lines": 431
    },
    {
      "name": "sample_input.json",
      "type": "file",
      "path": "sample_input.json",
      "lines": 22
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md",
      "lines": 197
    },
    {
      "name": "tenant_setup.py",
      "type": "file",
      "path": "tenant_setup.py",
      "lines": 448
    },
    {
      "name": "user_management.py",
      "type": "file",
      "path": "user_management.py",
      "lines": 448
    }
  ]
}
