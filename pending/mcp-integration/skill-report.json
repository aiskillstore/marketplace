{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T09:26:28.882Z",
    "slug": "mcp-integration",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/mcp-integration",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "MCP Integration",
    "description": "This skill should be used when the user asks to \"add MCP server\", \"integrate MCP\", \"configure MCP in plugin\", \"use .mcp.json\", \"set up Model Context Protocol\", \"connect external service\", mentions \"${CLAUDE_PLUGIN_ROOT} with MCP\", or discusses MCP server types (SSE, stdio, HTTP, WebSocket). Provides comprehensive guidance for integrating Model Context Protocol servers into Claude Code plugins for external tool and service integration.",
    "summary": "This skill should be used when the user asks to \"add MCP server\", \"integrate MCP\", \"configure MCP in...",
    "icon": "ðŸ”Œ",
    "version": "0.1.0",
    "author": "Anthropic",
    "license": "Not specified",
    "category": "development",
    "tags": [
      "mcp",
      "integration",
      "api",
      "external-services",
      "protocol",
      "plugin-development",
      "oauth",
      "authentication",
      "servers"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is an official Anthropic skill providing documentation and guidance for MCP integration. No code execution, only configuration examples and best practices documentation.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 7,
    "total_lines": 2249,
    "audit_model": "claude",
    "audited_at": "2025-12-30T09:26:28.882Z"
  },
  "content": {
    "user_title": "MCP Integration Guide for Claude Code Plugins",
    "value_statement": "Enables Claude Code plugins to connect with external services, APIs, and databases through standardized Model Context Protocol servers with support for OAuth, tokens, and multiple transport types.",
    "seo_keywords": [
      "model context protocol",
      "mcp server",
      "claude code plugin integration",
      "external api connection",
      "oauth authentication",
      "sse server",
      "stdio server",
      "http rest api",
      "websocket real-time",
      "plugin development"
    ],
    "actual_capabilities": [
      "Configure MCP servers in plugins using .mcp.json or plugin.json",
      "Support for 4 server types: stdio (local process), SSE (server-sent events), HTTP (REST), and WebSocket",
      "Automatic OAuth authentication flow handling for cloud services",
      "Token-based and environment variable authentication",
      "Dynamic tool registration with mcp__plugin_<name>_<server>__<tool> naming",
      "Environment variable expansion including ${CLAUDE_PLUGIN_ROOT}",
      "Integration patterns for commands, agents, and multi-server plugins",
      "Comprehensive security best practices and error handling guidance"
    ],
    "limitations": [
      "Requires MCP server restart when configuration changes",
      "Tool names follow strict naming convention that may be verbose",
      "OAuth flows require browser interaction on first use",
      "Mutual TLS (mTLS) not directly supported, requires wrapper",
      "Environment variables must be set by user before plugin use"
    ],
    "use_cases": [
      {
        "title": "Connect to Hosted Cloud Services",
        "description": "Integrate with services like Asana, GitHub, or custom cloud APIs using SSE servers with automatic OAuth authentication",
        "target_user": "Plugin developers building integrations with SaaS platforms"
      },
      {
        "title": "Local Tool Integration",
        "description": "Bundle custom MCP servers with plugins to provide file system access, database queries, or custom local tools via stdio",
        "target_user": "Developers creating plugins with local file or database operations"
      },
      {
        "title": "REST API Integration",
        "description": "Connect to internal or external REST APIs using HTTP MCP servers with token-based authentication",
        "target_user": "Enterprise developers integrating with company APIs"
      },
      {
        "title": "Real-time Data Streaming",
        "description": "Implement WebSocket MCP servers for low-latency bidirectional communication and live data updates",
        "target_user": "Developers building collaborative or real-time features"
      }
    ],
    "prompt_templates": [
      {
        "title": "Add MCP Server to Plugin",
        "prompt": "I want to add an MCP server to my plugin that connects to [service name]. It should use [stdio/SSE/HTTP/WebSocket] and provide tools for [capabilities]. The authentication is [OAuth/token/env vars].",
        "scenario": "Starting a new MCP integration in an existing plugin"
      },
      {
        "title": "Configure OAuth SSE Server",
        "prompt": "Help me configure an SSE MCP server for [service name] at URL [url]. It should use OAuth authentication and I need to document the required scopes.",
        "scenario": "Setting up a cloud service integration with OAuth"
      },
      {
        "title": "Create Local stdio Server",
        "prompt": "I need to bundle a custom MCP server with my plugin that runs [npx package/python script/node script]. It needs access to [file paths/database/APIs] and should accept environment variables for [configuration].",
        "scenario": "Creating a local tool integration"
      },
      {
        "title": "Use MCP Tools in Command",
        "prompt": "I have an MCP server named [server-name] with tools [tool1, tool2]. Show me how to use these tools in a command that [desired functionality].",
        "scenario": "Implementing command logic that calls MCP tools"
      },
      {
        "title": "Debug MCP Connection Issues",
        "prompt": "My MCP server [server-name] isn't connecting. The configuration is [paste config]. Help me troubleshoot the issue.",
        "scenario": "Troubleshooting MCP integration problems"
      }
    ],
    "output_examples": [
      {
        "input": "Add an SSE MCP server for Asana to my plugin",
        "output": "Creates .mcp.json with: {\"asana\": {\"type\": \"sse\", \"url\": \"https://mcp.asana.com/sse\"}} and explains OAuth flow, tool naming convention (mcp__plugin_myplugin_asana__asana_create_task), and how to use in commands with allowed-tools"
      },
      {
        "input": "Configure a local filesystem MCP server using npx",
        "output": "Creates .mcp.json with: {\"filesystem\": {\"command\": \"npx\", \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\", \"${CLAUDE_PROJECT_DIR}\"]}} and explains ${CLAUDE_PLUGIN_ROOT} usage, tool registration, and security considerations"
      }
    ],
    "best_practices": [
      "Use dedicated .mcp.json file instead of inline mcpServers for better maintainability",
      "Always use ${CLAUDE_PLUGIN_ROOT} for portable file path references",
      "Document all required environment variables in plugin README with setup instructions",
      "Use HTTPS/WSS exclusively, never HTTP/WS for network connections",
      "Pre-allow specific MCP tools in commands, avoid wildcards for security",
      "Handle connection failures and tool errors gracefully with clear user messages",
      "Test MCP integration locally using /mcp command and claude --debug",
      "Let OAuth handle authentication automatically when available instead of manual tokens",
      "Use environment variables for tokens and credentials, never hardcode",
      "Batch similar MCP requests instead of making many individual calls"
    ],
    "anti_patterns": [
      "Hardcoding tokens or credentials directly in .mcp.json configuration files",
      "Using HTTP or WS instead of HTTPS/WSS for network connections",
      "Pre-allowing all tools with wildcards (mcp__plugin_*_*__*) in commands",
      "Hardcoding absolute file paths instead of using ${CLAUDE_PLUGIN_ROOT}",
      "Committing tokens or API keys to version control",
      "Making many individual MCP tool calls instead of batching queries",
      "Forgetting to document required environment variables in README",
      "Skipping error handling for MCP connection or tool call failures",
      "Using cat/echo/sed in stdio servers instead of proper JSON-RPC on stdin/stdout",
      "Deploying without testing using /mcp command and verifying tool availability"
    ],
    "faq": [
      {
        "question": "What's the difference between .mcp.json and mcpServers in plugin.json?",
        "answer": "Both work identically. .mcp.json is recommended for cleaner separation and easier maintenance, especially with multiple servers. Use mcpServers in plugin.json for simple single-server plugins."
      },
      {
        "question": "How do I find the full tool name for an MCP tool?",
        "answer": "Run the /mcp command in Claude Code to see all available MCP servers and their tools with full names following the format mcp__plugin_<plugin-name>_<server-name>__<tool-name>."
      },
      {
        "question": "Do I need to handle OAuth flows manually?",
        "answer": "No. For SSE and HTTP servers, Claude Code automatically handles the complete OAuth 2.0 flow including browser authentication, token storage, and refresh. Just configure the URL."
      },
      {
        "question": "When should I use stdio vs SSE vs HTTP vs WebSocket?",
        "answer": "Use stdio for local tools/custom servers, SSE for hosted services with OAuth, HTTP for REST APIs with token auth, and WebSocket for real-time bidirectional communication."
      },
      {
        "question": "How do I pass environment variables to my MCP server?",
        "answer": "For stdio servers, use the 'env' field in configuration. For network servers (SSE/HTTP/WS), use 'headers' with ${VARIABLE} syntax. Users must set these variables in their shell before running Claude Code."
      },
      {
        "question": "What happens if the MCP server fails to connect?",
        "answer": "Claude Code will log errors visible with --debug flag. Commands using MCP tools should handle connection failures gracefully and inform users to check configuration and authentication."
      },
      {
        "question": "Can I use multiple MCP servers in one plugin?",
        "answer": "Yes. Add multiple server configurations to .mcp.json. Each server's tools will be available with their own unique names. This enables workflows spanning multiple services."
      },
      {
        "question": "How do I debug MCP integration issues?",
        "answer": "Run 'claude --debug' to see connection attempts, authentication flows, and tool call errors. Use '/mcp' command to verify servers are connected and tools are available. Check that environment variables are set correctly."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "Claude Code plugin system",
        "MCP-compliant server (stdio/SSE/HTTP/WebSocket)",
        "Environment variables for authentication (user-provided)",
        "HTTPS/WSS endpoints for network servers",
        "Node.js/Python/other runtime for stdio servers"
      ],
      "permissions": [
        "Network access for SSE/HTTP/WebSocket servers",
        "Process spawning for stdio servers",
        "File system access for ${CLAUDE_PLUGIN_ROOT} resolution",
        "Environment variable access for ${VARIABLE} expansion",
        "Browser access for OAuth flows (SSE/HTTP)"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "http-server.json",
          "type": "file",
          "path": "examples/http-server.json"
        },
        {
          "name": "sse-server.json",
          "type": "file",
          "path": "examples/sse-server.json"
        },
        {
          "name": "stdio-server.json",
          "type": "file",
          "path": "examples/stdio-server.json"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "authentication.md",
          "type": "file",
          "path": "references/authentication.md"
        },
        {
          "name": "server-types.md",
          "type": "file",
          "path": "references/server-types.md"
        },
        {
          "name": "tool-usage.md",
          "type": "file",
          "path": "references/tool-usage.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}