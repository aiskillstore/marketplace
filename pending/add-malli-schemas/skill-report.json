{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T09:52:27.111Z",
    "slug": "add-malli-schemas",
    "source_url": "https://github.com/metabase/metabase/tree/master/add-malli-schemas",
    "source_ref": "master",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community"
  },
  "skill": {
    "name": "add-malli-schemas",
    "description": "Efficiently add Malli schemas to API endpoints in the Metabase codebase with proper patterns, validation timing, and error handling",
    "summary": "Efficiently add Malli schemas to API endpoints in the Metabase codebase with proper patterns, valida...",
    "icon": "ðŸ§°",
    "version": "1.0.0",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "clojure",
      "metabase",
      "malli",
      "api"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "No data access, network calls, or execution logic detected. Content is instructional Clojure schema guidance with no suspicious patterns.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 420,
    "audit_model": "codex",
    "audited_at": "2025-12-31T09:52:27.111Z"
  },
  "content": {
    "user_title": "Add Malli schemas to Metabase endpoints",
    "value_statement": "API endpoints often lack consistent validation and response schemas. This skill guides you to add Malli schemas with correct timing and patterns.",
    "seo_keywords": [
      "Malli schemas",
      "Metabase API",
      "Clojure validation",
      "Claude",
      "Codex",
      "Claude Code",
      "API schema patterns",
      "response validation",
      "request validation"
    ],
    "actual_capabilities": [
      "Explain route, query, body, and response schema structures",
      "Provide examples for named schemas and reusable patterns",
      "List preferred ms namespace schema types",
      "Highlight validation timing differences for requests and responses",
      "Offer checklists and pitfalls for correct schema usage"
    ],
    "limitations": [
      "Does not modify code automatically",
      "Focused on Metabase API endpoint patterns",
      "Does not validate schemas against a running system",
      "Assumes familiarity with Clojure and Malli"
    ],
    "use_cases": [
      {
        "target_user": "Backend engineer",
        "title": "Add schemas to new endpoint",
        "description": "Use guidance to define route, query, and body schemas plus a response schema for a new API handler."
      },
      {
        "target_user": "Reviewer",
        "title": "Audit schema completeness",
        "description": "Apply the checklist to verify optional params, defaults, and response types in a pull request."
      },
      {
        "target_user": "Maintainer",
        "title": "Refactor shared schemas",
        "description": "Identify repeated structures and convert them into named Malli schemas for reuse."
      }
    ],
    "prompt_templates": [
      {
        "title": "Add basic schemas",
        "scenario": "New GET endpoint with route and query params",
        "prompt": "Add Malli schemas for route id and optional query params include and limit. Use ms types and include a simple response schema."
      },
      {
        "title": "Validate request body",
        "scenario": "POST endpoint with JSON body fields",
        "prompt": "Define a request body schema for name, description, and parent_id. Mark optional fields and use ms/NonBlankString and ms/PositiveInt."
      },
      {
        "title": "Design response schema",
        "scenario": "Endpoint returns nested data",
        "prompt": "Create a named response schema for a nested map with lists of items. Use :sequential and :map correctly."
      },
      {
        "title": "Advanced validation timing",
        "scenario": "Endpoint returns Java time objects",
        "prompt": "Update the response schema to accept Java time objects. Explain why :any is needed for temporal fields."
      }
    ],
    "output_examples": [
      {
        "input": "Add schemas to a GET /:id/related endpoint and define the response shape",
        "output": [
          "Route params schema for :id uses ms/PositiveInt",
          "Named response schema ::RelatedEntity includes tables and fields lists",
          "Endpoint annotated with :- ::RelatedEntity for response validation",
          "Notes on using pos-int? versus ms/PositiveInt where appropriate"
        ]
      }
    ],
    "best_practices": [
      "Prefer ms namespace schemas for API params",
      "Define named schemas for reused structures",
      "Use :any for temporal response fields"
    ],
    "anti_patterns": [
      "Mixing route, query, and body params in one map",
      "Using ms/TemporalString in response schemas",
      "Omitting :optional true on optional query params"
    ],
    "faq": [
      {
        "question": "Which environments are supported?",
        "answer": "It targets the Metabase Clojure codebase and Malli schemas."
      },
      {
        "question": "Are there limits on schema complexity?",
        "answer": "Complex schemas are allowed, but clarity and reuse are recommended."
      },
      {
        "question": "Can it integrate with my build or tests?",
        "answer": "It provides guidance only and does not run build or tests."
      },
      {
        "question": "Does it access my data or secrets?",
        "answer": "No, it only provides static guidance and examples."
      },
      {
        "question": "What if validation fails after changes?",
        "answer": "Review optional fields, defaults, and response timing rules, then retest."
      },
      {
        "question": "How does it compare to generic schema tips?",
        "answer": "It is tailored to Metabase patterns and Malli usage details."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}