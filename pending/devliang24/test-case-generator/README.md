# 测试用例生成器 - Claude Skill

自动从需求文档生成结构化的功能测试用例，支持多种输入格式，输出符合规范的 Excel 文件。

## 🎯 适用场景

这个 Skill 专为业务测试工程师设计，用于：

- 从需求文档快速生成测试用例
- 提高测试用例编写效率
- 确保测试用例的规范性和完整性
- 覆盖正常流程、边界值、异常场景等多种测试场景

## ✨ 主要特性

- **多格式输入**：支持文字、图片、PDF、DOCX 等多种需求文档格式
- **智能解析**：自动识别功能点、业务流程、边界条件
- **全面覆盖**：生成正向、边界、异常、安全等多维度测试用例
- **标准输出**：严格遵循 15 字段规范，输出 Excel 文件
- **即用即走**：Claude 自动识别并调用，无需手动选择

## 📦 安装方法

### 1. 下载 Skill

将 `test-case-generator` 文件夹打包为 ZIP 文件。

### 2. 上传到 Claude

1. 打开 [Claude.ai](https://claude.ai)
2. 进入 **设置 (Settings)** > **功能 (Capabilities)** > **技能 (Skills)**
3. 点击 **上传自定义技能 (Upload custom skill)**
4. 选择打包好的 ZIP 文件
5. 上传完成后，确保技能处于**启用**状态

### 3. 启用代码执行

Skills 需要代码执行环境才能运行：
- 确保 **代码执行 (Code Execution)** 在设置中已启用

## 🚀 使用方法

### 基本使用流程

1. **提供需求文档**
   - 直接粘贴文字需求
   - 上传图片（流程图、UI截图）
   - 上传 PDF 或 DOCX 文件

2. **请求生成测试用例**
   - 说明："请根据这个需求文档生成测试用例"
   - Claude 会自动调用 test-case-generator Skill

3. **获取 Excel 文件**
   - Claude 自动生成符合规范的测试用例
   - 下载生成的 Excel 文件
   - 可直接导入测试管理系统

### 使用示例

**示例 1：粘贴文字需求**
```
用户: 
功能名称：用户登录
功能描述：用户通过用户名和密码登录系统...
[粘贴完整需求文档]

请生成测试用例。

Claude:
[自动调用 test-case-generator]
[分析需求]
[生成测试用例]
✅ 已生成测试用例文件：测试用例-用户登录-20260102.xlsx
```

**示例 2：上传 PDF 文档**
```
用户: 
[上传: 产品需求文档-v1.0.pdf]
请根据这个需求文档生成测试用例。

Claude:
[自动调用 test-case-generator]
[解析 PDF]
[生成测试用例]
✅ 已生成测试用例文件：测试用例-产品功能-20260102.xlsx

📊 测试用例统计：
- 总计：25 条
- 正向用例：15 条
- 异常用例：10 条
```

## 📋 输出格式

### Excel 文件结构

生成的 Excel 文件包含 **15 个标准字段**（按顺序）：

| 序号 | 字段名称 | 说明 |
|------|----------|------|
| 1 | 用例目录 | 测试用例所属的目录或平台名称 |
| 2 | 模块 | 测试用例所属的功能模块 |
| 3 | 功能 | 测试用例对应的具体功能点 |
| 4 | 用例名称 | 测试用例的标题 |
| 5 | 前置条件 | 执行测试前需要满足的条件 |
| 6 | 用例步骤 | 详细的操作步骤 |
| 7 | 测试数据 | 测试时使用的输入参数、文件等 |
| 8 | 预期结果 | 执行后应该得到的结果 |
| 9 | 实际结果 | 留空（测试执行时填写） |
| 10 | 用例类型 | 功能测试/安全测试/兼容性测试/易用性测试 |
| 11 | 用例类型（正向/异常） | 正向 或 异常 |
| 12 | 用例状态 | 待测试（默认值） |
| 13 | 用例等级 | 高/中/低 |
| 14 | 需求ID | 关联的需求编号 |
| 15 | 创建人 | AI助手 |

### 文件格式

- **文件名**：`测试用例-[需求名称]-[YYYYMMDD].xlsx`
- **表头**：第一行，粗体、背景色、居中对齐
- **数据行**：从第二行开始，每行一条测试用例
- **格式**：自动换行、自动调整列宽

详细字段说明请参考：`resources/field-spec.md`

### ✅ 统一口径（重要）
- 字段列必须完整且顺序固定（15 列）。
- `实际结果`：生成时必须留空。
- `需求ID`：需求文档未提供则留空。
- `用例类型`：仅限 功能测试 / 安全测试 / 兼容性测试 / 易用性测试。
- `用例类型（正向/异常）`：仅限 正向 / 异常。
- `用例状态`：默认“待测试”。
- `创建人`：固定“AI助手”。
- `前置条件`/`测试数据`：如无内容请填写“无”，不要留空。
- `用例步骤`/`预期结果`：在 Excel 单元格内使用换行分隔（建议使用 `\n`），不要把 `<br>` 当作真实输出内容。

## 🎨 测试覆盖策略

Skill 会自动生成以下类型的测试用例：

### 1. 正常流程测试（60-70%）
- 标准业务流程
- 常规操作场景
- 功能正确性验证

### 2. 边界值测试（15-20%）
- 输入参数的最小值、最大值
- 字段长度的边界
- 数值范围的极值

### 3. 异常场景测试（15-20%）
- 无效输入
- 缺失必填参数
- 状态异常
- 业务规则违反

### 4. 安全测试（如适用）
- 认证鉴权
- 权限控制
- 敏感数据处理

### 5. 兼容性测试（如适用）
- 浏览器兼容
- 数据格式兼容

### 6. 易用性测试（如适用）
- 操作流畅度
- 提示信息友好度

## 💡 最佳实践

### 编写需求文档的建议

为了获得更好的测试用例质量，建议需求文档包含：

1. **清晰的功能描述**
   - 功能名称
   - 功能目标
   - 使用场景

2. **详细的操作流程**
   - 用户操作步骤
   - 系统响应
   - 状态变化

3. **明确的业务规则**
   - 输入验证规则
   - 数据格式要求
   - 边界条件

4. **完整的错误处理**
   - 异常场景
   - 错误提示信息
   - 降级方案

### 自定义测试用例

你可以在请求中添加特定要求：

```
请根据这个需求文档生成测试用例，重点关注安全性测试。
```

```
请生成测试用例，用例数量控制在 20 条左右。
```

```
请生成详细的测试用例，每个步骤都要非常具体。
```

## 📝 示例参考

查看 `resources/examples.md` 了解完整的输入输出示例，包括：

- **用户登录功能**的需求文档和测试用例
- **文件上传功能**的需求文档和测试用例

## ❓ 常见问题

### Q: 生成的测试用例数量是多少？
A: 根据需求复杂度自动确定，通常包含 10-50 条用例，确保全面覆盖各种场景。

### Q: 可以生成其他格式的输出吗？
A: 默认生成 Excel 文件。如果需要其他格式（如 Markdown 表格），可以在请求中明确说明。

### Q: 如何确保用例符合我的规范？
A: Skill 严格遵循 15 字段规范。如果你有特定的命名或格式要求，可以在需求文档中说明，或在请求时额外指定。

### Q: 支持哪些语言的需求文档？
A: 支持中文和英文需求文档。

### Q: 生成的测试用例可以修改吗？
A: 当然可以。下载 Excel 文件后，你可以根据实际情况进行调整和补充。

### Q: 如何提供图片格式的需求？
A: 直接在对话中上传图片即可，支持流程图、UI 设计图、架构图等。

## 🔧 技术细节

### 文件结构

```
test-case-generator/
├── SKILL.md              # 技能定义文件
├── resources/
│   ├── field-spec.md     # 字段规范详细说明
│   └── examples.md       # 输入输出示例
└── README.md             # 本文档
```

### 依赖

- Python 3.x
- openpyxl 库（自动安装）

## 📄 许可证

本 Skill 为开源项目，可自由使用和修改。

## 🤝 反馈与支持

如果你有任何问题、建议或发现问题，欢迎反馈：

1. 在使用过程中直接向 Claude 提出改进建议
2. 修改 SKILL.md 文件以适应你的特定需求

---

**开始使用**：上传需求文档，让 Claude 帮你自动生成测试用例！ 🚀
