{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T17:05:55.697Z",
    "slug": "anthropics-xlsx",
    "source_url": "https://github.com/anthropics/skills/tree/main/skills/xlsx",
    "source_ref": "main",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "official"
  },
  "skill": {
    "name": "xlsx",
    "description": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas",
    "summary": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, dat...",
    "icon": "ðŸ“Š",
    "version": "1.0.0",
    "author": "Anthropic",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "office",
    "tags": [
      "spreadsheets",
      "excel",
      "formulas",
      "analysis",
      "automation"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill with a minimal review required. No security issues were identified in the reviewed files.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 495,
    "audit_model": "codex",
    "audited_at": "2025-12-31T17:05:55.697Z"
  },
  "content": {
    "user_title": "Recalculate and audit Excel formulas",
    "value_statement": "You need reliable spreadsheet recalculation and error checks after edits. This skill recalculates with LibreOffice and reports formula errors and locations.",
    "seo_keywords": [
      "Excel recalculation",
      "spreadsheet audit",
      "formula error check",
      "LibreOffice headless",
      "openpyxl workflow",
      "Claude",
      "Codex",
      "Claude Code",
      "xlsx automation"
    ],
    "actual_capabilities": [
      "Runs LibreOffice headless recalculation for a given Excel file",
      "Auto-configures a LibreOffice macro for recalculation on first use",
      "Scans all cells for Excel error strings like #REF! and #DIV/0!",
      "Reports error counts with up to 20 cell locations per error type",
      "Counts formulas across all sheets for context"
    ],
    "limitations": [
      "Requires LibreOffice and the soffice command on the system path",
      "Only detects errors present in stored cell values after recalculation",
      "Macro setup writes to the user LibreOffice profile directory",
      "Timeout handling depends on platform tools like timeout or gtimeout"
    ],
    "use_cases": [
      {
        "target_user": "Financial analyst",
        "title": "Validate model errors",
        "description": "Recalculate a forecast workbook and list any formula errors with cell locations."
      },
      {
        "target_user": "Data operations lead",
        "title": "Audit updated reports",
        "description": "Verify recalculated KPIs after bulk updates to a monthly reporting file."
      },
      {
        "target_user": "Automation engineer",
        "title": "Build CI spreadsheet checks",
        "description": "Run recalculation and error scans before exporting spreadsheets to stakeholders."
      }
    ],
    "prompt_templates": [
      {
        "title": "Recalculate a file",
        "scenario": "Basic formula refresh",
        "prompt": "Recalculate formulas in report.xlsx and summarize any Excel errors with locations."
      },
      {
        "title": "Check after edits",
        "scenario": "Post update validation",
        "prompt": "I modified inputs in model.xlsx. Recalculate and list any #REF! or #DIV/0! cells."
      },
      {
        "title": "Count formulas",
        "scenario": "Model complexity review",
        "prompt": "Recalculate kpi.xlsx and report total formulas plus any error locations."
      },
      {
        "title": "Large file audit",
        "scenario": "Timeout sensitive run",
        "prompt": "Recalculate big_model.xlsx with a 60 second timeout and summarize errors."
      }
    ],
    "output_examples": [
      {
        "input": "Recalculate sales.xlsx and report any formula errors.",
        "output": [
          "Status: errors_found",
          "Total errors: 2",
          "Error locations: Sheet1!B5 and Sheet2!C10",
          "Total formulas: 148"
        ]
      }
    ],
    "best_practices": [
      "Run recalculation after any formula or reference edits",
      "Review error locations and fix formulas before rechecking",
      "Use a longer timeout for large workbooks"
    ],
    "anti_patterns": [
      "Skipping recalculation after editing formulas",
      "Assuming values are updated without checking for errors",
      "Running without LibreOffice installed"
    ],
    "faq": [
      {
        "question": "Which file types are compatible?",
        "answer": "The script targets Excel workbooks readable by LibreOffice and openpyxl, such as .xlsx."
      },
      {
        "question": "What are the limits on file size?",
        "answer": "Very large files may need higher timeouts and can take longer to scan all cells."
      },
      {
        "question": "How can I integrate it into automation?",
        "answer": "Call recalc.py from a script and parse the JSON output to gate your pipeline."
      },
      {
        "question": "Is my data sent anywhere?",
        "answer": "No network calls are made. The file is processed locally with LibreOffice and openpyxl."
      },
      {
        "question": "What if recalculation fails?",
        "answer": "Check that soffice is installed, the macro is created, and raise the timeout if needed."
      },
      {
        "question": "How does this compare to Excel recalculation?",
        "answer": "It uses LibreOffice to recalculate headless, then scans for errors and reports locations."
      }
    ]
  },
  "file_structure": [
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "recalc.py",
      "type": "file",
      "path": "recalc.py"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}