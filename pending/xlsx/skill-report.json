{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T12:36:43.778Z",
    "slug": "xlsx",
    "source_url": "https://github.com/anthropics/skills/tree/main/skills/xlsx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "xlsx",
    "description": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas",
    "summary": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, dat...",
    "icon": "ðŸ“Š",
    "version": "1.0.0",
    "author": "Anthropic",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "data",
    "tags": [
      "excel",
      "spreadsheet",
      "xlsx",
      "formulas",
      "data-analysis",
      "pandas",
      "openpyxl",
      "financial-modeling",
      "csv"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "OFFICIAL Anthropic skill with standard file operations. Uses LibreOffice subprocess for formula recalculation with appropriate timeout controls. No dangerous patterns detected.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Subprocess execution with user-controlled file paths",
        "description": "The recalc.py script executes LibreOffice with user-provided file paths. While Path().absolute() is used to sanitize paths, users should only provide trusted file paths. This is acceptable for the intended use case of processing user's own Excel files.",
        "locations": [
          {
            "file": "recalc.py",
            "line_start": 70,
            "line_end": 76
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 498,
    "audit_model": "claude",
    "audited_at": "2025-12-30T12:36:43.778Z"
  },
  "content": {
    "user_title": "Excel Spreadsheet Creation & Analysis",
    "value_statement": "Create professional Excel spreadsheets with formulas, formatting, and data analysis capabilities, including automatic formula recalculation and error detection for zero-error financial models.",
    "seo_keywords": [
      "excel",
      "spreadsheet",
      "xlsx",
      "formulas",
      "financial modeling",
      "data analysis",
      "pandas",
      "openpyxl",
      "csv",
      "data visualization",
      "formula recalculation"
    ],
    "actual_capabilities": [
      "Create new Excel files with formulas, formatting, and styling",
      "Edit existing Excel files while preserving formulas and formatting",
      "Read and analyze data from Excel, CSV, and TSV files using pandas",
      "Apply professional formatting including fonts, colors, and cell styles",
      "Recalculate all formulas using LibreOffice integration",
      "Detect and report formula errors (#REF!, #DIV/0!, #VALUE!, etc.)",
      "Build financial models with color-coded inputs and industry-standard formatting",
      "Work with multiple sheets and cross-sheet references",
      "Insert/delete rows and columns programmatically"
    ],
    "limitations": [
      "Requires LibreOffice to be installed for formula recalculation",
      "Formula recalculation requires subprocess execution (timeout configurable)",
      "Very large files may require read_only or write_only modes for performance",
      "Files opened with data_only=True permanently lose formulas if saved",
      "Complex VBA macros are not supported",
      "Recalculation timeout defaults to 30 seconds (configurable)"
    ],
    "use_cases": [
      {
        "title": "Financial Model Building",
        "description": "Create professional financial models with color-coded assumptions (blue), formulas (black), and cross-sheet references (green). Automatically verify zero formula errors and apply industry-standard formatting for currency, percentages, and years.",
        "target_user": "Financial analysts, investment bankers, corporate finance professionals"
      },
      {
        "title": "Data Analysis & Reporting",
        "description": "Read data from Excel files, perform statistical analysis with pandas, create visualizations, and export results back to formatted Excel reports with charts and styling.",
        "target_user": "Data analysts, business analysts, researchers"
      },
      {
        "title": "Template Modification",
        "description": "Update existing Excel templates while preserving all formulas, formatting, and structure. Perfect for recurring reports that need data updates without rebuilding the template.",
        "target_user": "Operations teams, accountants, report generators"
      },
      {
        "title": "Bulk Data Processing",
        "description": "Process CSV or TSV files, apply transformations, add formulas and formatting, then export to professional Excel format with calculated fields.",
        "target_user": "Data engineers, ETL developers, automation specialists"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Financial Projection Model",
        "prompt": "Create a 5-year revenue projection model in Excel with: (1) Blue-colored assumption cells for growth rate and starting revenue, (2) Black-colored formula cells calculating revenue for each year, (3) A summary section showing CAGR. Format currency as $#,##0 with units in headers. Ensure zero formula errors.",
        "scenario": "Building a financial forecast with industry-standard formatting"
      },
      {
        "title": "Analyze Sales Data",
        "prompt": "Read sales_data.xlsx and create a summary showing: (1) Total sales by region, (2) Month-over-month growth rates, (3) Top 10 products by revenue. Export results to a new formatted Excel file with charts.",
        "scenario": "Analyzing existing data and creating formatted reports"
      },
      {
        "title": "Update Monthly Template",
        "prompt": "Update monthly_report_template.xlsx with new data from data.csv. Preserve all existing formulas and formatting. Just update the data range B5:D50 with the new values. Recalculate all formulas and verify zero errors.",
        "scenario": "Updating recurring reports without rebuilding templates"
      },
      {
        "title": "Build Valuation Model",
        "prompt": "Create a DCF valuation model with: (1) 10-year projections, (2) Terminal value calculation, (3) WACC assumptions in yellow-highlighted cells, (4) NPV calculation. Use formulas for everything - no hardcoded calculations. Format multiples as 0.0x and ensure zero errors.",
        "scenario": "Building complex financial models with validation"
      }
    ],
    "output_examples": [
      {
        "input": "Create a simple budget tracker with income, expenses, and savings calculations",
        "output": "Excel file with: (1) Blue text for income/expense inputs, (2) Black formulas for totals and savings (=Income-Expenses), (3) Percentage calculations for savings rate, (4) Formatted currency with $#,##0 format, (5) Zero formula errors verified by recalc.py"
      },
      {
        "input": "Analyze quarterly_sales.xlsx and show top performing products",
        "output": "Python analysis using pandas showing summary statistics, then formatted Excel output with: (1) Sorted product rankings, (2) Revenue and growth formulas, (3) Conditional formatting highlighting top performers, (4) Summary charts"
      }
    ],
    "best_practices": [
      "Always use Excel formulas instead of hardcoding calculated values in Python",
      "Run recalc.py after creating/modifying files with formulas to ensure all values are calculated",
      "Check recalc.py JSON output for errors and fix any #REF!, #DIV/0!, or #VALUE! errors",
      "Use color coding for financial models: blue for inputs, black for formulas, green for cross-sheet references",
      "Test formulas on 2-3 sample cells before applying to entire ranges",
      "Never open with data_only=True and save, as it permanently replaces formulas with values",
      "Place assumptions in separate cells and reference them in formulas rather than hardcoding values",
      "Format zeros as dashes using custom format: $#,##0;($#,##0);-",
      "Document data sources for hardcoded values with comments including source, date, and URL",
      "Verify cell references are correct (remember Excel is 1-indexed, DataFrame is 0-indexed)"
    ],
    "anti_patterns": [
      "Calculating values in Python and hardcoding results instead of using Excel formulas",
      "Opening files with data_only=True and saving them (loses all formulas permanently)",
      "Skipping formula recalculation after modifying Excel files",
      "Ignoring error output from recalc.py script",
      "Hardcoding assumptions in formulas instead of referencing assumption cells",
      "Using inconsistent number formatting across financial models",
      "Not testing formulas with edge cases (zeros, negatives, nulls)",
      "Overwriting existing template conventions with standardized formatting"
    ],
    "faq": [
      {
        "question": "Why are my formula cells showing the formula text instead of calculated values?",
        "answer": "Excel files created by openpyxl contain formulas but not calculated values. Run 'python recalc.py yourfile.xlsx' to recalculate all formulas using LibreOffice. The script returns JSON showing any errors found."
      },
      {
        "question": "What does it mean when recalc.py returns errors_found status?",
        "answer": "The error_summary field shows which formula errors were found and their locations. Common errors: #REF! (invalid cell reference), #DIV/0! (division by zero), #VALUE! (wrong data type). Fix the errors in your Python code and regenerate the file."
      },
      {
        "question": "Should I use pandas or openpyxl for my task?",
        "answer": "Use pandas for data analysis, statistics, and bulk operations. Use openpyxl when you need formulas, complex formatting, or Excel-specific features like merged cells and conditional formatting."
      },
      {
        "question": "How do I preserve formulas when editing an existing Excel file?",
        "answer": "Load with openpyxl using load_workbook('file.xlsx') (without data_only=True). Make your changes, save, then run recalc.py to update calculated values. Never use data_only=True when saving."
      },
      {
        "question": "What are the color coding standards for financial models?",
        "answer": "Blue text for inputs/assumptions, black for formulas, green for cross-sheet references, red for external links, yellow background for key assumptions. These are industry standards unless the existing template uses different conventions."
      },
      {
        "question": "Do I need LibreOffice installed?",
        "answer": "Yes, LibreOffice is required for formula recalculation via recalc.py. The script automatically configures the necessary macro on first run. Works on both Linux and macOS."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "python3",
        "openpyxl",
        "pandas",
        "LibreOffice"
      ],
      "permissions": [
        "file-read",
        "file-write",
        "subprocess-execution"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "recalc.py",
      "type": "file",
      "path": "recalc.py"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}