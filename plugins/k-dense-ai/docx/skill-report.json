{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-04T17:14:25.949Z",
    "slug": "k-dense-ai-docx",
    "source_url": "https://github.com/K-Dense-AI/claude-scientific-skills/tree/main/scientific-skills/document-skills/docx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "d2e7652f8c5e710ed6583c8fd8c4d8dd314f43dab2a15309613c0a784c34fed2",
    "tree_hash": "d4f63a24ebbb753352a5e1718112e5f11c2fd8ecbfe73df9dfb88c595de51dfb"
  },
  "skill": {
    "name": "docx",
    "description": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation, text extraction, for professional document processing.",
    "summary": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation,...",
    "icon": "ðŸ“„",
    "version": "1.0.0",
    "author": "K-Dense-AI",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "office",
    "tags": [
      "docx",
      "ooxml",
      "tracked-changes",
      "comments",
      "validation"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "filesystem",
      "external_commands",
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a legitimate document processing skill with controlled filesystem access and secure XML parsing. Uses defusedxml library to prevent XXE attacks. External commands (soffice, git) are called with hardcoded paths and controlled arguments. Operations are confined to user-specified files within designated workspaces.",
    "risk_factor_evidence": [
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/document.py",
            "line_start": 634,
            "line_end": 642
          },
          {
            "file": "scripts/utilities.py",
            "line_start": 55,
            "line_end": 74
          },
          {
            "file": "ooxml/scripts/unpack.py",
            "line_start": 14,
            "line_end": 17
          },
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 64,
            "line_end": 79
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 116
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 153,
            "line_end": 163
          }
        ]
      },
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 1,
            "line_end": 160
          },
          {
            "file": "ooxml/scripts/unpack.py",
            "line_start": 1,
            "line_end": 29
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [
      {
        "title": "External command execution for validation",
        "description": "The skill executes external commands (soffice and git) via subprocess.run for document validation and diff comparison. While arguments are controlled, external command execution inherently carries risk. An attacker with control over document content could potentially craft input that causes unexpected behavior.\n\nCode: pack.py lines 103-116 uses subprocess.run(['soffice', '--headless', '--convert-to', ...]) for validation",
        "locations": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 116
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 153,
            "line_end": 163
          }
        ]
      }
    ],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 23,
    "total_lines": 5590,
    "audit_model": "claude",
    "audited_at": "2026-01-04T17:14:25.949Z"
  },
  "content": {
    "user_title": "Create and edit Word documents",
    "value_statement": "Professional document processing requires granular control over Word files. This skill provides full DOCX manipulation including tracked changes, comments, and XML-level document editing for precise control.",
    "seo_keywords": [
      "docx",
      "Word document",
      "tracked changes",
      "OOXML",
      "document editing",
      "comments",
      "redlining",
      "formatting",
      "Claude",
      "Codex",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Create new Word documents using docx-js library",
      "Edit existing documents with XML-level control",
      "Add and manage comments in documents",
      "Implement tracked changes and redlining workflows",
      "Validate documents against OOXML schemas",
      "Extract text from documents using pandoc"
    ],
    "limitations": [
      "Requires external tools (pandoc, LibreOffice, git) for full functionality",
      "Editing requires unpacking documents to temporary directories",
      "Tracked changes validation only checks changes by Scientific-Writer author",
      "Schema validation compares against original file errors"
    ],
    "use_cases": [
      {
        "target_user": "Legal professionals",
        "title": "Document review",
        "description": "Apply tracked changes to contracts and legal documents with proper redlining for professional review workflows."
      },
      {
        "target_user": "Academic researchers",
        "title": "Manuscript editing",
        "description": "Edit research papers with tracked changes for collaborative writing and peer review processes."
      },
      {
        "target_user": "Technical writers",
        "title": "Documentation updates",
        "description": "Create and update technical documentation with precise formatting and comment tracking."
      }
    ],
    "prompt_templates": [
      {
        "title": "Extract text",
        "scenario": "Read document content",
        "prompt": "Extract the text content from document.docx showing all tracked changes"
      },
      {
        "title": "Create document",
        "scenario": "Create new Word file",
        "prompt": "Create a new Word document with a title heading, three paragraphs with different heading levels, and a bulleted list"
      },
      {
        "title": "Edit with tracking",
        "scenario": "Apply tracked changes",
        "prompt": "Edit document.docx to change '30 days' to '60 days' in paragraph 3, using proper tracked changes with Scientific-Writer as the author"
      },
      {
        "title": "Advanced redlining",
        "scenario": "Complex document edits",
        "prompt": "Review the attached contract document and implement all requested changes in batches, using the redlining workflow with proper RSID handling and validation"
      }
    ],
    "output_examples": [
      {
        "input": "Create a new Word document with a title 'Quarterly Report' centered, a subtitle with the date, and three section headings with paragraphs.",
        "output": [
          "âœ“ Created document: QuarterlyReport.docx",
          "  - Title: 'Quarterly Report' (centered, 28pt bold Arial)",
          "  - Subtitle: 'January 2025' (centered, 16pt Arial)",
          "  - Section 1: 'Executive Summary' (Heading1, 24pt bold)",
          "  - Section 2: 'Financial Results' (Heading1, 24pt bold)",
          "  - Section 3: 'Next Quarter Outlook' (Heading1, 24pt bold)",
          "  - Default font: Arial 12pt"
        ]
      }
    ],
    "best_practices": [
      "Always unpack documents before editing and pack them back afterward using the provided scripts",
      "Use the redlining workflow for editing documents that will be reviewed by others",
      "Apply proper RSID attributes when making tracked changes to ensure Word compatibility",
      "Validate documents after editing to catch XML schema and relationship errors early"
    ],
    "anti_patterns": [
      "Do not use \\n for line breaks in docx-js - use separate Paragraph elements instead",
      "Do not modify text directly inside another author's tracked changes without proper nesting",
      "Do not skip validation after editing - it catches schema violations and broken references",
      "Do not assume line numbers are stable - grep document.xml immediately before writing scripts"
    ],
    "faq": [
      {
        "question": "Which file formats are supported?",
        "answer": "Supports .docx (Word), .pptx (PowerPoint), and .xlsx (Excel) files for basic operations. Document editing features focus on DOCX."
      },
      {
        "question": "What are the document size limits?",
        "answer": "No hard limits. Large documents with hundreds of pages can be processed. Performance depends on available memory for XML parsing."
      },
      {
        "question": "Can this integrate with other tools?",
        "answer": "Yes. Works with pandoc for text extraction, LibreOffice for validation, and git for diff comparison. Install dependencies per SKILL.md instructions."
      },
      {
        "question": "Is document data safe?",
        "answer": "Documents are processed in user-specified directories only. Uses defusedxml to prevent XML attacks. Temporary directories are cleaned up after processing."
      },
      {
        "question": "Why does validation fail?",
        "answer": "Common causes include broken file references, duplicate IDs, missing content types, or XML schema violations. Run validate.py with --verbose for details."
      },
      {
        "question": "How does this compare to python-docx?",
        "answer": "This skill provides lower-level OOXML access for precise control over tracked changes and comments. python-docx offers simpler high-level API but less granularity."
      }
    ]
  },
  "file_structure": [
    {
      "name": "ooxml",
      "type": "dir",
      "path": "ooxml",
      "children": [
        {
          "name": "schemas",
          "type": "dir",
          "path": "ooxml/schemas",
          "children": [
            {
              "name": "ecma",
              "type": "dir",
              "path": "ooxml/schemas/ecma",
              "children": [
                {
                  "name": "fouth-edition",
                  "type": "dir",
                  "path": "ooxml/schemas/ecma/fouth-edition"
                }
              ]
            },
            {
              "name": "ISO-IEC29500-4_2016",
              "type": "dir",
              "path": "ooxml/schemas/ISO-IEC29500-4_2016",
              "children": [
                {
                  "name": "dml-chart.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chart.xsd"
                },
                {
                  "name": "dml-chartDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chartDrawing.xsd"
                },
                {
                  "name": "dml-diagram.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-diagram.xsd"
                },
                {
                  "name": "dml-lockedCanvas.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-lockedCanvas.xsd"
                },
                {
                  "name": "dml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-main.xsd"
                },
                {
                  "name": "dml-picture.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-picture.xsd"
                },
                {
                  "name": "dml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "dml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "pml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/pml.xsd"
                },
                {
                  "name": "shared-additionalCharacteristics.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-additionalCharacteristics.xsd"
                },
                {
                  "name": "shared-bibliography.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-bibliography.xsd"
                },
                {
                  "name": "shared-commonSimpleTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-commonSimpleTypes.xsd"
                },
                {
                  "name": "shared-customXmlDataProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlDataProperties.xsd"
                },
                {
                  "name": "shared-customXmlSchemaProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlSchemaProperties.xsd"
                },
                {
                  "name": "shared-documentPropertiesCustom.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesCustom.xsd"
                },
                {
                  "name": "shared-documentPropertiesExtended.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesExtended.xsd"
                },
                {
                  "name": "shared-documentPropertiesVariantTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesVariantTypes.xsd"
                },
                {
                  "name": "shared-math.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-math.xsd"
                },
                {
                  "name": "shared-relationshipReference.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-relationshipReference.xsd"
                },
                {
                  "name": "sml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/sml.xsd"
                },
                {
                  "name": "vml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-main.xsd"
                },
                {
                  "name": "vml-officeDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-officeDrawing.xsd"
                },
                {
                  "name": "vml-presentationDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-presentationDrawing.xsd"
                },
                {
                  "name": "vml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "vml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "wml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/wml.xsd"
                },
                {
                  "name": "xml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/xml.xsd"
                }
              ]
            },
            {
              "name": "mce",
              "type": "dir",
              "path": "ooxml/schemas/mce",
              "children": [
                {
                  "name": "mc.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/mce/mc.xsd"
                }
              ]
            },
            {
              "name": "microsoft",
              "type": "dir",
              "path": "ooxml/schemas/microsoft",
              "children": [
                {
                  "name": "wml-2010.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2010.xsd"
                },
                {
                  "name": "wml-2012.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2012.xsd"
                },
                {
                  "name": "wml-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2018.xsd"
                },
                {
                  "name": "wml-cex-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cex-2018.xsd"
                },
                {
                  "name": "wml-cid-2016.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cid-2016.xsd"
                },
                {
                  "name": "wml-sdtdatahash-2020.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-sdtdatahash-2020.xsd"
                },
                {
                  "name": "wml-symex-2015.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-symex-2015.xsd"
                }
              ]
            }
          ]
        },
        {
          "name": "scripts",
          "type": "dir",
          "path": "ooxml/scripts",
          "children": [
            {
              "name": "validation",
              "type": "dir",
              "path": "ooxml/scripts/validation",
              "children": [
                {
                  "name": "__init__.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/__init__.py"
                },
                {
                  "name": "base.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/base.py"
                },
                {
                  "name": "docx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/docx.py"
                },
                {
                  "name": "pptx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/pptx.py"
                },
                {
                  "name": "redlining.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/redlining.py"
                }
              ]
            },
            {
              "name": "pack.py",
              "type": "file",
              "path": "ooxml/scripts/pack.py"
            },
            {
              "name": "unpack.py",
              "type": "file",
              "path": "ooxml/scripts/unpack.py"
            },
            {
              "name": "validate.py",
              "type": "file",
              "path": "ooxml/scripts/validate.py"
            }
          ]
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "templates",
          "type": "dir",
          "path": "scripts/templates",
          "children": [
            {
              "name": "comments.xml",
              "type": "file",
              "path": "scripts/templates/comments.xml"
            },
            {
              "name": "commentsExtended.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtended.xml"
            },
            {
              "name": "commentsExtensible.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtensible.xml"
            },
            {
              "name": "commentsIds.xml",
              "type": "file",
              "path": "scripts/templates/commentsIds.xml"
            },
            {
              "name": "people.xml",
              "type": "file",
              "path": "scripts/templates/people.xml"
            }
          ]
        },
        {
          "name": "__init__.py",
          "type": "file",
          "path": "scripts/__init__.py"
        },
        {
          "name": "document.py",
          "type": "file",
          "path": "scripts/document.py"
        },
        {
          "name": "utilities.py",
          "type": "file",
          "path": "scripts/utilities.py"
        }
      ]
    },
    {
      "name": "docx-js.md",
      "type": "file",
      "path": "docx-js.md"
    },
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "ooxml.md",
      "type": "file",
      "path": "ooxml.md"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
