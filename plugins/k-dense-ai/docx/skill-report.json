{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-03T05:01:23.139Z",
    "slug": "k-dense-ai-docx",
    "source_url": "https://github.com/K-Dense-AI/claude-scientific-skills/tree/main/scientific-skills/document-skills/docx",
    "source_ref": "main",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community"
  },
  "skill": {
    "name": "docx",
    "description": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation, text extraction, for professional document processing.",
    "summary": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation,...",
    "icon": "ðŸ“„",
    "version": "1.0.0",
    "author": "K-Dense-AI",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "office",
    "tags": [
      "docx",
      "ooxml",
      "tracked-changes",
      "comments",
      "validation"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "filesystem",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "The skill performs local OOXML unpacking, editing, and validation. It runs optional external commands for validation and diffing but shows no network or credential access behavior.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "ooxml/scripts/unpack.py",
            "line_start": 1,
            "line_end": 2
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/document.py",
            "line_start": 639,
            "line_end": 646
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 115
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 153,
            "line_end": 195
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "External commands used for validation",
        "description": "Validation uses external binaries via `subprocess.run([\"soffice\", \"--headless\", \"--convert-to\", ...])` and `subprocess.run([\"git\", \"diff\", ...])`. If a malicious binary is on PATH, it could execute unintended code when validation runs.",
        "locations": [
          {
            "file": "ooxml/scripts/pack.py",
            "line_start": 103,
            "line_end": 115
          },
          {
            "file": "ooxml/scripts/validation/redlining.py",
            "line_start": 153,
            "line_end": 195
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 61,
    "total_lines": 25245,
    "audit_model": "codex",
    "audited_at": "2026-01-03T05:01:23.139Z"
  },
  "content": {
    "user_title": "Create and edit DOCX with tracked changes",
    "value_statement": "Manual DOCX edits are slow and error prone. This skill unpacks files, edits OOXML, and repacks documents with tracked changes and validation support.",
    "seo_keywords": [
      "docx editor",
      "ooxml toolkit",
      "tracked changes automation",
      "docx comments",
      "document validation",
      "Claude",
      "Codex",
      "Claude Code",
      "Word OOXML",
      "docx unpack pack"
    ],
    "actual_capabilities": [
      "Unpack DOCX, PPTX, or XLSX files into formatted XML",
      "Repack an OOXML directory into a valid Office file",
      "Insert and edit XML nodes by tag, attributes, or line number",
      "Add comments and replies with tracked change metadata",
      "Validate DOCX structure and redlining consistency"
    ],
    "limitations": [
      "Requires Python with defusedxml and lxml installed",
      "Validation depends on external tools like soffice or git",
      "Works on OOXML directories, not legacy .doc files",
      "No built in network integrations"
    ],
    "use_cases": [
      {
        "target_user": "Legal editor",
        "title": "Redline contract updates",
        "description": "Apply tracked changes and reviewer comments while preserving existing formatting."
      },
      {
        "target_user": "Research staff",
        "title": "Annotate manuscript drafts",
        "description": "Insert structured comments and revisions into DOCX manuscripts."
      },
      {
        "target_user": "Ops analyst",
        "title": "Batch validate templates",
        "description": "Unpack and validate docx templates for schema and redlining issues."
      }
    ],
    "prompt_templates": [
      {
        "title": "Unpack a DOCX",
        "scenario": "Beginner unpack and review XML",
        "prompt": "Unpack report.docx into ./unpacked and list key XML files I should review for text and comments."
      },
      {
        "title": "Add a comment",
        "scenario": "Add a comment to a paragraph",
        "prompt": "Using the Document library, add a comment to the paragraph at line 420 in word/document.xml with the text: Please verify the citation."
      },
      {
        "title": "Track a deletion",
        "scenario": "Apply tracked deletion to a phrase",
        "prompt": "Find the run containing the phrase \"30 days\" and mark only the number for deletion with tracked changes."
      },
      {
        "title": "Validate and repack",
        "scenario": "Advanced end to end workflow",
        "prompt": "Repack ./unpacked into reviewed.docx, validate it, and report any schema or redlining issues found."
      }
    ],
    "output_examples": [
      {
        "input": "Unpack proposal.docx and summarize where comments are stored.",
        "output": [
          "Unpacked to ./proposal_unpacked",
          "Comments stored in word/comments.xml",
          "Comment references appear in word/document.xml"
        ]
      }
    ],
    "best_practices": [
      "Work in a copy of the unpacked directory",
      "Validate after each batch of tracked changes",
      "Use line based node lookup to avoid wrong edits"
    ],
    "anti_patterns": [
      "Editing document.xml without updating comment relationship files",
      "Packing files without validating schema changes",
      "Replacing full paragraphs for small text edits"
    ],
    "faq": [
      {
        "question": "Which file types are supported?",
        "answer": "Unpack and pack support docx, pptx, and xlsx. Validation is focused on docx and pptx."
      },
      {
        "question": "What are the main limits?",
        "answer": "It works on unpacked OOXML directories and needs Python dependencies and optional external tools."
      },
      {
        "question": "Can it integrate with other tools?",
        "answer": "Yes, it can be used alongside external editors or scripts that operate on the unpacked files."
      },
      {
        "question": "Is my data sent to external services?",
        "answer": "No network calls are present. All operations are local file edits and validations."
      },
      {
        "question": "Why did validation fail?",
        "answer": "Schema or redlining rules can fail after edits. Recheck XML structure and tracked change patterns."
      },
      {
        "question": "How does it compare to docx-js?",
        "answer": "This skill focuses on OOXML edits and tracked changes, while docx-js is a separate library for new docs."
      }
    ]
  },
  "file_structure": [
    {
      "name": "ooxml",
      "type": "dir",
      "path": "ooxml",
      "children": [
        {
          "name": "schemas",
          "type": "dir",
          "path": "ooxml/schemas",
          "children": [
            {
              "name": "ecma",
              "type": "dir",
              "path": "ooxml/schemas/ecma",
              "children": [
                {
                  "name": "fouth-edition",
                  "type": "dir",
                  "path": "ooxml/schemas/ecma/fouth-edition"
                }
              ]
            },
            {
              "name": "ISO-IEC29500-4_2016",
              "type": "dir",
              "path": "ooxml/schemas/ISO-IEC29500-4_2016",
              "children": [
                {
                  "name": "dml-chart.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chart.xsd"
                },
                {
                  "name": "dml-chartDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-chartDrawing.xsd"
                },
                {
                  "name": "dml-diagram.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-diagram.xsd"
                },
                {
                  "name": "dml-lockedCanvas.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-lockedCanvas.xsd"
                },
                {
                  "name": "dml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-main.xsd"
                },
                {
                  "name": "dml-picture.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-picture.xsd"
                },
                {
                  "name": "dml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "dml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/dml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "pml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/pml.xsd"
                },
                {
                  "name": "shared-additionalCharacteristics.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-additionalCharacteristics.xsd"
                },
                {
                  "name": "shared-bibliography.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-bibliography.xsd"
                },
                {
                  "name": "shared-commonSimpleTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-commonSimpleTypes.xsd"
                },
                {
                  "name": "shared-customXmlDataProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlDataProperties.xsd"
                },
                {
                  "name": "shared-customXmlSchemaProperties.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-customXmlSchemaProperties.xsd"
                },
                {
                  "name": "shared-documentPropertiesCustom.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesCustom.xsd"
                },
                {
                  "name": "shared-documentPropertiesExtended.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesExtended.xsd"
                },
                {
                  "name": "shared-documentPropertiesVariantTypes.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-documentPropertiesVariantTypes.xsd"
                },
                {
                  "name": "shared-math.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-math.xsd"
                },
                {
                  "name": "shared-relationshipReference.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/shared-relationshipReference.xsd"
                },
                {
                  "name": "sml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/sml.xsd"
                },
                {
                  "name": "vml-main.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-main.xsd"
                },
                {
                  "name": "vml-officeDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-officeDrawing.xsd"
                },
                {
                  "name": "vml-presentationDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-presentationDrawing.xsd"
                },
                {
                  "name": "vml-spreadsheetDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-spreadsheetDrawing.xsd"
                },
                {
                  "name": "vml-wordprocessingDrawing.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/vml-wordprocessingDrawing.xsd"
                },
                {
                  "name": "wml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/wml.xsd"
                },
                {
                  "name": "xml.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/ISO-IEC29500-4_2016/xml.xsd"
                }
              ]
            },
            {
              "name": "mce",
              "type": "dir",
              "path": "ooxml/schemas/mce",
              "children": [
                {
                  "name": "mc.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/mce/mc.xsd"
                }
              ]
            },
            {
              "name": "microsoft",
              "type": "dir",
              "path": "ooxml/schemas/microsoft",
              "children": [
                {
                  "name": "wml-2010.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2010.xsd"
                },
                {
                  "name": "wml-2012.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2012.xsd"
                },
                {
                  "name": "wml-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-2018.xsd"
                },
                {
                  "name": "wml-cex-2018.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cex-2018.xsd"
                },
                {
                  "name": "wml-cid-2016.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-cid-2016.xsd"
                },
                {
                  "name": "wml-sdtdatahash-2020.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-sdtdatahash-2020.xsd"
                },
                {
                  "name": "wml-symex-2015.xsd",
                  "type": "file",
                  "path": "ooxml/schemas/microsoft/wml-symex-2015.xsd"
                }
              ]
            }
          ]
        },
        {
          "name": "scripts",
          "type": "dir",
          "path": "ooxml/scripts",
          "children": [
            {
              "name": "validation",
              "type": "dir",
              "path": "ooxml/scripts/validation",
              "children": [
                {
                  "name": "__init__.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/__init__.py"
                },
                {
                  "name": "base.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/base.py"
                },
                {
                  "name": "docx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/docx.py"
                },
                {
                  "name": "pptx.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/pptx.py"
                },
                {
                  "name": "redlining.py",
                  "type": "file",
                  "path": "ooxml/scripts/validation/redlining.py"
                }
              ]
            },
            {
              "name": "pack.py",
              "type": "file",
              "path": "ooxml/scripts/pack.py"
            },
            {
              "name": "unpack.py",
              "type": "file",
              "path": "ooxml/scripts/unpack.py"
            },
            {
              "name": "validate.py",
              "type": "file",
              "path": "ooxml/scripts/validate.py"
            }
          ]
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "templates",
          "type": "dir",
          "path": "scripts/templates",
          "children": [
            {
              "name": "comments.xml",
              "type": "file",
              "path": "scripts/templates/comments.xml"
            },
            {
              "name": "commentsExtended.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtended.xml"
            },
            {
              "name": "commentsExtensible.xml",
              "type": "file",
              "path": "scripts/templates/commentsExtensible.xml"
            },
            {
              "name": "commentsIds.xml",
              "type": "file",
              "path": "scripts/templates/commentsIds.xml"
            },
            {
              "name": "people.xml",
              "type": "file",
              "path": "scripts/templates/people.xml"
            }
          ]
        },
        {
          "name": "__init__.py",
          "type": "file",
          "path": "scripts/__init__.py"
        },
        {
          "name": "document.py",
          "type": "file",
          "path": "scripts/document.py"
        },
        {
          "name": "utilities.py",
          "type": "file",
          "path": "scripts/utilities.py"
        }
      ]
    },
    {
      "name": "docx-js.md",
      "type": "file",
      "path": "docx-js.md"
    },
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "ooxml.md",
      "type": "file",
      "path": "ooxml.md"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
