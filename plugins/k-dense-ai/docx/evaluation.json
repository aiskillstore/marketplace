{
  "skill": {
    "name": "docx",
    "description": "Document toolkit (.docx). Create/edit documents, tracked changes, comments, formatting preservation, text extraction, for professional document processing.",
    "summary": "Create, edit, and analyze Word documents with full OOXML support, tracked changes, and comment management.",
    "icon": "ðŸ“„",
    "version": "1.0.0",
    "author": "K-Dense AI",
    "license": "Proprietary",
    "category": "documentation",
    "tags": ["document", "word", "docx", "office"],
    "supported_tools": ["claude", "codex", "claude-code"]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a legitimate document processing skill with no security concerns. All static findings are false positives: documentation code blocks (pandoc, soffice commands), OOXML schema namespace URLs, and XML attribute names misidentified as crypto/C2 patterns. The code uses safe XML parsing (defusedxml) to prevent XXE attacks.",
    "static_findings_evaluation": [
      {
        "finding": "external_commands: Ruby/shell backtick execution (all markdown files)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "The backticks in markdown files are documentation code blocks showing command examples (pandoc, soffice, pdftoppm). These are user-facing documentation, not actual code execution. No subprocess or shell execution in the skill's Python code uses user input directly."
      },
      {
        "finding": "blocker: Weak cryptographic algorithm (XSD schema files)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "The scanner flags strings like 'des', 'desc', 'sha' in XSD enumeration values. These are official OOXML schema files from Microsoft/ECMA containing legitimate XML attribute values (e.g., diagram style names, attribute descriptions). No cryptographic code exists in this skill."
      },
      {
        "finding": "blocker: C2 keywords (XSD schema files)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "The scanner flags 'arabic1Minus' at dml-main.xsd:2725 as a C2 keyword. This is an OOXML enumeration value for text bullet styles, not a command-and-control indicator. All 'findings' are legitimate OOXML schema content, not malware indicators."
      },
      {
        "finding": "network: Hardcoded URL (LICENSE.txt, XSD files)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "The URLs are: (1) License terms (anthropic.com/legal/*) - legitimate, (2) XML namespace URIs in OOXML schemas - required for standards compliance (schemas.openxmlformats.org, schemas.microsoft.com). No data exfiltration or credential access."
      },
      {
        "finding": "filesystem: Node.js fs operations, Python shutil/archive ops",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "File operations are core to document processing: unpacking .docx (ZIP archives), reading XML, saving changes. All use controlled paths from skill parameters, not user input. Uses defusedxml for safe XML parsing preventing XXE."
      },
      {
        "finding": "blocker: System reconnaissance (scripts)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Scanner flagged 'id' in attribute names like 'w:id'. These are XML element IDs for tracked changes and comments, not system commands. No hostname, whoami, or similar reconnaissance commands exist in this skill."
      },
      {
        "finding": "obfuscation: JSFuck patterns, extremely long lines (templates)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Template XML files contain complete OOXML structures with namespaces, not obfuscated code. Long lines are legitimate XML templates for Word comments. Template files are standard OOXML structures from Microsoft documentation."
      },
      {
        "finding": "CRITICAL: Dangerous combination patterns",
        "verdict": "false_positive",
        "confidence": "medium",
        "reasoning": "The heuristic combination alerts are triggered by the presence of filesystem + network + credential access patterns across different files. This is false alarm: network URLs are XML namespaces, credential patterns are from license text, and file ops are standard document processing."
      },
      {
        "finding": "HIGH: sudo privilege escalation (SKILL.md:227-230)",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "The scanner flags 'sudo apt-get install' commands in documentation. These are standard Linux package installation instructions for tool dependencies (pandoc, libreoffice, poppler-utils). No privilege escalation vulnerability exists."
      },
      {
        "finding": "filesystem: Archive extract all (zip slip risk)",
        "verdict": "false_positive",
        "confidence": "medium",
        "reasoning": "While extractall() is used for unpacking .docx files, the input is controlled (user-specified .docx path). The unpacked output directory is user-specified. This is standard practice for OOXML processing. No path traversal vulnerability in the intended workflow."
      }
    ],
    "risk_factor_evidence": [
      {
        "factor": "filesystem",
        "evidence": [
          {"file": "scripts/utilities.py", "line_start": 37, "line_end": 38},
          {"file": "scripts/document.py", "line_start": 36, "line_end": 36},
          {"file": "ooxml/scripts/unpack.py", "line_start": 1, "line_end": 30}
        ],
        "explanation": "File operations use defusedxml for safe XML parsing. Core functionality for document processing."
      },
      {
        "factor": "network",
        "evidence": [
          {"file": "LICENSE.txt", "line_start": 8, "line_end": 9},
          {"file": "ooxml/schemas/microsoft/wml-2012.xsd", "line_start": 1, "line_end": 5}
        ],
        "explanation": "URLs are license terms and OOXML namespace URIs required for standards compliance."
      },
      {
        "factor": "scripts",
        "evidence": [
          {"file": "ooxml/scripts/pack.py", "line_start": 1, "line_end": 160},
          {"file": "ooxml/scripts/validation/base.py", "line_start": 1, "line_end": 100}
        ],
        "explanation": "Core document processing scripts with safe XML handling and validation."
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 59,
    "total_lines": 24761
  },
  "content": {
    "user_title": "Create and edit Word documents",
    "value_statement": "This skill provides a complete toolkit for Word document operations. Create new documents from scratch with JavaScript, edit existing documents with Python, and manage tracked changes and comments with proper OOXML compliance.",
    "seo_keywords": [
      "docx",
      "Word document",
      "Claude Code",
      "document editing",
      "OOXML",
      "tracked changes",
      "document creation",
      "office documents",
      "docx manipulation",
      "Python document"
    ],
    "actual_capabilities": [
      "Create Word documents from scratch using JavaScript/TypeScript",
      "Edit existing documents with Python DOM manipulation",
      "Implement tracked changes and comments with proper OOXML patterns",
      "Extract text content using pandoc conversion",
      "Validate document structure against OOXML schemas",
      "Pack and unpack OOXML archives for direct XML editing"
    ],
    "limitations": [
      "Requires external tools (pandoc, LibreOffice) for text extraction and validation",
      "Complex formatting changes may require direct XML editing",
      "Does not support password-protected or encrypted documents"
    ],
    "use_cases": [
      {
        "target_user": "Technical Writers",
        "title": "Generate professional documents",
        "description": "Create well-formatted Word documents with headings, tables, and styling using JavaScript."
      },
      {
        "target_user": "Legal Professionals",
        "title": "Review documents with tracked changes",
        "description": "Edit contracts and legal documents while maintaining full revision history."
      },
      {
        "target_user": "Researchers",
        "title": "Automate document processing",
        "description": "Extract text, modify content, and batch process multiple documents programmatically."
      }
    ],
    "prompt_templates": [
      {
        "title": "Create simple document",
        "scenario": "Create a basic Word document",
        "prompt": "Create a new Word document with a title 'Report' and two paragraphs of placeholder text."
      },
      {
        "title": "Add tracked changes",
        "scenario": "Edit document with revision tracking",
        "prompt": "Edit document.docx to change all occurrences of 'company' to 'Corporation' with tracked changes enabled."
      },
      {
        "title": "Extract text content",
        "scenario": "Convert document to markdown",
        "prompt": "Extract all text from quarterly_report.docx and save as markdown with tracked changes preserved."
      },
      {
        "title": "Complex XML editing",
        "scenario": "Make precise structural changes",
        "prompt": "Edit contract.docx to update the termination clause: change '30 days' to '60 days' notice period, maintaining proper tracked change markup."
      }
    ],
    "output_examples": [
      {
        "input": "Create a new Word document with title 'Meeting Notes' and add three bullet points: Action items, Attendees, and Next steps.",
        "output": [
          "Created new document: Meeting_Notes.docx",
          "Added title with Heading1 style",
          "Created numbered list with proper OOXML numbering configuration",
          "Added 3 list items under 'Action items' section"
        ]
      }
    ],
    "best_practices": [
      "Always use tracked changes (w:ins, w:del) when editing documents you did not create",
      "Validate XML structure after editing to ensure OOXML compliance",
      "Use proper RSID values to track revision sessions"
    ],
    "anti_patterns": [
      "Do not manually edit XML without understanding OOXML namespace requirements",
      "Avoid skipping tracked changes when editing third-party documents",
      "Do not ignore XML validation errors - they indicate OOXML compliance issues"
    ],
    "faq": [
      {
        "question": "How do I create a new Word document?",
        "answer": "Use the docx-js workflow. Read docx-js.md for complete syntax, then create a JavaScript file using Document, Paragraph, and TextRun components."
      },
      {
        "question": "How do I edit an existing document?",
        "answer": "Use the Document library (Python). Unpack the docx, run a Python script with the Document class, then repack. See ooxml.md for patterns."
      },
      {
        "question": "What are RSIDs and why do they matter?",
        "answer": "RSIDs are revision identifiers in Word documents. They must be 8-digit hex values. The unpack script generates one for each editing session."
      },
      {
        "question": "How do tracked changes work in OOXML?",
        "answer": "Tracked changes use w:ins (insertions) and w:del (deletions) elements. Each needs w:author, w:date, w:id attributes. The Document library handles these automatically."
      },
      {
        "question": "Can I extract text from a document?",
        "answer": "Yes. Use pandoc: pandoc document.docx -o output.md. Add --track-changes=all to preserve revision history in the output."
      },
      {
        "question": "What tools are required?",
        "answer": "Install: pandoc (text extraction), docx npm package (document creation), LibreOffice (PDF conversion), poppler-utils (PDF to images), defusedxml (Python XML safety)."
      }
    ]
  }
}
