{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-04T16:20:10.525Z",
    "slug": "k-dense-ai-xlsx",
    "source_url": "https://github.com/K-Dense-AI/claude-scientific-skills/tree/main/scientific-skills/document-skills/xlsx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "27d00f81590d07c832df9f9dc2c96117fb13d7db0a12db5c27f2af72537c9c56",
    "tree_hash": "169879cc7cfda8006d377ecf2e68f2d55a7bdadebf8cbb14e6a46e89b704a3f9"
  },
  "skill": {
    "name": "xlsx",
    "description": "Spreadsheet toolkit (.xlsx/.csv). Create/edit with formulas/formatting, analyze data, visualization, recalculate formulas, for spreadsheet processing and analysis.",
    "summary": "Spreadsheet toolkit (.xlsx/.csv). Create/edit with formulas/formatting, analyze data, visualization,...",
    "icon": "ðŸ“Š",
    "version": "1.0.0",
    "author": "K-Dense-AI",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "office",
    "tags": [
      "excel",
      "xlsx",
      "formulas",
      "validation",
      "recalc"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "filesystem",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill processes local Excel files using LibreOffice for formula recalculation. It calls external commands (soffice, timeout) to recalculate formulas and scans for errors. No network access, credential theft, or data exfiltration patterns detected. All capabilities align with the stated spreadsheet processing purpose.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "recalc.py",
            "line_start": 1,
            "line_end": 178
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "recalc.py",
            "line_start": 64,
            "line_end": 65
          },
          {
            "file": "recalc.py",
            "line_start": 103,
            "line_end": 103
          },
          {
            "file": "recalc.py",
            "line_start": 140,
            "line_end": 140
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "recalc.py",
            "line_start": 31,
            "line_end": 32
          },
          {
            "file": "recalc.py",
            "line_start": 72,
            "line_end": 90
          },
          {
            "file": "recalc.py",
            "line_start": 84,
            "line_end": 87
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 5,
    "total_lines": 577,
    "audit_model": "claude",
    "audited_at": "2026-01-04T16:20:10.524Z"
  },
  "content": {
    "user_title": "Recalculate and validate Excel formulas",
    "value_statement": "Formulas in Excel files can become stale or contain errors after edits. This skill recalculates formulas using LibreOffice and reports error locations for quick fixes. Ensure your spreadsheets are error-free before sharing or publishing.",
    "seo_keywords": [
      "Claude",
      "Codex",
      "Claude Code",
      "Excel formulas",
      "xlsx recalculation",
      "LibreOffice",
      "spreadsheet errors",
      "openpyxl",
      "pandas",
      "Excel validation"
    ],
    "actual_capabilities": [
      "Recalculate all formulas in an Excel file using LibreOffice headless mode",
      "Create and configure a LibreOffice macro for automated recalculation",
      "Scan all sheets for Excel error strings and list their exact locations",
      "Report total error count and a per-error-type breakdown",
      "Count total formulas in the workbook for complexity assessment"
    ],
    "limitations": [
      "Requires LibreOffice installed and the soffice command accessible on PATH",
      "Operates on local files only and does not modify formulas automatically",
      "Very large workbooks may exceed the default timeout period",
      "Macro setup writes to the user LibreOffice profile directory"
    ],
    "use_cases": [
      {
        "target_user": "Financial analyst",
        "title": "Validate model integrity",
        "description": "Recalculate a financial model after updates and locate #REF or #DIV/0 errors before sharing with stakeholders."
      },
      {
        "target_user": "Data engineer",
        "title": "Quality check exports",
        "description": "Verify that exported workbooks have no formula errors before delivery to clients or downstream systems."
      },
      {
        "target_user": "Operations manager",
        "title": "Spot spreadsheet issues",
        "description": "Run a quick health check on operational trackers and dashboards to find broken formulas before reporting."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic recalculation",
        "scenario": "Recalculate a single file",
        "prompt": "Recalculate formulas in output.xlsx and report any Excel errors found."
      },
      {
        "title": "Timeout control",
        "scenario": "Large workbook validation",
        "prompt": "Recalculate finance_model.xlsx with a 60 second timeout and summarize all errors."
      },
      {
        "title": "Error-focused report",
        "scenario": "Locate broken formulas",
        "prompt": "Run recalc on budget.xlsx and list all #REF and #DIV/0 error locations."
      },
      {
        "title": "Formula inventory",
        "scenario": "Audit workbook complexity",
        "prompt": "Recalculate ops.xlsx and report total formulas count and any error categories found."
      }
    ],
    "output_examples": [
      {
        "input": "Recalculate sales_report.xlsx and show any formula errors.",
        "output": [
          "Status: errors_found",
          "Total errors: 3",
          "#REF! at Sheet1!B5 and Sheet2!C10",
          "#DIV/0! at Sheet3!D12",
          "Total formulas: 128"
        ]
      }
    ],
    "best_practices": [
      "Run recalculation immediately after any formula or data edits to catch errors early",
      "Fix all reported error locations before publishing or sharing the workbook",
      "Use a longer timeout value for large workbooks with hundreds of formulas"
    ],
    "anti_patterns": [
      "Running recalculation on files without LibreOffice installed on the system",
      "Ignoring errors and sharing the workbook without fixing identified issues",
      "Assuming formulas were evaluated correctly when using openpyxl alone"
    ],
    "faq": [
      {
        "question": "What file types are supported by this skill?",
        "answer": "The skill targets Excel .xlsx files and uses LibreOffice headless mode to recalculate formulas."
      },
      {
        "question": "Are there limits on workbook size?",
        "answer": "Very large workbooks may exceed the default timeout. Increase the timeout value for complex files."
      },
      {
        "question": "Can I integrate this into a CI/CD pipeline?",
        "answer": "Yes, call recalc.py in your workflow and parse the JSON output programmatically for error detection."
      },
      {
        "question": "Does this skill send my data anywhere?",
        "answer": "No, the skill operates entirely locally and does not perform any network calls or external data transmission."
      },
      {
        "question": "What if LibreOffice is not found?",
        "answer": "Install LibreOffice from the official website and ensure the soffice command is available on your system PATH."
      },
      {
        "question": "How does this compare to native Excel recalculation?",
        "answer": "It uses LibreOffice headless mode which is ideal for automation without requiring Excel to be open or installed."
      }
    ]
  },
  "file_structure": [
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "recalc.py",
      "type": "file",
      "path": "recalc.py"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
