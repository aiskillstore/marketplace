{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:30:54.101Z",
    "slug": "asmayaseen-deploying-postgres-k8s",
    "source_url": "https://github.com/Asmayaseen/hackathon-2/tree/main/.claude/skills/deploying-postgres-k8s",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "00964e753bc25c6620d5a9e26fdc2563072faa823f2776a674ff752e8538a9bd",
    "tree_hash": "38b0fab9aacdc32828b715edb49b371f363739a0abf37e6a6ba39d103a0732b5"
  },
  "skill": {
    "name": "deploying-postgres-k8s",
    "description": "Deploys PostgreSQL on Kubernetes using the CloudNativePG operator with automated failover.\nUse when setting up PostgreSQL for production workloads, high availability, or local K8s development.\nCovers operator installation, cluster creation, connection secrets, and backup configuration.\nNOT when using managed Postgres (Neon, RDS, Cloud SQL) or simple Docker containers.\n",
    "summary": "Deploys PostgreSQL on Kubernetes using the CloudNativePG operator with automated failover.\nUse when ...",
    "icon": "üêò",
    "version": "1.0.0",
    "author": "Asmayaseen",
    "license": "MIT",
    "category": "devops",
    "tags": [
      "kubernetes",
      "postgresql",
      "cloudnativepg",
      "database",
      "devops"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill is primarily documentation with kubectl commands and YAML manifests for PostgreSQL deployment on Kubernetes. The included verification script only reads local files for structure validation. No network calls, no credential access, no external process execution. Safe for publication.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "scripts/verify.py",
            "line_start": 1,
            "line_end": 39
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/verify.py",
            "line_start": 8,
            "line_end": 9
          },
          {
            "file": "scripts/verify.py",
            "line_start": 11,
            "line_end": 13
          },
          {
            "file": "scripts/verify.py",
            "line_start": 15,
            "line_end": 15
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 2,
    "total_lines": 403,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:30:54.101Z"
  },
  "content": {
    "user_title": "Deploy PostgreSQL on Kubernetes",
    "value_statement": "Setting up production PostgreSQL on Kubernetes requires understanding operator installation, cluster configuration, and connection management. This skill provides ready-to-use kubectl commands and YAML manifests for CloudNativePG deployment with high availability.",
    "seo_keywords": [
      "deploy postgresql kubernetes",
      "cloudnativepg",
      "kubernetes database deployment",
      "postgresql operator",
      "ha postgresql k8s",
      "claude code postgresql",
      "kubectl postgres",
      "k8s database",
      "postgresql cluster",
      "claude postgresql"
    ],
    "actual_capabilities": [
      "Install CloudNativePG operator via kubectl or Helm",
      "Create production-ready PostgreSQL clusters with YAML manifests",
      "Configure connection secrets and service endpoints",
      "Set up S3 backup storage with retention policies",
      "Monitor PostgreSQL clusters with Prometheus metrics",
      "Troubleshoot common deployment and connection issues"
    ],
    "limitations": [
      "Does not create actual Kubernetes clusters or resources",
      "Does not configure cloud provider credentials or managed services",
      "Does not perform actual database operations or migrations",
      "Requires existing Kubernetes cluster and kubectl access"
    ],
    "use_cases": [
      {
        "target_user": "DevOps Engineers",
        "title": "Deploy HA PostgreSQL clusters",
        "description": "Set up production PostgreSQL with automated failover, backup to S3, and Prometheus monitoring on any Kubernetes cluster."
      },
      {
        "target_user": "Backend Developers",
        "title": "Local K8s development databases",
        "description": "Quickly spin up PostgreSQL instances in local Kubernetes for development and testing without managed services."
      },
      {
        "target_user": "Platform Engineers",
        "title": "Standardize database deployments",
        "description": "Create reusable PostgreSQL configurations with consistent security, monitoring, and backup policies across environments."
      }
    ],
    "prompt_templates": [
      {
        "title": "Install operator",
        "scenario": "Set up CloudNativePG",
        "prompt": "Deploy the CloudNativePG operator to my Kubernetes cluster and verify it is running correctly."
      },
      {
        "title": "Create cluster",
        "scenario": "Deploy PostgreSQL cluster",
        "prompt": "Create a production PostgreSQL cluster with 3 instances, 100Gi storage, and resource limits configured."
      },
      {
        "title": "Configure backups",
        "scenario": "Set up S3 backups",
        "prompt": "Configure S3 backup storage for my PostgreSQL cluster with daily backups and 30-day retention."
      },
      {
        "title": "Get connection",
        "scenario": "Retrieve connection string",
        "prompt": "Show me how to get the connection string from the PostgreSQL cluster secret and use it in my application."
      }
    ],
    "output_examples": [
      {
        "input": "Create a PostgreSQL cluster for production with high availability",
        "output": [
          "‚úì CloudNativePG operator installed in cnpg-system namespace",
          "‚úì PostgreSQL cluster 'pg-production' created with 3 instances",
          "‚úì Storage configured: 100Gi with standard storageClass",
          "‚úì Resources limits set: 2 CPU, 4Gi memory per instance",
          "‚úì Connection secrets available: pg-production-app, pg-production-superuser",
          "‚úì Service endpoints: pg-production-rw (read-write), pg-production-ro (read-only)",
          "‚úì Monitoring enabled with PodMonitor for Prometheus metrics"
        ]
      }
    ],
    "best_practices": [
      "Use namespace-scoped operator installation for enhanced security in multi-tenant clusters.",
      "Configure resource requests and limits to prevent resource contention and ensure predictable performance.",
      "Set up regular backups to S3 with appropriate retention policies before going to production."
    ],
    "anti_patterns": [
      "Deploying single-instance PostgreSQL clusters for production workloads without proper backup strategies.",
      "Using superuser credentials in application connections instead of app-specific users.",
      "Ignoring connection pooling which can exhaust available connections under load."
    ],
    "faq": [
      {
        "question": "Does this skill work with managed PostgreSQL services?",
        "answer": "No, this skill is for self-managed PostgreSQL on Kubernetes using CloudNativePG. Use skills for Neon, RDS, or Cloud SQL for managed services."
      },
      {
        "question": "What Kubernetes versions are supported?",
        "answer": "CloudNativePG requires Kubernetes 1.19 or later. Version 1.28 of the operator supports Kubernetes 1.28 through 1.31."
      },
      {
        "question": "Can I integrate this with existing Helm deployments?",
        "answer": "Yes, CloudNativePG can be installed via Helm alongside other deployments. Use namespace-scoped mode for better isolation."
      },
      {
        "question": "Is my data safe if the cluster is deleted?",
        "answer": "By default, CloudNativePG preserves PVCs when deleting clusters. Configure backup storage to S3 for disaster recovery scenarios."
      },
      {
        "question": "Why is my cluster not becoming Ready?",
        "answer": "Common causes include insufficient cluster resources, missing storage class, or network issues. Check pod status and describe cluster for details."
      },
      {
        "question": "How does this compare to PostgreSQL operators like CrunchyDB?",
        "answer": "CloudNativePG is more lightweight with native Kubernetes patterns. It handles failover automatically and integrates closely with Kubernetes storage and networking."
      }
    ]
  },
  "file_structure": [
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "verify.py",
          "type": "file",
          "path": "scripts/verify.py"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
