{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T05:47:53.429Z",
    "slug": "plugin-settings",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/plugin-settings",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "official"
  },
  "skill": {
    "name": "Plugin Settings",
    "description": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", \"user-configurable plugin\", \".local.md files\", \"plugin state files\", \"read YAML frontmatter\", \"per-project plugin settings\", or wants to make plugin behavior configurable. Documents the .claude/plugin-name.local.md pattern for storing plugin-specific configuration with YAML frontmatter and markdown content.",
    "summary": "This skill should be used when the user asks about \"plugin settings\", \"store plugin configuration\", ...",
    "icon": "⚙️",
    "version": "0.1.0",
    "author": "Anthropic",
    "license": "Not specified",
    "category": "development",
    "tags": [
      "plugin-development",
      "configuration",
      "yaml",
      "markdown",
      "project-settings",
      "hooks",
      "state-management"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill providing documentation and examples for plugin configuration patterns. No executable code beyond safe bash parsing utilities. All examples follow secure practices with validation and sanitization.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 8,
    "total_lines": 1978,
    "audit_model": "claude",
    "audited_at": "2025-12-31T05:47:53.429Z"
  },
  "content": {
    "user_title": "Plugin Settings Configuration Guide",
    "value_statement": "Learn how to create user-configurable Claude Code plugins that store per-project settings in local markdown files with YAML frontmatter.",
    "seo_keywords": [
      "plugin configuration",
      "yaml frontmatter",
      "local settings",
      "plugin development",
      "claude code plugins",
      "project settings",
      "markdown configuration",
      "plugin state management"
    ],
    "actual_capabilities": [
      "Documents the .claude/plugin-name.local.md pattern for storing plugin settings",
      "Provides bash parsing techniques for extracting YAML frontmatter and markdown content",
      "Includes working examples from real plugins (multi-agent-swarm, ralph-wiggum)",
      "Offers validation and utility scripts for settings file management",
      "Shows how to create, read, update, and validate settings files from hooks and commands",
      "Demonstrates configuration-driven plugin behavior patterns"
    ],
    "limitations": [
      "Settings changes require Claude Code restart to take effect",
      "Hooks cannot be hot-swapped within a session",
      "Relies on bash scripting knowledge for implementing parsing logic",
      "No built-in type validation for YAML fields",
      "Settings files must be manually added to .gitignore"
    ],
    "use_cases": [
      {
        "title": "User-Configurable Plugin Behavior",
        "description": "Allow users to customize plugin settings like validation level, file size limits, or notification preferences without editing plugin source code",
        "target_user": "Plugin developers who want to make their plugins configurable"
      },
      {
        "title": "Agent State Management",
        "description": "Store agent-specific state like task assignments, PR numbers, dependencies, and coordinator sessions for multi-agent workflows",
        "target_user": "Developers building multi-agent coordination systems"
      },
      {
        "title": "Temporary Hook Activation",
        "description": "Enable or disable hooks on a per-project basis using an 'enabled' flag in settings, without modifying hooks.json",
        "target_user": "Plugin users who want project-specific hook behavior"
      },
      {
        "title": "Loop State Persistence",
        "description": "Track iteration counts, completion conditions, and prompts for self-looping agents like ralph-wiggum",
        "target_user": "Developers implementing autonomous agent loops"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Plugin Settings File",
        "prompt": "Create a settings file at .claude/my-plugin.local.md with fields for enabled (true/false), validation_mode (strict/standard/lenient), and max_file_size (1000000). Ask me for my preferences first.",
        "scenario": "Setting up plugin configuration for the first time"
      },
      {
        "title": "Read and Validate Settings",
        "prompt": "Read the settings from .claude/my-plugin.local.md and validate that all required fields are present and correctly formatted. Show me what configuration is currently active.",
        "scenario": "Checking current plugin configuration"
      },
      {
        "title": "Implement Settings Parsing in Hook",
        "prompt": "Add settings file parsing to my hook script at hooks/my-hook.sh. It should read .claude/my-plugin.local.md, check the 'enabled' field, and apply the 'strict_mode' setting to validation logic.",
        "scenario": "Making an existing hook configuration-aware"
      }
    ],
    "output_examples": [
      {
        "input": "Show me an example settings file for a security validation plugin",
        "output": "```markdown\n---\nenabled: true\nvalidation_level: strict\nmax_file_size: 1000000\nallowed_extensions: [\".js\", \".ts\", \".tsx\"]\nenable_logging: true\n---\n\n# Security Validation Configuration\n\nStrict mode enabled for this project.\nAll writes validated against security policies.\n```"
      },
      {
        "input": "Parse the 'enabled' field from .claude/my-plugin.local.md",
        "output": "```bash\nFRONTMATTER=$(sed -n '/^---$/,/^---$/{ /^---$/d; p; }' \".claude/my-plugin.local.md\")\nENABLED=$(echo \"$FRONTMATTER\" | grep '^enabled:' | sed 's/enabled: *//')\nif [[ \"$ENABLED\" == \"true\" ]]; then\n  echo \"Plugin is enabled\"\nfi\n```"
      }
    ],
    "best_practices": [
      "Use the quick-exit pattern: check if settings file exists before parsing",
      "Always include an 'enabled' field for explicit plugin control",
      "Use atomic file updates with temp file + mv for settings modifications",
      "Provide sensible defaults when settings file doesn't exist",
      "Validate all field values after parsing (types, ranges, allowed values)",
      "Strip surrounding quotes from YAML values to handle both quoted and unquoted formats",
      "Add .claude/*.local.md to .gitignore to prevent committing user-local settings",
      "Document in README that settings changes require Claude Code restart",
      "Sanitize user input when creating settings files from commands",
      "Use sed for simple field extraction, yq for complex YAML structures"
    ],
    "anti_patterns": [
      "Hardcoding absolute paths instead of relative .claude/ paths",
      "Using unquoted variables in bash (always quote: \"$VALUE\")",
      "Non-atomic file updates with sed -i (can corrupt on interruption)",
      "No default values for missing fields",
      "Assuming settings file exists without checking",
      "Ignoring validation of numeric and boolean field types",
      "Committing .local.md files to version control",
      "Expecting hot-swapping of settings without restart"
    ],
    "faq": [
      {
        "question": "Why use .local.md instead of .json or .yaml?",
        "answer": "The .local.md format combines YAML frontmatter for structured config with markdown body for human-readable context, prompts, or documentation. The .local suffix clearly indicates user-local files that shouldn't be committed."
      },
      {
        "question": "Do I need to restart Claude Code after changing settings?",
        "answer": "Yes, hooks are loaded at session start and cannot be hot-swapped. After editing settings files, exit and restart Claude Code for changes to take effect."
      },
      {
        "question": "How do I parse list fields from YAML frontmatter?",
        "answer": "For simple checks, use string matching. For proper list iteration, use yq to convert to JSON, then iterate with jq. See parsing-techniques.md for detailed examples."
      },
      {
        "question": "What's the difference between .claude/plugin.md and .claude/plugin.local.md?",
        "answer": "plugin.md would be committed to git (shared team settings), while plugin.local.md is gitignored (user-local settings). The .local suffix is the convention for per-user configuration."
      },
      {
        "question": "Can I update settings files from within a hook?",
        "answer": "Yes, hooks can update settings files (e.g., incrementing iteration counters). Use atomic updates with temp files to prevent corruption. Changes take effect on next session."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "bash (for parsing scripts)",
        "sed, awk, grep (standard UNIX tools)",
        "jq (for JSON manipulation in hooks)",
        "yq (optional, for complex YAML parsing)"
      ],
      "permissions": [
        "Read access to .claude/ directory",
        "Write access to create/update .local.md files"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "create-settings-command.md",
          "type": "file",
          "path": "examples/create-settings-command.md"
        },
        {
          "name": "example-settings.md",
          "type": "file",
          "path": "examples/example-settings.md"
        },
        {
          "name": "read-settings-hook.sh",
          "type": "file",
          "path": "examples/read-settings-hook.sh"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "parsing-techniques.md",
          "type": "file",
          "path": "references/parsing-techniques.md"
        },
        {
          "name": "real-world-examples.md",
          "type": "file",
          "path": "references/real-world-examples.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "parse-frontmatter.sh",
          "type": "file",
          "path": "scripts/parse-frontmatter.sh"
        },
        {
          "name": "validate-settings.sh",
          "type": "file",
          "path": "scripts/validate-settings.sh"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}