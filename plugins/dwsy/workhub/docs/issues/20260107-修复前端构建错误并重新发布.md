# Issue: 修复前端构建错误并重新发布

## 元数据

| 字段 | 内容 |
|------|------|
| **文件名** | 20260107-修复前端构建错误并重新发布.md |
| **创建时间** | 2026-01-07 |
| **状态** | ✅ 已完成 |
| **优先级** | 🔴 P0 |

## Goal

修复前端构建错误，清理所有历史构建产物和 release，并重新发布 v6.1 版本。

## 背景/问题

1. 前端构建失败：TypeScript 类型错误，提示 `select_file_dialog` 方法在 `window.pywebview.api` 类型定义中不存在
2. 需要清理所有历史 release 和构建产物
3. 重新发布新版本

## 验收标准 (Acceptance Criteria)

- [x] WHEN 前端构建执行时，系统 SHALL 成功完成构建无错误
- [x] WHEN TypeScript 类型检查执行时，系统 SHALL 通过所有类型检查
- [x] WHEN 清理历史构建时，系统 SHALL 删除所有 dist、__pycache__、build 目录
- [x] WHEN 清理历史 release 时，系统 SHALL 删除所有 GitHub release 和 tags
- [x] WHEN 重新发布时，系统 SHALL 创建新的 v6.1 tag 和 release

## 实施阶段

### Phase 1: 修复前端构建错误
- [x] 分析构建错误：vite-env.d.ts 缺少 select_file_dialog 类型定义
- [x] 修复类型定义：在 vite-env.d.ts 中添加 select_file_dialog 方法
- [x] 验证构建：npm run build 成功

### Phase 2: 清理历史构建产物
- [x] 删除所有 dist 目录（./out/build, ./src/frontend/dist, ./occt-import-js/dist）
- [x] 删除所有 __pycache__ 目录
- [x] 删除 build 目录
- [x] 删除历史 zip 文件（DeepFlyAutoQuote-Windows-x64.zip, project-latest.zip）

### Phase 3: 清理 GitHub Release 和 Tags
- [x] 删除所有 GitHub release（v5.0, v5.1, v6.0）
- [x] 删除所有远程 tags
- [x] 删除所有本地 tags

### Phase 4: 重新发布
- [x] 提交修复代码到 master 分支
- [x] 推送 master 分支到远程
- [x] 创建 v6.1 tag
- [x] 推送 v6.1 tag 到远程
- [x] 创建 GitHub Release v6.1

## 关键决策

| 决策 | 理由 |
|------|------|
| 添加 select_file_dialog 类型定义 | 后端 API 已实现该方法，前端类型定义缺失导致构建失败 |
| 删除所有历史 release | 清理历史版本，重新开始版本管理 |
| 创建 v6.1 版本 | 修复了构建错误，需要新版本号 |

## 遇到的错误

| 日期 | 错误 | 解决方案 |
|------|------|---------|
| 2026-01-07 | TS2339: Property 'select_file_dialog' does not exist on type | 在 vite-env.d.ts 中添加 select_file_dialog 方法的类型定义 |

## 相关资源

- [ ] 相关文档: `docs/architecture/xxx.md`
- [ ] 相关 Issue: N/A
- [ ] 参考资料: N/A

## Notes

- 前端构建成功后生成了 2.7MB 的 JS 文件，建议后续考虑代码分割优化
- 所有历史构建产物已清理干净
- 新版本 v6.1 已成功发布到 GitHub

---

## Status 更新日志

- **2026-01-07 12:23**: 状态变更 → 🚧 进行中，开始修复构建错误
- **2026-01-07 12:30**: 状态变更 → ✅ 已完成，所有任务已完成