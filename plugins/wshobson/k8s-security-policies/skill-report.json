{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-02T00:36:05.238Z",
    "slug": "wshobson-k8s-security-policies",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/kubernetes-operations/skills/k8s-security-policies",
    "source_ref": "main",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "bf1e3e39aeb40bad5886b7f658ea441fef936d0a9b056adb01aa2ba595351eda",
    "tree_hash": "a74f298cfe99c6f5218ad69b845c66f958ec82505127e1302d84b2e552473550"
  },
  "skill": {
    "name": "k8s-security-policies",
    "description": "Implement Kubernetes security policies including NetworkPolicy, PodSecurityPolicy, and RBAC for production-grade security. Use when securing Kubernetes clusters, implementing network isolation, or enforcing pod security standards.",
    "summary": "Implement Kubernetes security policies including NetworkPolicy, PodSecurityPolicy, and RBAC for prod...",
    "icon": "üõ°Ô∏è",
    "version": "1.0.0",
    "license": "MIT",
    "category": "security",
    "tags": [
      "kubernetes",
      "rbac",
      "networkpolicy",
      "pod-security",
      "gatekeeper"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "No malicious patterns detected in the skill content. Files contain static guidance and YAML templates without executable code or network access.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 698,
    "audit_model": "codex",
    "audited_at": "2026-01-02T00:36:05.238Z"
  },
  "content": {
    "user_title": "Implement Kubernetes security policies",
    "value_statement": "Kubernetes security settings are complex and easy to miss. This skill provides clear policy templates and RBAC patterns for safer clusters.",
    "seo_keywords": [
      "Kubernetes security",
      "NetworkPolicy",
      "RBAC",
      "Pod Security Standards",
      "OPA Gatekeeper",
      "Istio AuthorizationPolicy",
      "Claude",
      "Codex",
      "Claude Code",
      "cluster hardening"
    ],
    "actual_capabilities": [
      "Provide NetworkPolicy templates for common traffic patterns",
      "Define Pod Security Standards labels for namespaces",
      "Show RBAC roles and bindings for least privilege",
      "Include Gatekeeper constraint template and constraint example",
      "Document Istio mTLS and authorization policy examples"
    ],
    "limitations": [
      "Does not apply policies to a live cluster",
      "Does not validate policies against your environment",
      "Does not generate custom YAML beyond provided templates",
      "Does not audit existing cluster configurations"
    ],
    "use_cases": [
      {
        "target_user": "Platform engineer",
        "title": "Lock down namespaces",
        "description": "Establish baseline and restricted pod standards with sample namespace labels."
      },
      {
        "target_user": "DevOps engineer",
        "title": "Segment service traffic",
        "description": "Apply NetworkPolicy templates for frontend, backend, and database isolation."
      },
      {
        "target_user": "Security analyst",
        "title": "Review RBAC scope",
        "description": "Use RBAC patterns to reduce permissions and document role intent."
      }
    ],
    "prompt_templates": [
      {
        "title": "Start with defaults",
        "scenario": "New cluster security baseline",
        "prompt": "Create a starter set of NetworkPolicy and Pod Security Standards for a production namespace."
      },
      {
        "title": "Harden a namespace",
        "scenario": "Existing app needs stricter rules",
        "prompt": "Show a restricted namespace label set and a pod security context for non root containers."
      },
      {
        "title": "Least privilege RBAC",
        "scenario": "Service account access control",
        "prompt": "Provide an RBAC role and rolebinding for a service account that only reads configmaps."
      },
      {
        "title": "Gatekeeper policy",
        "scenario": "Enforce required labels",
        "prompt": "Generate a Gatekeeper constraint template and constraint to require app and environment labels."
      }
    ],
    "output_examples": [
      {
        "input": "Give me a safe default deny policy and allow DNS for the production namespace.",
        "output": [
          "Default deny ingress and egress for all pods in production",
          "Egress rule allows UDP 53 to kube-system for DNS resolution",
          "Namespace placeholders noted for customization"
        ]
      }
    ],
    "best_practices": [
      "Start with default deny policies before adding allow rules",
      "Use namespace scoped Roles whenever possible",
      "Disable service account token automounting when not needed"
    ],
    "anti_patterns": [
      "Granting wildcard verbs and resources in production",
      "Allowing unrestricted egress to the internet",
      "Running pods as root without a security context"
    ],
    "faq": [
      {
        "question": "Is this compatible with all Kubernetes versions?",
        "answer": "It targets standard Kubernetes APIs and common add ons like Gatekeeper and Istio."
      },
      {
        "question": "What are the main limits of this skill?",
        "answer": "It provides templates and guidance, but does not apply or validate policies."
      },
      {
        "question": "Can I integrate this with GitOps workflows?",
        "answer": "Yes, the YAML examples can be stored and deployed with your GitOps tool."
      },
      {
        "question": "Does it access my cluster or data?",
        "answer": "No, it only provides static guidance and does not connect to your systems."
      },
      {
        "question": "What if a policy does not work as expected?",
        "answer": "Use the troubleshooting commands to check CNI support and RBAC permissions."
      },
      {
        "question": "How does this compare to a security scanner?",
        "answer": "This is a guidance and template skill, not a scanning or compliance tool."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "network-policy-template.yaml",
          "type": "file",
          "path": "assets/network-policy-template.yaml"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "rbac-patterns.md",
          "type": "file",
          "path": "references/rbac-patterns.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
