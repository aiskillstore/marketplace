{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-04T05:39:18.798Z",
    "slug": "wshobson-mtls-configuration",
    "source_url": "https://github.com/wshobson/agents/tree/main/plugins/cloud-infrastructure/skills/mtls-configuration",
    "source_ref": "main",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "3290a088696754d8e595c87bc8ced7e32231310d4c8972a99bc1e341919aafdf",
    "tree_hash": "3025691a7ba3b67d848ad999ef6660170fff7fff148f7bb858780d702989d0d2"
  },
  "skill": {
    "name": "mtls-configuration",
    "description": "Configure mutual TLS (mTLS) for zero-trust service-to-service communication. Use when implementing zero-trust networking, certificate management, or securing internal service communication.",
    "summary": "Configure mutual TLS (mTLS) for zero-trust service-to-service communication. Use when implementing z...",
    "icon": "üîê",
    "version": "1.0.0",
    "author": "wshobson",
    "license": "MIT",
    "category": "security",
    "tags": [
      "mtls",
      "zero-trust",
      "istio",
      "linkerd",
      "certificates"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": []
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "The skill is static documentation with configuration templates and command examples. No executable code, file access, or network calls exist in the package. Risk to users is minimal when treated as guidance only.",
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 546,
    "audit_model": "codex",
    "audited_at": "2026-01-04T05:39:18.798Z"
  },
  "content": {
    "user_title": "Implement mTLS in service meshes",
    "value_statement": "Service to service traffic lacks strong identity and encryption. This skill provides mTLS templates and checks for zero trust communication.",
    "seo_keywords": [
      "mTLS configuration",
      "Istio mTLS",
      "Linkerd mTLS",
      "SPIFFE SPIRE",
      "cert-manager",
      "zero trust networking",
      "Claude",
      "Codex",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Provide Istio PeerAuthentication templates for strict and permissive modes",
      "Provide Istio DestinationRule examples for mutual and simple TLS",
      "Show cert-manager ClusterIssuer and Certificate templates for Istio CA",
      "Outline SPIRE server and agent configuration for SPIFFE identities",
      "List Linkerd mTLS policy and verification examples",
      "List commands for certificate rotation checks and mTLS debugging"
    ],
    "limitations": [
      "Does not run commands or apply manifests",
      "Does not generate real certificates or keys",
      "Focuses on Istio, Linkerd, and SPIRE examples only",
      "Does not validate cluster specific policies"
    ],
    "use_cases": [
      {
        "target_user": "Platform engineer",
        "title": "Enforce mesh wide mTLS",
        "description": "Set strict mTLS defaults with a safe permissive migration path for legacy namespaces."
      },
      {
        "target_user": "Security engineer",
        "title": "Design certificate hierarchy",
        "description": "Plan CA tiers, rotations, and SPIFFE identities for workload authentication."
      },
      {
        "target_user": "SRE",
        "title": "Troubleshoot mTLS failures",
        "description": "Identify handshake issues using peer auth, destination rules, and proxy logs."
      }
    ],
    "prompt_templates": [
      {
        "title": "Enable Istio mTLS",
        "scenario": "New mesh with strict defaults",
        "prompt": "Provide Istio PeerAuthentication and DestinationRule templates to enable mesh wide strict mTLS with one permissive namespace."
      },
      {
        "title": "Cert manager setup",
        "scenario": "Issue workload certificates",
        "prompt": "Show a cert-manager ClusterIssuer and Certificate for a service namespace using an Istio CA."
      },
      {
        "title": "SPIRE integration",
        "scenario": "SPIFFE identities in Kubernetes",
        "prompt": "Outline SPIRE server and agent configuration needed for SPIFFE based mTLS in Kubernetes."
      },
      {
        "title": "Debug mTLS issues",
        "scenario": "Handshake errors in mesh",
        "prompt": "List commands to verify mTLS status, peer authentication, destination rules, and proxy TLS logs for a failing service."
      }
    ],
    "output_examples": [
      {
        "input": "I need strict mTLS for Istio with a permissive legacy namespace",
        "output": [
          "Mesh default PeerAuthentication set to STRICT in istio-system",
          "Legacy namespace PeerAuthentication set to PERMISSIVE",
          "DestinationRule enforces ISTIO_MUTUAL for internal traffic"
        ]
      }
    ],
    "best_practices": [
      "Start with permissive and move to strict after validation",
      "Use short lived workload certificates and monitor expiry",
      "Plan CA rotation with a documented rollback"
    ],
    "anti_patterns": [
      "Disable mTLS in production for convenience",
      "Use self signed certs without a CA hierarchy",
      "Skip certificate chain verification"
    ],
    "faq": [
      {
        "question": "Is this compatible with Claude, Codex, and Claude Code?",
        "answer": "Yes. It is guidance and templates that work with any assistant."
      },
      {
        "question": "What are the main limits of this skill?",
        "answer": "It does not apply manifests or generate certificates in your environment."
      },
      {
        "question": "Can I integrate this with cert-manager?",
        "answer": "Yes. It includes ClusterIssuer and Certificate examples for cert-manager."
      },
      {
        "question": "Does it access or send my data?",
        "answer": "No. It contains only static documentation and example templates."
      },
      {
        "question": "What should I do if mTLS fails to connect?",
        "answer": "Check peer auth, destination rules, and proxy logs with the listed commands."
      },
      {
        "question": "How does this compare to a generic TLS guide?",
        "answer": "It focuses on service mesh mTLS with Istio, Linkerd, and SPIRE examples."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
