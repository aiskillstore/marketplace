{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T05:47:03.618Z",
    "slug": "mcp-integration",
    "source_url": "https://github.com/anthropics/claude-code/tree/main/plugins/plugin-dev/skills/mcp-integration",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "official"
  },
  "skill": {
    "name": "MCP Integration",
    "description": "This skill should be used when the user asks to \"add MCP server\", \"integrate MCP\", \"configure MCP in plugin\", \"use .mcp.json\", \"set up Model Context Protocol\", \"connect external service\", mentions \"${CLAUDE_PLUGIN_ROOT} with MCP\", or discusses MCP server types (SSE, stdio, HTTP, WebSocket). Provides comprehensive guidance for integrating Model Context Protocol servers into Claude Code plugins for external tool and service integration.",
    "summary": "This skill should be used when the user asks to \"add MCP server\", \"integrate MCP\", \"configure MCP in...",
    "icon": "ðŸ”Œ",
    "version": "0.1.0",
    "author": "Anthropic",
    "license": "Not specified",
    "category": "development",
    "tags": [
      "mcp",
      "integration",
      "api",
      "plugins",
      "model-context-protocol",
      "external-services",
      "oauth",
      "authentication",
      "stdio",
      "sse",
      "http",
      "websocket"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "OFFICIAL skill from Anthropic providing educational documentation and examples for MCP server integration. Contains no executable code, only configuration examples and best practices guidance with strong security recommendations.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 7,
    "total_lines": 2249,
    "audit_model": "claude",
    "audited_at": "2025-12-31T05:47:03.617Z"
  },
  "content": {
    "user_title": "MCP Integration Guide for Claude Code Plugins",
    "value_statement": "Connect Claude Code to external services and APIs through Model Context Protocol, enabling seamless integration with databases, cloud services, and custom tools without writing complex middleware.",
    "seo_keywords": [
      "mcp integration",
      "model context protocol",
      "claude code plugins",
      "api integration",
      "external service connection",
      "oauth authentication",
      "stdio server",
      "sse server",
      "plugin development",
      "tool integration"
    ],
    "actual_capabilities": [
      "Configure stdio MCP servers for local process communication",
      "Set up SSE servers for hosted cloud services with OAuth",
      "Integrate HTTP REST API servers with token authentication",
      "Configure WebSocket servers for real-time bidirectional communication",
      "Manage environment variable expansion for secure credential handling",
      "Bundle MCP servers directly within plugins using .mcp.json",
      "Pre-allow MCP tools in commands with proper security scoping",
      "Handle multiple MCP servers within a single plugin",
      "Implement OAuth flows automatically through Claude Code",
      "Debug MCP connections using /mcp command and --debug flag"
    ],
    "limitations": [
      "Requires MCP server restart when configuration changes",
      "OAuth only supported for SSE and HTTP server types",
      "Mutual TLS (mTLS) not directly supported in MCP configuration",
      "Tool naming convention uses verbose prefixes (mcp__plugin_X_Y__Z)",
      "Environment variables must be set before Claude Code starts",
      "No built-in support for dynamic token refresh beyond OAuth"
    ],
    "use_cases": [
      {
        "title": "Integrate Asana Project Management",
        "description": "Connect Claude Code to Asana using SSE server with OAuth to create tasks, search projects, and update workflows directly from development environment",
        "target_user": "Product managers and developers managing Asana projects"
      },
      {
        "title": "Local File System Access",
        "description": "Use stdio MCP server to provide Claude with controlled access to local file systems, enabling file operations within specified directories",
        "target_user": "Developers needing safe file system tool integration"
      },
      {
        "title": "Custom Database Tools",
        "description": "Build stdio MCP server for database queries, allowing Claude to execute read-only queries or CRUD operations with proper authentication",
        "target_user": "Database administrators and backend developers"
      },
      {
        "title": "REST API Integration",
        "description": "Connect to internal or external REST APIs using HTTP MCP servers with token authentication for seamless API interaction",
        "target_user": "API developers and integration engineers"
      },
      {
        "title": "Real-time Data Streaming",
        "description": "Use WebSocket MCP servers for low-latency, bidirectional communication with streaming services and live data sources",
        "target_user": "Real-time application developers and data engineers"
      }
    ],
    "prompt_templates": [
      {
        "title": "Add MCP Server to Plugin",
        "prompt": "Add an MCP server to my plugin that connects to [service name] using [stdio/SSE/HTTP/WebSocket]. It should authenticate using [OAuth/Bearer token/API key] and provide tools for [specific operations].",
        "scenario": "When starting MCP integration in a new or existing plugin"
      },
      {
        "title": "Configure OAuth Authentication",
        "prompt": "Configure OAuth authentication for my SSE MCP server connecting to [service URL]. What scopes should I document for users?",
        "scenario": "Setting up OAuth for hosted services like Asana or GitHub"
      },
      {
        "title": "Debug MCP Connection",
        "prompt": "My MCP server named [server-name] isn't connecting. Help me debug the configuration and check authentication, URL, and environment variables.",
        "scenario": "Troubleshooting MCP server connection issues"
      },
      {
        "title": "Use MCP Tools in Command",
        "prompt": "Create a command that uses the MCP tool [tool-name] from my [server-name] server to [accomplish task]. Include proper error handling and user feedback.",
        "scenario": "Building commands that leverage MCP tools"
      },
      {
        "title": "Bundle Multiple MCP Servers",
        "prompt": "Set up .mcp.json to bundle both a local stdio server for [purpose] and a hosted SSE server for [service] in my plugin.",
        "scenario": "Creating multi-server plugin configurations"
      }
    ],
    "output_examples": [
      {
        "input": "Add a stdio MCP server for file system access to my plugin",
        "output": "Created .mcp.json:\n{\n  \"filesystem\": {\n    \"command\": \"npx\",\n    \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\", \"${CLAUDE_PROJECT_DIR}\"],\n    \"env\": {\n      \"LOG_LEVEL\": \"info\"\n    }\n  }\n}\n\nThis configures a stdio server using the official MCP filesystem package. Tools will be available as mcp__plugin_yourplugin_filesystem__* and provide file operations within the project directory."
      },
      {
        "input": "Configure an HTTP MCP server with Bearer token authentication",
        "output": "Created .mcp.json:\n{\n  \"api-service\": {\n    \"type\": \"http\",\n    \"url\": \"https://api.example.com/mcp\",\n    \"headers\": {\n      \"Authorization\": \"Bearer ${API_TOKEN}\",\n      \"Content-Type\": \"application/json\"\n    }\n  }\n}\n\nRemember to document in README that users need to set the API_TOKEN environment variable before using the plugin."
      }
    ],
    "best_practices": [
      "Always use ${CLAUDE_PLUGIN_ROOT} for portable file paths in stdio server configurations",
      "Document all required environment variables clearly in plugin README with setup instructions",
      "Use HTTPS/WSS connections exclusively, never HTTP/WS for security",
      "Pre-allow specific MCP tools in command frontmatter rather than wildcards",
      "Handle authentication errors gracefully with clear user guidance",
      "Test MCP integration locally using /mcp command before publishing",
      "Prefer dedicated .mcp.json file over inline mcpServers in plugin.json for clarity",
      "Implement proper error handling for connection failures and tool call errors",
      "Use OAuth for hosted services when available instead of manual token management",
      "Batch similar MCP requests to optimize performance and reduce API calls"
    ],
    "anti_patterns": [
      "Hardcoding API tokens or credentials directly in .mcp.json configuration",
      "Using HTTP instead of HTTPS or WS instead of WSS for network connections",
      "Pre-allowing all tools with wildcards (mcp__plugin_name_server__*) unnecessarily",
      "Committing sensitive credentials or tokens to version control",
      "Using absolute file paths instead of ${CLAUDE_PLUGIN_ROOT} variable",
      "Making individual MCP tool calls in loops instead of batching requests",
      "Skipping environment variable documentation in README",
      "Exposing internal error messages directly to users without context",
      "Forgetting to validate inputs before calling MCP tools",
      "Using echo or bash commands to communicate with users instead of direct output"
    ],
    "faq": [
      {
        "question": "What's the difference between .mcp.json and mcpServers in plugin.json?",
        "answer": "Both configure MCP servers for plugins. Dedicated .mcp.json is recommended for better separation of concerns and easier maintenance, especially with multiple servers. Use mcpServers inline in plugin.json only for simple single-server plugins."
      },
      {
        "question": "How do I find the full name of an MCP tool to use in commands?",
        "answer": "Use the /mcp command in Claude Code to list all available MCP servers and their tools. The full name follows the pattern: mcp__plugin_<plugin-name>_<server-name>__<tool-name>."
      },
      {
        "question": "When should I use stdio vs SSE vs HTTP servers?",
        "answer": "Use stdio for local tools and custom servers you distribute with your plugin. Use SSE for hosted cloud services with OAuth authentication. Use HTTP for REST APIs with token authentication. Use WebSocket for real-time bidirectional communication needs."
      },
      {
        "question": "How does OAuth authentication work with MCP servers?",
        "answer": "For SSE and HTTP servers, Claude Code automatically handles the OAuth flow. When a user first uses an MCP tool requiring authentication, they're prompted to authorize in a browser. Claude Code manages tokens, automatic refresh, and secure storage without additional configuration."
      },
      {
        "question": "Can I use multiple MCP servers in one plugin?",
        "answer": "Yes, configure multiple servers in .mcp.json or mcpServers. Each server has its own configuration and provides tools with unique prefixes. This is useful for plugins integrating multiple services or combining local and hosted servers."
      },
      {
        "question": "How do I debug MCP server connection issues?",
        "answer": "Run 'claude --debug' to see detailed logs of MCP connections, authentication attempts, and tool calls. Use '/mcp' command to verify servers appear and are connected. Check URL correctness, authentication configuration, and required environment variables."
      },
      {
        "question": "Are environment variables secure for storing credentials?",
        "answer": "Environment variables are more secure than hardcoding credentials in files. They prevent accidental commits to version control and allow users to manage their own secrets. For production, consider using secret management systems, but env vars are acceptable for development and user-managed credentials."
      },
      {
        "question": "What happens when an MCP server becomes unavailable?",
        "answer": "Claude Code attempts reconnection for network-based servers (SSE, HTTP, WebSocket). For stdio servers, the process can be restarted. Commands should handle connection failures gracefully with clear error messages and fallback behaviors."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "Claude Code plugin system",
        "MCP server (stdio process, SSE endpoint, HTTP endpoint, or WebSocket endpoint)",
        "Network connectivity for SSE/HTTP/WebSocket servers",
        "Node.js/Python/other runtime for stdio servers",
        "Environment variables for credentials and configuration"
      ],
      "permissions": [
        "Network access for SSE/HTTP/WebSocket connections",
        "Process execution for stdio servers",
        "File system read access for ${CLAUDE_PLUGIN_ROOT} path resolution",
        "Environment variable access for credential expansion",
        "OAuth browser redirect handling for authentication flows"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "http-server.json",
          "type": "file",
          "path": "examples/http-server.json"
        },
        {
          "name": "sse-server.json",
          "type": "file",
          "path": "examples/sse-server.json"
        },
        {
          "name": "stdio-server.json",
          "type": "file",
          "path": "examples/stdio-server.json"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "authentication.md",
          "type": "file",
          "path": "references/authentication.md"
        },
        {
          "name": "server-types.md",
          "type": "file",
          "path": "references/server-types.md"
        },
        {
          "name": "tool-usage.md",
          "type": "file",
          "path": "references/tool-usage.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}