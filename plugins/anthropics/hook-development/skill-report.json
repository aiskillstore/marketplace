{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-11T06:39:17.122Z",
    "slug": "anthropics-hook-development",
    "source_url": "https://github.com/anthropics/claude-plugins-official/tree/main/plugins/plugin-dev/skills/hook-development",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "271528377492e4c5d328c9851785c52bb6efefdbf17e89fe5be16c12fa4adea0",
    "tree_hash": "ceb76ed5cfd6d14d2a8a3fb632a6bd09f92999822672f3230329e03bfebbc583"
  },
  "skill": {
    "name": "Hook Development",
    "description": "This skill should be used when the user asks to \"create a hook\", \"add a PreToolUse/PostToolUse/Stop hook\", \"validate tool use\", \"implement prompt-based hooks\", \"use ${CLAUDE_PLUGIN_ROOT}\", \"set up event-driven automation\", \"block dangerous commands\", or mentions hook events (PreToolUse, PostToolUse, Stop, SubagentStop, SessionStart, SessionEnd, UserPromptSubmit, PreCompact, Notification). Provides comprehensive guidance for creating and implementing Claude Code plugin hooks with focus on advanced prompt-based hooks API.",
    "summary": "This skill should be used when the user asks to \"create a hook\", \"add a PreToolUse/PostToolUse/Stop ...",
    "icon": "ü™ù",
    "version": "0.1.0",
    "author": "anthropics",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "hooks",
      "automation",
      "security",
      "validation",
      "claude-code"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "external_commands",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "The static analysis flagged 531 patterns, but evaluation reveals these are primarily documentation examples and defensive security implementations. The skill provides security guidance for creating hooks that validate and block dangerous operations. All external command usage is in example validation scripts designed to prevent malicious operations, not perform them.",
    "risk_factor_evidence": [
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "examples/validate-bash.sh",
            "line_start": 1,
            "line_end": 44
          },
          {
            "file": "examples/validate-write.sh",
            "line_start": 1,
            "line_end": 39
          },
          {
            "file": "examples/load-context.sh",
            "line_start": 1,
            "line_end": 56
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "examples/validate-write.sh",
            "line_start": 20,
            "line_end": 35
          },
          {
            "file": "references/patterns.md",
            "line_start": 17,
            "line_end": 17
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 11,
    "total_lines": 2781,
    "audit_model": "claude",
    "audited_at": "2026-01-11T06:39:17.122Z"
  },
  "content": {
    "user_title": "Create Secure Claude Code Hooks for Automation",
    "value_statement": "Claude Code hooks provide event-driven automation but require careful implementation to avoid security vulnerabilities. This skill guides you through creating validation hooks that safely intercept and approve tool operations, preventing dangerous commands while enabling legitimate workflows.",
    "seo_keywords": [
      "Claude Code hooks",
      "Claude plugin development",
      "hook validation",
      "Claude automation",
      "Codex security",
      "prompt-based hooks",
      "PreToolUse hooks",
      "Claude Code security"
    ],
    "actual_capabilities": [
      "Create prompt-based hooks for intelligent validation",
      "Implement command hooks for fast deterministic checks",
      "Build security validators for file operations",
      "Configure PreToolUse, PostToolUse, and Stop hooks",
      "Use ${CLAUDE_PLUGIN_ROOT} for portable paths",
      "Test hooks with sample input before deployment"
    ],
    "limitations": [
      "Hooks require Claude Code session restart to load changes",
      "Command hooks have 60-second timeout by default",
      "All matching hooks run in parallel without order guarantees",
      "Hook scripts must output valid JSON format"
    ],
    "use_cases": [
      {
        "target_user": "Security-conscious developers",
        "title": "Block Dangerous File Operations",
        "description": "Create hooks that prevent writes to system directories, .env files, or paths containing traversal sequences."
      },
      {
        "target_user": "DevOps engineers",
        "title": "Enforce Pre-Deployment Checks",
        "description": "Implement Stop hooks that verify tests pass and builds succeed before allowing Claude to complete tasks."
      },
      {
        "target_user": "Plugin developers",
        "title": "Add Context-Aware Validation",
        "description": "Use prompt-based hooks to intelligently validate operations based on project type and current context."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic Security Hook",
        "scenario": "Prevent dangerous file writes",
        "prompt": "Create a PreToolUse hook that blocks writes to /etc, /sys, .env files, and paths with .. traversal"
      },
      {
        "title": "Test Enforcement",
        "scenario": "Ensure tests run before stopping",
        "prompt": "Create a Stop hook that checks if tests were executed after code changes using PostToolUse events"
      },
      {
        "title": "Context Loading",
        "scenario": "Auto-detect project type on startup",
        "prompt": "Create a SessionStart hook that detects Node.js, Python, or Rust projects and sets environment variables"
      },
      {
        "title": "Advanced Validation",
        "scenario": "Multi-stage security checks",
        "prompt": "Combine command and prompt hooks to first check for obvious threats, then use AI for complex validation"
      }
    ],
    "output_examples": [
      {
        "input": "Create a hook to validate bash commands before execution",
        "output": [
          "Created PreToolUse hook configuration in hooks/hooks.json",
          "Hook blocks: rm -rf, dd, mkfs, sudo commands",
          "Hook asks user for: privilege escalation attempts",
          "Hook approves: ls, pwd, echo, date safely",
          "Test with: scripts/test-hook.sh validate-bash.sh test-input.json"
        ]
      }
    ],
    "best_practices": [
      "Use prompt-based hooks for complex reasoning and command hooks for simple deterministic checks",
      "Always validate inputs in command hooks and quote bash variables to prevent injection",
      "Test hooks thoroughly with sample inputs before deploying to production"
    ],
    "anti_patterns": [
      "Never trust user input without validation - always check file paths and commands",
      "Avoid hardcoded absolute paths - use ${CLAUDE_PLUGIN_ROOT} for portability",
      "Don't create long-running hooks that exceed timeout limits"
    ],
    "faq": [
      {
        "question": "Why are my hook changes not taking effect?",
        "answer": "Hooks load at session start. Exit Claude Code and restart with 'claude' command to reload hook configuration."
      },
      {
        "question": "What's the difference between prompt and command hooks?",
        "answer": "Command hooks execute bash scripts for fast deterministic checks. Prompt hooks use AI for complex reasoning and context-aware decisions."
      },
      {
        "question": "How do I test hooks before deployment?",
        "answer": "Use scripts/test-hook.sh with sample JSON input to test hook behavior and validate JSON output format."
      },
      {
        "question": "Can hooks see each other's output?",
        "answer": "No, all matching hooks run in parallel and cannot see each other's output. Design them to be independent."
      },
      {
        "question": "How do I make hooks project-specific?",
        "answer": "Check for project files or configuration in hook scripts to enable conditional behavior based on project type."
      },
      {
        "question": "What exit codes should command hooks use?",
        "answer": "Exit 0 for approval, exit 2 to block and show stderr to Claude, other codes for non-blocking errors."
      }
    ]
  },
  "file_structure": [
    {
      "name": "examples",
      "type": "dir",
      "path": "examples",
      "children": [
        {
          "name": "load-context.sh",
          "type": "file",
          "path": "examples/load-context.sh"
        },
        {
          "name": "validate-bash.sh",
          "type": "file",
          "path": "examples/validate-bash.sh"
        },
        {
          "name": "validate-write.sh",
          "type": "file",
          "path": "examples/validate-write.sh"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "advanced.md",
          "type": "file",
          "path": "references/advanced.md"
        },
        {
          "name": "migration.md",
          "type": "file",
          "path": "references/migration.md"
        },
        {
          "name": "patterns.md",
          "type": "file",
          "path": "references/patterns.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "hook-linter.sh",
          "type": "file",
          "path": "scripts/hook-linter.sh"
        },
        {
          "name": "README.md",
          "type": "file",
          "path": "scripts/README.md"
        },
        {
          "name": "test-hook.sh",
          "type": "file",
          "path": "scripts/test-hook.sh"
        },
        {
          "name": "validate-hook-schema.sh",
          "type": "file",
          "path": "scripts/validate-hook-schema.sh"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
