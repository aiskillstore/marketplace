{
  "skill": {
    "name": "docx",
    "description": "Comprehensive document creation, editing, and analysis with support for tracked changes, comments, formatting preservation, and text extraction. When Claude needs to work with professional documents (.docx files) for: (1) Creating new documents, (2) Modifying or editing content, (3) Working with tracked changes, (4) Adding comments, or any other document tasks",
    "summary": "Create, edit, and analyze Word documents with tracked changes, comments, and formatting",
    "icon": "ðŸ“„",
    "version": "1.0.0",
    "author": "Anthropic",
    "license": "Proprietary",
    "category": "documentation",
    "tags": ["word", "document", "office", "docx", "editor"],
    "supported_tools": ["claude", "codex", "claude-code"]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Legitimate document manipulation skill using secure XML parsing with defusedxml library. No network calls, no credential access, no persistence mechanisms. External subprocess calls only to trusted tools (soffice, git) with timeouts. Filesystem access limited to user-specified DOCX files and temporary directories.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {"file": "scripts/document.py", "line_start": 1, "line_end": 1293},
          {"file": "scripts/utilities.py", "line_start": 1, "line_end": 375},
          {"file": "ooxml/scripts/unpack.py", "line_start": 1, "line_end": 30},
          {"file": "ooxml/scripts/pack.py", "line_start": 1, "line_end": 160},
          {"file": "ooxml/scripts/validate.py", "line_start": 1, "line_end": 70}
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {"file": "scripts/document.py", "line_start": 637, "line_end": 645},
          {"file": "scripts/utilities.py", "line_start": 55, "line_end": 75},
          {"file": "ooxml/scripts/unpack.py", "line_start": 15, "line_end": 24}
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {"file": "ooxml/scripts/pack.py", "line_start": 103, "line_end": 116},
          {"file": "ooxml/scripts/validation/redlining.py", "line_start": 153, "line_end": 166}
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Subprocess execution to external tools",
        "description": "The skill uses subprocess to execute external commands for document validation and diff comparison. In pack.py:103-116, soffice is called with 10-second timeout for document validation. In redlining.py:153-166, git is called for word diff comparison. These are legitimate uses of trusted system tools but represent potential risk if untrusted commands could be injected. The commands are hardcoded with no user input in command construction, mitigating injection risk.",
        "locations": [
          {"file": "ooxml/scripts/pack.py", "line_start": 103, "line_end": 116},
          {"file": "ooxml/scripts/validation/redlining.py", "line_start": 153, "line_end": 166}
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 12,
    "total_lines": 4200
  },
  "content": {
    "user_title": "Create and edit Word documents",
    "value_statement": "Need to work with professional Word documents. This skill provides complete tools for creating new documents, editing existing files with tracked changes, adding comments, and preserving formatting across all operations.",
    "seo_keywords": ["docx", "word document", "claude code", "microsoft word", "office document", "tracked changes", "document editing", "OOXML", "Word files", "document creation"],
    "actual_capabilities": [
      "Create new Word documents using JavaScript docx library with full formatting",
      "Edit existing documents with tracked changes (redlining) support",
      "Add and manage comments in Word documents",
      "Extract text content from DOCX files using pandoc",
      "Validate document structure against OOXML schemas",
      "Unpack and repack DOCX files as ZIP archives"
    ],
    "limitations": [
      "Cannot edit encrypted or password-protected documents",
      "Requires external tools (pandoc, LibreOffice) for full functionality",
      "Complex formatting may require manual XML editing",
      "Cannot modify documents with digital signatures without invalidating them"
    ],
    "use_cases": [
      {
        "target_user": "Legal professionals",
        "title": "Review contracts with tracked changes",
        "description": "Edit legal documents while preserving all changes for audit trails using Word tracked changes feature"
      },
      {
        "target_user": "Technical writers",
        "title": "Create formatted documentation",
        "description": "Generate professional Word documents with tables, images, headers, and consistent styling"
      },
      {
        "target_user": "Business analysts",
        "title": "Collaborate on reports",
        "description": "Add comments to documents and track all modifications for team review processes"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create simple document",
        "scenario": "Create a basic Word document",
        "prompt": "Create a new Word document named report.docx with a title 'Quarterly Review', a subtitle with the date, and three sections with headings"
      },
      {
        "title": "Edit with tracked changes",
        "scenario": "Modify an existing contract",
        "prompt": "Edit the contract at /path/to/contract.docx to change all occurrences of '30 days' to '45 days' using tracked changes"
      },
      {
        "title": "Add comments",
        "scenario": "Review a document with feedback",
        "prompt": "Add comments to the document at /path/to/proposal.docx explaining the changes needed in each section"
      },
      {
        "title": "Complex document manipulation",
        "scenario": "Combine editing with comments",
        "prompt": "Review /path/to/agreement.docx and implement these specific changes with tracked changes: (1) Update party name on page 2, (2) Change termination clause on page 5, (3) Add comment about liability cap"
      }
    ],
    "output_examples": [
      {
        "input": "Create a simple Word document with a title and two paragraphs",
        "output": [
          "Created document.docx with:",
          "â€¢ Title: 'Project Proposal'",
          "â€¢ Paragraph 1: Introduction text",
          "â€¢ Paragraph 2: Scope description"
        ]
      }
    ],
    "best_practices": [
      "Read the full documentation files (ooxml.md and docx-js.md) before starting complex document operations",
      "Use tracked changes when editing documents that will be reviewed by others",
      "Always validate documents after making changes to catch XML structure issues early"
    ],
    "anti_patterns": [
      "Never modify text inside another author's tracked changes - use nested deletions instead",
      "Do not use standalone PageBreak elements - always wrap in Paragraph",
      "Avoid unicode bullets - use proper numbering configuration with LevelFormat.BULLET"
    ],
    "faq": [
      {
        "question": "What file formats are supported?",
        "answer": "Supports .docx (Word), .pptx (PowerPoint), and .xlsx (Excel) files. PDF conversion requires LibreOffice."
      },
      {
        "question": "What are the size limits?",
        "answer": "No explicit limits. Large documents may require more memory and processing time. XML validation scales with file size."
      },
      {
        "question": "Can I integrate with other tools?",
        "answer": "Yes. Works with pandoc for text extraction, LibreOffice for PDF conversion, and git for diff comparison."
      },
      {
        "question": "Is my data safe?",
        "answer": "Yes. All operations are local. Documents are worked on in temporary directories. No network calls or credential access."
      },
      {
        "question": "Why does validation fail?",
        "answer": "Common causes: XML structure issues, missing relationship references, invalid element ordering, or whitespace preservation errors."
      },
      {
        "question": "How is this different from python-docx?",
        "answer": "This skill provides direct OOXML manipulation for precise control over tracked changes, comments, and complex formatting that high-level libraries cannot handle."
      }
    ]
  }
}
