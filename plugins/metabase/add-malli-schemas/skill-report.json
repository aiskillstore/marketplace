{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T10:49:09.120Z",
    "slug": "metabase/add-malli-schemas",
    "source_url": "https://github.com/metabase/metabase/tree/master/.claude/skills/add-malli-schemas",
    "source_ref": "master",
    "model": "codex",
    "analysis_version": "2.0.0",
    "source_type": "community"
  },
  "skill": {
    "name": "add-malli-schemas",
    "description": "Efficiently add Malli schemas to API endpoints in the Metabase codebase with proper patterns, validation timing, and error handling",
    "summary": "Efficiently add Malli schemas to API endpoints in the Metabase codebase with proper patterns, valida...",
    "icon": "ðŸ§©",
    "version": "1.0.0",
    "license": "MIT",
    "category": "coding",
    "tags": [
      "clojure",
      "malli",
      "metabase",
      "api",
      "schemas"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "The skill file contains guidance text and examples only. No file access, network calls, or execution patterns are present.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 420,
    "audit_model": "codex",
    "audited_at": "2025-12-31T10:49:09.119Z"
  },
  "content": {
    "user_title": "Add Malli schemas to Metabase endpoints",
    "value_statement": "Adding schemas to endpoints is repetitive and error prone. This skill provides patterns, examples, and checks for consistent Malli validation.",
    "seo_keywords": [
      "Malli schemas",
      "Metabase API",
      "Clojure validation",
      "endpoint schemas",
      "schema patterns",
      "Claude",
      "Codex",
      "Claude Code",
      "API error handling",
      "Malli registry"
    ],
    "actual_capabilities": [
      "Provides a checklist for route, query, body, and response schemas",
      "Shows patterns for optional parameters and default values",
      "Explains validation timing for request versus response schemas",
      "Demonstrates named schemas and reusable schema definitions",
      "Lists testing steps for valid and invalid requests"
    ],
    "limitations": [
      "Does not modify code automatically",
      "Focused on Metabase Clojure endpoints and Malli usage",
      "Requires you to determine actual return types",
      "Does not run tests or execute commands"
    ],
    "use_cases": [
      {
        "target_user": "Backend developer",
        "title": "Harden API validation",
        "description": "Add request and response schemas to new or existing endpoints with consistent patterns."
      },
      {
        "target_user": "Code reviewer",
        "title": "Standardize schema style",
        "description": "Check schema usage for optional fields, defaults, and named schema reuse."
      },
      {
        "target_user": "Tech lead",
        "title": "Reduce API regressions",
        "description": "Apply validation timing rules to prevent schema mismatches in responses."
      }
    ],
    "prompt_templates": [
      {
        "title": "Add basic schemas",
        "scenario": "Single endpoint with route and query params",
        "prompt": "Add Malli schemas for route and query params to this endpoint and note any optional or default fields."
      },
      {
        "title": "Define response schema",
        "scenario": "Endpoint returns a map with nested data",
        "prompt": "Infer the response shape and propose a named Malli schema for the endpoint return value."
      },
      {
        "title": "Review for pitfalls",
        "scenario": "Existing schema usage seems inconsistent",
        "prompt": "Review this endpoint schema usage and list any pitfalls such as missing :maybe or optional query params."
      },
      {
        "title": "Advanced validation timing",
        "scenario": "Response includes Java time objects",
        "prompt": "Adjust the response schema to handle Java time objects and explain why :any is needed."
      }
    ],
    "output_examples": [
      {
        "input": "Update GET /api/field/:id/related with a response schema and point out validation timing concerns.",
        "output": [
          "Define a named response schema for tables and fields with id and name",
          "Attach the schema to the endpoint using the response annotation",
          "Note that response validation happens before JSON serialization",
          "Avoid string-only time schemas for Java time objects"
        ]
      }
    ],
    "best_practices": [
      "Reuse schemas from the ms namespace when possible",
      "Add :optional and :default for query parameters",
      "Use named schemas for complex or repeated structures"
    ],
    "anti_patterns": [
      "Mix route, query, and body params in one schema map",
      "Use ms/TemporalString in response schemas",
      "Treat sets as sequential collections in response schemas"
    ],
    "faq": [
      {
        "question": "Is this compatible with any Clojure project?",
        "answer": "It is tailored to Metabase conventions and Malli usage, so other projects may need adaptation."
      },
      {
        "question": "What are the limits of this skill?",
        "answer": "It provides guidance and examples, but it does not edit files or verify return types for you."
      },
      {
        "question": "How does it integrate with my workflow?",
        "answer": "Use it while editing endpoints to structure params, responses, and validation rules."
      },
      {
        "question": "Does it access or send my data?",
        "answer": "No. It only provides static guidance and examples."
      },
      {
        "question": "What if a schema fails validation?",
        "answer": "Check for missing :maybe, incorrect collection types, or response timing mismatches."
      },
      {
        "question": "How does it compare to a linter?",
        "answer": "It is a guided reference, not an automated checker."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
