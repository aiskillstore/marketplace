{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T11:03:28.055Z",
    "slug": "agentsecops-secrets-gitleaks",
    "source_url": "https://github.com/AgentSecOps/SecOpsAgentKit/tree/main/skills/devsecops/secrets-gitleaks",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "be2136657bae58526d7a93eaaba982cfd4e5c65e065b086c0312b5b6446c3d5e",
    "tree_hash": "4604ff40f5b62e2761c5fb6f09b368f1c4e9c7383cd116fe00d730f95f0ad394"
  },
  "skill": {
    "name": "secrets-gitleaks",
    "description": "Hardcoded secret detection and prevention in git repositories and codebases using Gitleaks. Identifies passwords, API keys, tokens, and credentials through regex-based pattern matching and entropy analysis. Use when: (1) Scanning repositories for exposed secrets and credentials, (2) Implementing pre-commit hooks to prevent secret leakage, (3) Integrating secret detection into CI/CD pipelines, (4) Auditing codebases for compliance violations (PCI-DSS, SOC2, GDPR), (5) Establishing baseline secret detection and tracking new exposures, (6) Remediating historical secret exposures in git history.\n",
    "summary": "Hardcoded secret detection and prevention in git repositories and codebases using Gitleaks. Identifi...",
    "icon": "üîê",
    "version": "0.1.0",
    "author": "AgentSecOps",
    "license": "MIT",
    "category": "devsecops",
    "tags": [
      "secrets",
      "gitleaks",
      "secret-scanning",
      "devsecops",
      "ci-cd",
      "credentials",
      "api-keys",
      "compliance"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "external_commands",
      "network",
      "filesystem"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a defensive security tool that detects hardcoded secrets. Documentation-only skill with configuration templates and CI/CD workflows. No executable scripts included in the bundle. Legitimate security scanning functionality with no malicious patterns.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 213,
            "line_end": 219
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 36,
            "line_end": 48
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "assets/github-action.yml",
            "line_start": 127,
            "line_end": 143
          }
        ]
      },
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 58,
            "line_end": 69
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 12,
    "total_lines": 3311,
    "audit_model": "claude",
    "audited_at": "2026-01-10T11:03:28.055Z"
  },
  "content": {
    "user_title": "Detect hardcoded secrets with Gitleaks",
    "value_statement": "Hardcoded secrets in code lead to data breaches and unauthorized access. This skill integrates Gitleaks for automated secret detection in repositories, CI/CD pipelines, and pre-commit hooks.",
    "seo_keywords": [
      "gitleaks",
      "secret detection",
      "hardcoded secrets",
      "credential scanning",
      "CI/CD security",
      "pre-commit hooks",
      "Claude",
      "Codex",
      "Claude Code",
      "DevSecOps"
    ],
    "actual_capabilities": [
      "Scan repositories for passwords, API keys, tokens, and credentials",
      "Generate JSON, SARIF, and human-readable scan reports",
      "Configure pre-commit hooks to prevent secret commits",
      "Integrate secret scanning into GitHub Actions and GitLab CI",
      "Create baselines for incremental secret detection",
      "Map findings to compliance frameworks (PCI-DSS, SOC2, GDPR)"
    ],
    "limitations": [
      "Cannot remediate secrets already pushed to public repositories",
      "May require tuning to reduce false positives in test code",
      "Requires Gitleaks binary to be installed or available via Docker",
      "Cannot detect encrypted or dynamically generated secrets"
    ],
    "use_cases": [
      {
        "target_user": "Security Engineers",
        "title": "Automated Secret Scanning",
        "description": "Set up continuous secret scanning in CI/CD pipelines with automated reporting and alerting"
      },
      {
        "target_user": "DevOps Teams",
        "title": "Pre-commit Protection",
        "description": "Install pre-commit hooks to prevent developers from accidentally committing secrets"
      },
      {
        "target_user": "Compliance Teams",
        "title": "Audit Trail Generation",
        "description": "Generate compliance reports mapping secret findings to PCI-DSS, SOC2, and GDPR requirements"
      }
    ],
    "prompt_templates": [
      {
        "title": "Quick Scan",
        "scenario": "Run a simple repository scan",
        "prompt": "Scan this repository for hardcoded secrets using Gitleaks and report all findings with file locations and rule types."
      },
      {
        "title": "CI/CD Integration",
        "scenario": "Set up GitHub Actions workflow",
        "prompt": "Create a GitHub Actions workflow file that runs Gitleaks secret scanning on every push and pull request, with SARIF output for the Security tab."
      },
      {
        "title": "False Positive Tuning",
        "scenario": "Reduce false positives",
        "prompt": "Help me configure Gitleaks allowlists to reduce false positives from test fixtures and documentation examples while maintaining security coverage."
      },
      {
        "title": "Compliance Report",
        "scenario": "Generate audit documentation",
        "prompt": "Generate a compliance report from Gitleaks findings showing how detected secrets map to PCI-DSS Requirement 6.5.3 and SOC2 CC6.1 controls."
      }
    ],
    "output_examples": [
      {
        "input": "Scan this repository for hardcoded secrets",
        "output": [
          "Found 3 potential secrets:",
          "  ‚Ä¢ File: config/database.py:42 - Hardcoded database password (HIGH)",
          "  ‚Ä¢ File: src/api/client.go:15 - AWS Access Key ID (CRITICAL)",
          "  ‚Ä¢ File: tests/fixtures/auth.json:8 - Stripe test key (MEDIUM)",
          "",
          "Recommendation: Rotate exposed credentials immediately and migrate to environment variables or secret management."
        ]
      }
    ],
    "best_practices": [
      "Always use the --redact flag when sharing scan outputs to prevent accidental secret exposure",
      "Install pre-commit hooks on developer workstations before any code is committed",
      "Create a baseline file for legacy repositories to focus on new secret exposure only",
      "Integrate findings with SIEM tools for centralized security monitoring"
    ],
    "anti_patterns": [
      "Skipping secret scanning in CI/CD to avoid blocking builds",
      "Allowlisting entire directories without reviewing individual false positives",
      "Sharing unredacted Gitleaks reports in public channels or tickets",
      "Rotating credentials without cleaning git history for public repositories"
    ],
    "faq": [
      {
        "question": "Does Gitleaks work with private repositories?",
        "answer": "Yes, Gitleaks scans local git history and works with private repositories when run locally or in CI/CD with repository access."
      },
      {
        "question": "How do I reduce false positives from test code?",
        "answer": "Add test directories to the allowlist in your .gitleaks.toml configuration, or use stopwords for placeholder patterns like EXAMPLE or TEST."
      },
      {
        "question": "Can I integrate Gitleaks with Jenkins?",
        "answer": "Yes, run Gitleaks via Docker or install the binary in your Jenkins pipeline stages using the standard sh step."
      },
      {
        "question": "Are scan reports safe to share?",
        "answer": "Only share reports with --redact flag enabled. Unredacted reports contain actual secret values and should be treated as confidential."
      },
      {
        "question": "What is the difference between detect and protect commands?",
        "answer": "gitleaks detect scans repository history, while gitleaks protect checks staged changes before commit (pre-commit hooks)."
      },
      {
        "question": "How does Gitleaks compare to other secret scanners?",
        "answer": "Gitleaks provides comprehensive regex patterns, entropy analysis, and git history scanning. It is open source with active maintenance and broad CI/CD integration support."
      }
    ]
  },
  "file_structure": [
    {
      "name": "assets",
      "type": "dir",
      "path": "assets",
      "children": [
        {
          "name": "config-balanced.toml",
          "type": "file",
          "path": "assets/config-balanced.toml"
        },
        {
          "name": "config-custom.toml",
          "type": "file",
          "path": "assets/config-custom.toml"
        },
        {
          "name": "config-strict.toml",
          "type": "file",
          "path": "assets/config-strict.toml"
        },
        {
          "name": "github-action.yml",
          "type": "file",
          "path": "assets/github-action.yml"
        },
        {
          "name": "gitlab-ci.yml",
          "type": "file",
          "path": "assets/gitlab-ci.yml"
        },
        {
          "name": "precommit-config.yaml",
          "type": "file",
          "path": "assets/precommit-config.yaml"
        }
      ]
    },
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "compliance_mapping.md",
          "type": "file",
          "path": "references/compliance_mapping.md"
        },
        {
          "name": "detection_rules.md",
          "type": "file",
          "path": "references/detection_rules.md"
        },
        {
          "name": "EXAMPLE.md",
          "type": "file",
          "path": "references/EXAMPLE.md"
        },
        {
          "name": "false_positives.md",
          "type": "file",
          "path": "references/false_positives.md"
        },
        {
          "name": "remediation_guide.md",
          "type": "file",
          "path": "references/remediation_guide.md"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
