{
  "meta": {
    "generated_at": "2025-12-29T09:02:14Z",
    "model": "gpt-5.2:high",
    "source_url": "https://github.com/anthropics/claude-code",
    "source_ref": "d213a74fc8e3b6efded52729196e0c2d4c3abb3e",
    "analysis_version": "2.0.0"
  },
  "security_audit": {
    "risk_level": "safe",
    "should_block": false,
    "safe_to_publish": true,
    "summary": "The skill consists solely of a Markdown documentation file (SKILL.md) describing how to write Hookify rules. It contains no executable code, no network functionality, and no file-system access logic. No indicators of data theft, malicious execution, persistence, payload download/execute, or obfuscation are present.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Contains examples referencing potentially dangerous commands",
        "description": "Documentation includes example patterns matching commands like `rm -rf`, `sudo`, `chmod 777`, `dd`, and `mkfs`. These are shown as detection targets for safety rules, not as instructions to execute them.",
        "files": [
          "SKILL.md"
        ],
        "category": "documentation-risk"
      }
    ],
    "files_analyzed": 1,
    "dangerous_patterns_found": [
      {
        "pattern_type": "dangerous-command-keywords-in-docs",
        "matches": [
          "rm -rf",
          "sudo",
          "chmod 777",
          "dd if=",
          "mkfs",
          "curl/wget mentioned only as conceptual threats? (not present as code)",
          "python3 -c (regex testing example only)"
        ],
        "context": "All occurrences are within explanatory examples for writing safety rules; no executable implementation exists."
      }
    ],
    "files_scanned": 1,
    "total_lines": 374
  },
  "content": {
    "user_title": "Create Hookify Rules to Catch Risky Actions",
    "value_statement": "Writing Hookify rules can be confusing: events, regex patterns, and multi-condition logic are easy to get wrong. This skill provides clear templates and practical pattern tips so you can reliably warn or block risky commands and code changes.",
    "seo_keywords": [
      "Hookify rules",
      "Claude Code",
      "regex patterns",
      "YAML frontmatter",
      "developer guardrails",
      "security linting",
      "bash command blocking",
      "file edit hooks",
      "workflow automation",
      "pre-commit style checks"
    ],
    "actual_capabilities": [
      "Explains Hookify rule structure (Markdown + YAML frontmatter) and required fields",
      "Provides event guidance for `bash`, `file`, `stop`, `prompt`, and `all` triggers",
      "Shows how to write simple regex `pattern` rules and advanced multi-`conditions` rules",
      "Lists common safety-oriented patterns (dangerous commands, debug logs, risky APIs like `eval`/`innerHTML`)",
      "Offers practical regex tips (escaping, avoiding overly broad/specific patterns, testing patterns)"
    ],
    "limitations": [
      "Does not execute or validate rules automatically; it documents syntax and examples only",
      "Cannot guarantee a regex fully prevents all dangerous variants without careful tuning",
      "Assumes Hookify supports the described fields/operators; behavior depends on the user’s Hookify/Claude Code environment",
      "No built-in repository scanning, enforcement, or CI integration is implemented in this skill content"
    ],
    "use_cases": [
      {
        "target_user": "Team lead / security-minded engineer",
        "title": "Block destructive shell commands",
        "description": "Create a `bash` event rule to warn or block patterns like `rm -rf`, `mkfs`, or privilege escalation to reduce accidental damage."
      },
      {
        "target_user": "Frontend engineer",
        "title": "Catch risky browser-side code changes",
        "description": "Add `file` event rules that flag `eval(`, `innerHTML =`, or `dangerouslySetInnerHTML` in JS/TS files with actionable remediation guidance."
      },
      {
        "target_user": "DevOps / release engineer",
        "title": "Add stop-time completion checklists",
        "description": "Use `stop` event rules to enforce consistent end-of-task checks like running tests, updating docs, or verifying builds before the agent stops."
      }
    ],
    "prompt_templates": [
      {
        "title": "Beginner: warn on dangerous rm",
        "prompt": "Create a Hookify rule that triggers on bash commands and warns when it sees 'rm -rf'. Use a safe regex and include a short explanation and safer alternatives.",
        "difficulty": "beginner"
      },
      {
        "title": "Intermediate: console.log in TS only",
        "prompt": "Write a Hookify file rule using conditions: trigger only when editing .ts or .tsx files AND the new_text includes console.log(. Provide a message that suggests proper logging and removing before commit.",
        "difficulty": "intermediate"
      },
      {
        "title": "Advanced: .env key leakage warning",
        "prompt": "Create an advanced Hookify rule that triggers on file edits where file_path ends with .env AND new_text contains 'API_KEY' or 'SECRET'. Message should remind to keep .env out of git and rotate leaked keys.",
        "difficulty": "advanced"
      },
      {
        "title": "Expert: block + checklist on production prompts",
        "prompt": "Write a Hookify rule for prompt events that detects 'deploy to production' and returns a structured checklist. If action=block is supported for this event, set it to block and explain how to proceed safely.",
        "difficulty": "expert"
      }
    ],
    "output_examples": [
      {
        "title": "Example Hookify rule (file event, multi-condition)",
        "description": "A complete Markdown rule file with YAML frontmatter using `conditions` to match `.env` edits and key-like strings, followed by a clear warning message and remediation steps."
      }
    ],
    "best_practices": [
      "Prefer multi-condition rules (file_path + new_text) to reduce false positives",
      "Keep regex patterns unquoted in YAML when possible to avoid double-escaping issues",
      "Include actionable messages: what matched, why it matters, and safer alternatives"
    ],
    "anti_patterns": [
      "Writing overly broad patterns (e.g., `pattern: log`) that trigger constantly",
      "Hard-coding exact command strings/paths that miss common variants (spacing, flags, different paths)",
      "Forgetting to add `.claude/*.local.md` to `.gitignore` when rules are intended to stay local"
    ],
    "faq": [
      {
        "question": "What platforms does this work on?",
        "answer": "The skill documents Hookify rule syntax for Claude Code/Hookify workflows; it is platform-agnostic as it only describes Markdown/YAML rules. Actual behavior depends on the Hookify implementation in your Claude Code environment."
      },
      {
        "question": "Does it block commands or only warn?",
        "answer": "It documents both `warn` (default) and `block` actions where supported, but enforcement depends on the event type and Hookify runtime behavior."
      },
      {
        "question": "Can it integrate with CI or pre-commit?",
        "answer": "This skill does not implement CI/pre-commit integration; it provides patterns you can adapt into your own process or tooling around Hookify."
      },
      {
        "question": "Is my data sent anywhere?",
        "answer": "No. The analyzed content is documentation only and contains no code for network requests, file reads, or data collection."
      },
      {
        "question": "My rule isn’t triggering—what should I check?",
        "answer": "Verify `enabled: true`, confirm the correct `event` type, test the regex against sample text, and ensure you’re matching the right field (`command` for bash; `file_path`/`new_text` for file)."
      },
      {
        "question": "How is this different from linters or static analysis tools?",
        "answer": "Linters analyze code structure and style; Hookify rules are event-driven matchers that can trigger on commands, file edits, stop events, or prompts, making them useful for workflow guardrails and contextual reminders."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "Claude Code environment with Hookify support",
        "Ability to create files under `.claude/`"
      ],
      "permissions_needed": [
        "Write access to the project directory to create `.claude/hookify.*.local.md` files"
      ],
      "estimated_complexity": "low",
      "setup_time_minutes": 2
    }
  }
}
