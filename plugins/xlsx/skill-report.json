{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T05:40:08.773Z",
    "slug": "xlsx",
    "source_url": "https://github.com/anthropics/skills/tree/main/skills/xlsx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "xlsx",
    "description": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas",
    "summary": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, dat...",
    "icon": "ðŸ“Š",
    "version": "1.0.0",
    "author": "Anthropic",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "data",
    "tags": [
      "excel",
      "spreadsheets",
      "data-analysis",
      "formulas",
      "xlsx",
      "csv",
      "pandas",
      "openpyxl",
      "financial-modeling",
      "visualization"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill with minimal risk. Uses subprocess for LibreOffice automation with proper timeout controls. No network access, credentials, or dangerous system operations.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Subprocess execution with user-controlled file path",
        "description": "The recalc.py script executes LibreOffice via subprocess with user-provided file paths. While path validation exists (checks file existence and converts to absolute path), the script doesn't sanitize file paths for special characters. However, risk is mitigated by: (1) no shell=True usage, (2) file existence verification, (3) timeout controls, (4) LibreOffice runs in headless mode without network access.",
        "locations": [
          {
            "file": "recalc.py",
            "line_start": 74,
            "line_end": 90
          }
        ]
      },
      {
        "title": "File system operations in user directories",
        "description": "The script creates and writes LibreOffice macro files in user config directories (~/.config or ~/Library). While necessary for functionality, it modifies user's LibreOffice configuration. This is expected behavior for the tool but users should be aware.",
        "locations": [
          {
            "file": "recalc.py",
            "line_start": 15,
            "line_end": 47
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 498,
    "audit_model": "claude",
    "audited_at": "2025-12-31T05:40:08.773Z"
  },
  "content": {
    "user_title": "Excel Spreadsheet Creation & Analysis",
    "value_statement": "Create professional Excel spreadsheets with formulas and formatting, analyze data with pandas, and ensure zero formula errors with automated recalculation.",
    "seo_keywords": [
      "excel automation",
      "spreadsheet creation",
      "financial modeling",
      "data analysis",
      "formula recalculation",
      "xlsx editing",
      "pandas excel",
      "openpyxl",
      "spreadsheet formulas",
      "excel formatting"
    ],
    "actual_capabilities": [
      "Create new Excel files with formulas, formatting, and multiple sheets using openpyxl",
      "Edit existing Excel files while preserving formulas and formatting",
      "Analyze data from spreadsheets using pandas for statistics and visualization",
      "Automatically recalculate all Excel formulas using LibreOffice",
      "Detect and report formula errors (#REF!, #DIV/0!, #VALUE!, etc.) across all cells",
      "Apply professional formatting including colors, fonts, alignment, and column widths",
      "Build financial models following industry-standard color coding conventions",
      "Handle multiple worksheets within a single workbook",
      "Read and write CSV, TSV, and other tabular formats",
      "Insert and delete rows/columns while maintaining formula references"
    ],
    "limitations": [
      "Requires LibreOffice to be installed for formula recalculation functionality",
      "Formula recalculation requires subprocess execution with timeout limits (default 30s)",
      "Opening Excel files with data_only=True and saving will permanently replace formulas with values",
      "Cannot execute VBA macros or preserve them perfectly in all cases",
      "Large files may require special read_only or write_only modes for performance",
      "Does not support all advanced Excel features like pivot tables, charts, or conditional formatting rules"
    ],
    "use_cases": [
      {
        "title": "Financial Model Creation",
        "description": "Build professional financial models with proper color coding (blue for inputs, black for formulas, green for internal links), formatted numbers, and documented assumptions. Automatically verify zero formula errors before delivery.",
        "target_user": "Financial analysts, investment bankers, CFOs"
      },
      {
        "title": "Data Analysis & Reporting",
        "description": "Import datasets from Excel files, perform statistical analysis using pandas, and export results back to formatted Excel reports with calculated fields and professional styling.",
        "target_user": "Data analysts, business intelligence professionals, researchers"
      },
      {
        "title": "Template Modification",
        "description": "Update existing Excel templates while preserving established formatting, formulas, and conventions. Add new calculated fields that automatically update when source data changes.",
        "target_user": "Business users, operations teams, template maintainers"
      },
      {
        "title": "Bulk Data Processing",
        "description": "Process multiple CSV/Excel files, combine data, perform calculations, and generate consolidated reports with formulas that remain dynamic for future updates.",
        "target_user": "Data engineers, automation specialists, operations teams"
      },
      {
        "title": "Formula Validation",
        "description": "Scan existing Excel files for formula errors, recalculate all formulas, and generate detailed error reports showing exact cell locations of issues like #REF!, #DIV/0!, and #VALUE! errors.",
        "target_user": "Quality assurance teams, auditors, spreadsheet maintainers"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Financial Model",
        "prompt": "Create a 5-year revenue projection model in Excel with: (1) Blue-colored assumption cells for growth rate, (2) Black-colored formulas calculating yearly revenue, (3) Proper formatting with currency showing millions, (4) Zero formula errors verified by recalc.py",
        "scenario": "Building a financial forecast with industry-standard formatting"
      },
      {
        "title": "Analyze Sales Data",
        "prompt": "Load sales_data.xlsx and create a summary showing: (1) Total revenue by product category, (2) Month-over-month growth percentages, (3) Top 10 customers by revenue. Export results to a formatted Excel file with formulas.",
        "scenario": "Analyzing business data and creating executive reports"
      },
      {
        "title": "Fix Formula Errors",
        "prompt": "Open financial_model.xlsx, run recalc.py to identify all formula errors, and fix each #REF! and #DIV/0! error. Document what was wrong and verify final file has zero errors.",
        "scenario": "Debugging and fixing broken spreadsheet formulas"
      },
      {
        "title": "Update Existing Template",
        "prompt": "Modify quarterly_report.xlsx to add a new 'Variance Analysis' column that calculates the percentage difference between actual and budget. Match existing formatting exactly and preserve all existing formulas.",
        "scenario": "Enhancing templates while maintaining consistency"
      },
      {
        "title": "Consolidate Multiple Files",
        "prompt": "Read data from Q1.xlsx, Q2.xlsx, Q3.xlsx, and Q4.xlsx. Combine into annual_summary.xlsx with a YTD total row using SUM formulas. Include month-over-month growth calculations.",
        "scenario": "Combining periodic reports into consolidated views"
      }
    ],
    "output_examples": [
      {
        "input": "Create a simple budget spreadsheet with income and expenses",
        "output": "Excel file created with:\n- Row 1: Headers (Category, Amount, % of Total)\n- Rows 2-5: Income items with blue text\n- Rows 6-10: Expense items with blue text\n- Row 11: Total Income formula =SUM(B2:B5) in black\n- Row 12: Total Expenses formula =SUM(B6:B10) in black\n- Row 13: Net Income formula =B11-B12 in black\n- Column C: Percentage formulas =B2/$B$11 formatted as 0.0%\n- Recalc.py output: {\"status\": \"success\", \"total_errors\": 0, \"total_formulas\": 12}"
      },
      {
        "input": "Analyze customer_data.xlsx and find top 5 customers",
        "output": "Analysis complete:\n- Loaded 1,247 customer records\n- Top 5 customers by revenue:\n  1. Acme Corp - $450,000\n  2. GlobalTech - $380,000\n  3. Innovation Inc - $295,000\n  4. TechStart - $275,000\n  5. DataFlow - $250,000\n- Created top_customers.xlsx with formatted output and SUM formula for total: $1,650,000"
      }
    ],
    "best_practices": [
      "Always use Excel formulas instead of hardcoding calculated values to keep spreadsheets dynamic",
      "Run recalc.py after creating or modifying files with formulas to ensure zero errors",
      "Follow financial modeling color conventions: blue for inputs, black for formulas, green for internal links",
      "Format zeros as dashes using number format: $#,##0;($#,##0);-",
      "Place all assumptions in separate cells and reference them in formulas instead of hardcoding values",
      "Document sources for hardcoded data with format: 'Source: [Document], [Date], [Reference]'",
      "Test formulas on 2-3 sample cells before applying broadly across large ranges",
      "When modifying existing templates, study and match the established formatting conventions exactly",
      "Use pandas for data analysis and openpyxl for formula creation and complex formatting",
      "Verify cell references are correct (remember Excel is 1-indexed, pandas DataFrames are 0-indexed)"
    ],
    "anti_patterns": [
      "Never calculate values in Python and hardcode them - use Excel formulas instead",
      "Don't open files with data_only=True and save them, as this permanently deletes formulas",
      "Avoid imposing standardized formatting on files with established patterns",
      "Don't create formulas without verifying them with recalc.py",
      "Never deliver spreadsheets with formula errors (#REF!, #DIV/0!, #VALUE!, etc.)",
      "Don't use hardcoded values in formulas - reference assumption cells instead",
      "Avoid verbose Python code with excessive comments - keep Excel automation code concise",
      "Don't format years as numbers (2,024) - use text strings ('2024')",
      "Never skip testing edge cases like zero values and negative numbers in formulas"
    ],
    "faq": [
      {
        "question": "Why do I need LibreOffice installed?",
        "answer": "LibreOffice is required to recalculate Excel formulas. Python libraries like openpyxl can write formulas as text, but cannot calculate their results. The recalc.py script uses LibreOffice in headless mode to evaluate all formulas and detect errors."
      },
      {
        "question": "What's the difference between pandas and openpyxl?",
        "answer": "Use pandas for data analysis, reading data, and simple exports. Use openpyxl when you need Excel-specific features like formulas, complex formatting, color coding, or need to preserve existing spreadsheet structure."
      },
      {
        "question": "How do I avoid formula errors?",
        "answer": "Follow these steps: (1) Test formulas on 2-3 cells first, (2) Verify cell references match your data layout, (3) Check for division by zero, (4) Run recalc.py to detect errors, (5) Fix any errors shown in the JSON output, (6) Recalculate again to verify zero errors."
      },
      {
        "question": "What do the financial modeling color codes mean?",
        "answer": "Blue text = hardcoded inputs users change, Black text = formulas and calculations, Green text = links to other sheets in same workbook, Red text = external file links, Yellow background = key assumptions needing attention."
      },
      {
        "question": "Can I modify an existing Excel file without breaking it?",
        "answer": "Yes, use load_workbook() from openpyxl to open the file, make your changes, and save. Formulas and formatting are preserved. Just avoid opening with data_only=True if you plan to save, as this replaces formulas with their values."
      },
      {
        "question": "What does the recalc.py output mean?",
        "answer": "The script returns JSON showing: 'status' (success or errors_found), 'total_errors' (count of Excel errors), 'total_formulas' (formulas in file), and 'error_summary' (breakdown by error type with exact cell locations like Sheet1!B5)."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "Python 3",
        "openpyxl",
        "pandas",
        "LibreOffice (for formula recalculation)"
      ],
      "permissions": [
        "Read/write access to Excel files",
        "Execute subprocess commands",
        "Write to LibreOffice config directory (~/.config or ~/Library)"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "recalc.py",
      "type": "file",
      "path": "recalc.py"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}