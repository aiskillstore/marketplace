{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-31T06:29:29.613Z",
    "slug": "xlsx",
    "source_url": "https://github.com/anthropics/skills/tree/main/skills/xlsx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "xlsx",
    "description": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas",
    "summary": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, dat...",
    "icon": "ðŸ“Š",
    "version": "1.0.0",
    "author": "Anthropic",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "data",
    "tags": [
      "excel",
      "spreadsheet",
      "xlsx",
      "formulas",
      "data-analysis",
      "pandas",
      "openpyxl",
      "financial-modeling",
      "csv"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill with no security concerns. Uses standard Python libraries (openpyxl, pandas) and LibreOffice for spreadsheet operations. No network calls, no unsafe file operations, no code execution vulnerabilities.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Subprocess execution with user-controlled file path",
        "description": "The recalc.py script executes LibreOffice with a user-provided file path. While the path is converted to absolute path using Path.absolute(), this is acceptable for a tool designed to process user files. No command injection risk as the path is passed as a separate argument, not concatenated into a shell command.",
        "locations": [
          {
            "file": "recalc.py",
            "line_start": 68,
            "line_end": 90
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 498,
    "audit_model": "claude",
    "audited_at": "2025-12-31T06:29:29.613Z"
  },
  "content": {
    "user_title": "Excel Spreadsheet Builder & Analyzer",
    "value_statement": "Create professional Excel spreadsheets with formulas and formatting, analyze data with pandas, and ensure zero formula errors with automated validation.",
    "seo_keywords": [
      "excel automation",
      "spreadsheet creation",
      "financial modeling",
      "xlsx formulas",
      "data analysis",
      "pandas excel",
      "openpyxl",
      "spreadsheet formatting"
    ],
    "actual_capabilities": [
      "Create new Excel files with formulas, formatting, and multiple sheets using openpyxl",
      "Edit existing Excel files while preserving formulas and formatting",
      "Read and analyze spreadsheet data using pandas",
      "Apply professional formatting including fonts, colors, alignment, and number formats",
      "Recalculate all formulas using LibreOffice integration",
      "Detect and report formula errors (#REF!, #DIV/0!, #VALUE!, etc.) across all sheets",
      "Support financial modeling with industry-standard color coding and formatting conventions",
      "Handle multiple file formats: .xlsx, .xlsm, .csv, .tsv",
      "Work with multiple sheets within a workbook",
      "Insert/delete rows and columns programmatically"
    ],
    "limitations": [
      "Requires LibreOffice to be installed for formula recalculation",
      "Formula recalculation has configurable timeout (default 30 seconds)",
      "Cannot execute VBA macros in .xlsm files",
      "Read-only mode with data_only=True permanently loses formulas if saved",
      "Very large files may require memory optimization flags (read_only/write_only)",
      "Does not support Excel charting/visualization creation (only data analysis)"
    ],
    "use_cases": [
      {
        "title": "Financial Model Creation",
        "description": "Build three-statement financial models with proper color coding (blue inputs, black formulas, green cross-references), formula-based calculations, and zero errors. Perfect for DCF models, budget templates, and forecasting.",
        "target_user": "Financial analysts, investment bankers, CFOs, accountants"
      },
      {
        "title": "Data Analysis & Reporting",
        "description": "Transform raw data into formatted Excel reports with calculated metrics, summary statistics, and professional formatting. Use pandas for complex data manipulation before Excel export.",
        "target_user": "Data analysts, business intelligence teams, operations managers"
      },
      {
        "title": "Template Modification",
        "description": "Update existing Excel templates with new data while preserving all formulas, formatting, and structure. Ideal for monthly reports, recurring analysis, and standardized templates.",
        "target_user": "Business users who maintain recurring Excel reports"
      },
      {
        "title": "Quality Assurance for Spreadsheets",
        "description": "Validate Excel files to ensure zero formula errors before distribution. Automatically scans all sheets and reports error locations with detailed breakdowns by error type.",
        "target_user": "Teams sharing critical Excel files, auditors, quality control"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Financial Projection Model",
        "prompt": "Create a 5-year revenue projection model in Excel with these assumptions: starting revenue of $10M, 15% annual growth, 40% gross margin, and 20% operating expenses. Use proper financial modeling conventions with blue inputs and formulas. Include sensitivity analysis.",
        "scenario": "Building a quick financial forecast for a business plan"
      },
      {
        "title": "Analyze Sales Data",
        "prompt": "Read sales_data.csv and create an Excel report showing: (1) monthly revenue trends, (2) top 10 products by revenue, (3) year-over-year growth rates. Format as a professional report with totals and percentages.",
        "scenario": "Converting raw sales data into executive summary"
      },
      {
        "title": "Update Monthly Template",
        "prompt": "Update monthly_report_template.xlsx with new data from data.csv. Preserve all existing formulas and formatting. The template has formulas in columns E-H that should recalculate automatically.",
        "scenario": "Refreshing a recurring monthly report"
      },
      {
        "title": "Validate Spreadsheet Quality",
        "prompt": "Check financial_model.xlsx for any formula errors. Report all instances of #REF!, #DIV/0!, and other errors with their exact locations. The file should have zero errors before I send to the board.",
        "scenario": "Pre-distribution quality check"
      }
    ],
    "output_examples": [
      {
        "input": "Create a simple budget tracker with categories for Rent ($2000), Groceries (formula: 15% of income), and Savings (formula: income minus expenses)",
        "output": "Creates budget.xlsx with:\n- A1: 'Monthly Income', B1: 5000 (blue text)\n- A2: 'Rent', B2: 2000 (blue text)\n- A3: 'Groceries', B3: =B1*0.15 (black text)\n- A4: 'Total Expenses', B4: =SUM(B2:B3) (black text)\n- A5: 'Savings', B5: =B1-B4 (black text)\nThen recalculates formulas and verifies zero errors."
      },
      {
        "input": "python recalc.py financial_model.xlsx",
        "output": "{\n  \"status\": \"errors_found\",\n  \"total_errors\": 3,\n  \"total_formulas\": 156,\n  \"error_summary\": {\n    \"#REF!\": {\n      \"count\": 2,\n      \"locations\": [\"Income Statement!D15\", \"Cash Flow!B23\"]\n    },\n    \"#DIV/0!\": {\n      \"count\": 1,\n      \"locations\": [\"Ratios!C8\"]\n    }\n  }\n}"
      }
    ],
    "best_practices": [
      "Always use Excel formulas instead of hardcoding calculated values to maintain spreadsheet dynamism",
      "Run recalc.py after creating/modifying files with formulas to ensure all values are calculated",
      "Verify zero formula errors before distributing Excel files to stakeholders",
      "For financial models: use blue for inputs, black for formulas, green for cross-sheet references",
      "Place all assumptions in separate cells and reference them in formulas (never hardcode values like growth rates)",
      "Test formulas on 2-3 sample cells before applying to entire columns",
      "Document data sources for hardcoded values with comments including source, date, and URL",
      "Use openpyxl for formula and formatting work; use pandas for data analysis and bulk operations",
      "Never open with data_only=True and save, as this permanently converts formulas to values",
      "Format zeros as dashes using custom number format: $#,##0;($#,##0);-"
    ],
    "anti_patterns": [
      "Calculating values in Python and hardcoding results instead of using Excel formulas (e.g., sheet['B10'] = 5000 instead of '=SUM(B2:B9)')",
      "Opening with data_only=True and then saving, which destroys all formulas",
      "Not running recalc.py after creating files with formulas, leaving cells empty",
      "Hardcoding assumption values directly in formulas (=B5*1.05) instead of referencing assumption cells",
      "Ignoring formula errors and distributing files with #REF!, #DIV/0!, etc.",
      "Imposing standardized formatting on existing templates with established conventions",
      "Using verbose Python code with excessive comments for simple Excel operations",
      "Forgetting that Excel is 1-indexed while pandas DataFrames are 0-indexed"
    ],
    "faq": [
      {
        "question": "Why are my formula cells empty after creating an Excel file?",
        "answer": "Excel files created with openpyxl contain formulas as strings but not calculated values. You must run 'python recalc.py yourfile.xlsx' to calculate the formula results using LibreOffice."
      },
      {
        "question": "Do I need to install LibreOffice separately?",
        "answer": "The skill assumes LibreOffice is already installed. The recalc.py script automatically configures the necessary macro on first run, but LibreOffice itself must be available on your system."
      },
      {
        "question": "What happens if I open a file with data_only=True and save it?",
        "answer": "All formulas will be permanently replaced with their calculated values. Only use data_only=True for reading values, never for editing and saving files where you want to preserve formulas."
      },
      {
        "question": "How do I know if my Excel file has formula errors?",
        "answer": "Run 'python recalc.py yourfile.xlsx' and check the JSON output. If status is 'errors_found', the error_summary will show all error types (#REF!, #DIV/0!, etc.) with exact cell locations."
      },
      {
        "question": "Should I use pandas or openpyxl?",
        "answer": "Use pandas for data analysis, reading data, and bulk operations. Use openpyxl when you need Excel-specific features like formulas, cell formatting, colors, or precise control over spreadsheet structure."
      },
      {
        "question": "What's the difference between blue and black text in financial models?",
        "answer": "Blue text indicates hardcoded inputs that users can change (e.g., assumptions, scenarios). Black text is for formulas and calculated values. This is an industry-standard convention that helps users quickly identify which cells they can modify."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "Python 3.x",
        "openpyxl library (pip install openpyxl)",
        "pandas library (pip install pandas)",
        "LibreOffice (for formula recalculation)",
        "timeout/gtimeout command (Linux/macOS, for recalc.py timeout handling)"
      ],
      "permissions": [
        "File system read/write access for .xlsx, .csv, .tsv files",
        "Execute LibreOffice in headless mode for formula recalculation",
        "Write to LibreOffice config directory for macro setup (~/.config/libreoffice or ~/Library/Application Support/LibreOffice)"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "recalc.py",
      "type": "file",
      "path": "recalc.py"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}