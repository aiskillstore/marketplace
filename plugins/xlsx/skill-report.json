{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2025-12-30T13:25:41.729Z",
    "slug": "xlsx",
    "source_url": "https://github.com/anthropics/skills/tree/main/skills/xlsx",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "trust_level": "official"
  },
  "skill": {
    "name": "xlsx",
    "description": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv, etc) for: (1) Creating new spreadsheets with formulas and formatting, (2) Reading or analyzing data, (3) Modify existing spreadsheets while preserving formulas, (4) Data analysis and visualization in spreadsheets, or (5) Recalculating formulas",
    "summary": "Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, dat...",
    "icon": "ðŸ“Š",
    "version": "1.0.0",
    "author": "Anthropic",
    "license": "Proprietary. LICENSE.txt has complete terms",
    "category": "data",
    "tags": [
      "excel",
      "spreadsheet",
      "formulas",
      "data-analysis",
      "financial-modeling",
      "pandas",
      "openpyxl",
      "libreoffice",
      "csv"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Official Anthropic skill with no security concerns. Uses LibreOffice for formula recalculation via subprocess with proper timeout handling. No network calls, file operations are local only.",
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Subprocess execution with user-provided file path",
        "description": "The recalc.py script passes user-provided file paths to subprocess commands. However, this is safe as it only processes local Excel files and uses absolute path resolution.",
        "locations": [
          {
            "file": "recalc.py",
            "line_start": 69,
            "line_end": 93
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 3,
    "total_lines": 498,
    "audit_model": "claude",
    "audited_at": "2025-12-30T13:25:41.729Z"
  },
  "content": {
    "user_title": "Excel & Spreadsheet Master",
    "value_statement": "Create, analyze, and edit professional Excel spreadsheets with formulas, formatting, and data analysisâ€”guaranteed zero formula errors.",
    "seo_keywords": [
      "excel formulas",
      "spreadsheet creation",
      "financial modeling",
      "data analysis pandas",
      "xlsx editing",
      "openpyxl",
      "spreadsheet automation",
      "formula recalculation",
      "excel formatting",
      "data visualization"
    ],
    "actual_capabilities": [
      "Create new Excel files with formulas and professional formatting",
      "Edit existing spreadsheets while preserving formulas and styles",
      "Analyze data using pandas for statistics and insights",
      "Build financial models with industry-standard color coding",
      "Recalculate all formulas and detect errors automatically",
      "Apply professional number formatting (currency, percentages, negatives)",
      "Handle multiple sheets and complex cross-sheet references",
      "Insert/delete rows and columns programmatically",
      "Read and write CSV, TSV, and Excel formats",
      "Generate data visualizations within spreadsheets"
    ],
    "limitations": [
      "Requires LibreOffice installed for formula recalculation",
      "Formula recalculation has timeout limits (default 30 seconds)",
      "Cannot execute VBA macros or advanced Excel features",
      "Large files may require read_only or write_only mode for performance",
      "Data-only mode permanently removes formulas if saved"
    ],
    "use_cases": [
      {
        "title": "Financial Model Building",
        "description": "Create DCF models, LBO analyses, or budget forecasts with industry-standard formatting, color-coded inputs, and documented assumptions. Ensures zero formula errors with automatic validation.",
        "target_user": "Financial analysts, investment bankers, CFOs"
      },
      {
        "title": "Data Analysis & Reporting",
        "description": "Analyze large datasets with pandas, generate summary statistics, create pivot-style reports, and export results to formatted Excel files with charts and conditional formatting.",
        "target_user": "Data analysts, business intelligence professionals, researchers"
      },
      {
        "title": "Template Modification",
        "description": "Update existing Excel templates with new data while preserving all formulas, formatting, and structure. Perfect for recurring reports that need data refreshes.",
        "target_user": "Operations teams, accountants, report managers"
      },
      {
        "title": "Automated Report Generation",
        "description": "Transform raw data into professional Excel reports with calculations, summaries, and formattingâ€”all generated programmatically with formulas that users can modify.",
        "target_user": "Developers, automation engineers, business analysts"
      }
    ],
    "prompt_templates": [
      {
        "title": "Create Financial Model",
        "prompt": "Create a 5-year revenue forecast model in Excel with the following assumptions: starting revenue of $10M, growth rates of 15%, 12%, 10%, 8%, 8%. Include COGS at 60% of revenue and operating expenses at 25%. Use industry-standard blue for inputs, black for formulas, and format currency as $mm.",
        "scenario": "Building a financial projection model with proper formatting"
      },
      {
        "title": "Analyze CSV Data",
        "prompt": "Analyze the sales data in sales.csv and create an Excel report showing: (1) monthly revenue totals, (2) top 10 products by revenue, (3) growth rates month-over-month, and (4) summary statistics. Include charts for visual analysis.",
        "scenario": "Converting raw data into an analytical report"
      },
      {
        "title": "Update Existing Template",
        "prompt": "Update the Q4_Report_Template.xlsx with new sales data from current_quarter.csv. Preserve all existing formulas and formatting. Add the new data starting at row 15 and ensure all summary calculations update automatically.",
        "scenario": "Refreshing a recurring report template"
      },
      {
        "title": "Fix Formula Errors",
        "prompt": "Check my budget_model.xlsx for any formula errors. If you find #REF!, #DIV/0!, or other errors, identify their locations and fix them. Recalculate all formulas and verify the file has zero errors.",
        "scenario": "Debugging and validating an existing spreadsheet"
      }
    ],
    "output_examples": [
      {
        "input": "Create a simple P&L with revenue of $1M and COGS of 40%",
        "output": "Excel file with:\n- A1: 'Revenue' (bold), B1: $1,000,000 (blue text)\n- A2: 'COGS' (bold), B2: =B1*0.4 (black text, formatted as currency)\n- A3: 'Gross Profit' (bold), B3: =B1-B2 (black text)\n- All formulas recalculated with zero errors\n- Professional number formatting with commas and $ signs"
      },
      {
        "input": "Analyze customer_data.xlsx and show me top customers by revenue",
        "output": "Analysis report showing:\n- Total customers: 1,247\n- Total revenue: $5.2M\n- Top 10 customers table sorted by revenue\n- Average order value: $4,167\n- Excel file with formatted summary and formulas for dynamic updates"
      }
    ],
    "best_practices": [
      "Always use Excel formulas instead of hardcoding calculated values in Python",
      "Run recalc.py after creating/modifying files with formulas to ensure they calculate correctly",
      "Place all assumptions in separate cells and reference them in formulas",
      "Use industry-standard color coding: blue for inputs, black for formulas, green for internal links",
      "Format currency with unit labels in headers (e.g., 'Revenue ($mm)')",
      "Test formulas on 2-3 sample cells before applying to entire ranges",
      "Document sources for all hardcoded values with specific references",
      "Use load_workbook without data_only=True to preserve formulas when editing",
      "Check for edge cases: zeros, negatives, null values that could cause errors",
      "Verify column mappings carefully (Excel columns use letters, pandas uses indices)"
    ],
    "anti_patterns": [
      "Calculating values in Python and hardcoding them instead of using Excel formulas",
      "Opening files with data_only=True and then saving (destroys all formulas)",
      "Not running recalc.py after creating files with formulas",
      "Hardcoding values like =B5*1.05 instead of referencing assumption cells",
      "Forgetting that Excel uses 1-based indexing while pandas uses 0-based",
      "Imposing new formatting on existing templates instead of matching their style",
      "Using verbose Python code with excessive comments for simple operations",
      "Not verifying formula references before building full models",
      "Ignoring the error summary from recalc.py when status is 'errors_found'",
      "Adding formula error handling in Python instead of preventing errors in Excel"
    ],
    "faq": [
      {
        "question": "Do I need to install LibreOffice to use this skill?",
        "answer": "Yes, LibreOffice is required for formula recalculation. The recalc.py script automatically configures the necessary macro on first run. Without it, formulas will be stored as text but not calculated."
      },
      {
        "question": "What's the difference between pandas and openpyxl for working with Excel?",
        "answer": "Use pandas for data analysis, statistics, and bulk data operations. Use openpyxl when you need formulas, complex formatting, or Excel-specific features. Pandas is faster for large datasets, while openpyxl gives precise control over Excel elements."
      },
      {
        "question": "Why do I get formula errors like #REF! or #DIV/0!?",
        "answer": "Common causes: incorrect cell references (check column mapping and row offsets), division by cells containing zero, or referencing deleted cells. Run recalc.py to get detailed error locations, then verify your formula references match the actual data structure."
      },
      {
        "question": "How do I preserve formulas when editing existing files?",
        "answer": "Load files with load_workbook('file.xlsx') without data_only=True. Make your changes, save the file, then run recalc.py to update calculated values. Never save a file that was opened with data_only=True."
      },
      {
        "question": "What does the recalc.py JSON output mean?",
        "answer": "The script returns: 'status' (success/errors_found), 'total_errors' (count of Excel errors), 'total_formulas' (formula count), and 'error_summary' (breakdown by error type with up to 20 locations per type). If status is 'errors_found', fix the listed locations and recalculate."
      },
      {
        "question": "Can this handle financial modeling with proper formatting?",
        "answer": "Yes, the skill includes comprehensive financial modeling guidelines with industry-standard color coding (blue for inputs, black for formulas), professional number formatting, and requirements for zero formula errorsâ€”essential for investment banking and corporate finance work."
      }
    ],
    "technical_requirements": {
      "dependencies": [
        "Python 3.x",
        "openpyxl library",
        "pandas library",
        "LibreOffice (for formula recalculation)"
      ],
      "permissions": [
        "File system read/write access for Excel files",
        "Subprocess execution for LibreOffice commands"
      ],
      "complexity": "intermediate"
    }
  },
  "file_structure": [
    {
      "name": "LICENSE.txt",
      "type": "file",
      "path": "LICENSE.txt"
    },
    {
      "name": "recalc.py",
      "type": "file",
      "path": "recalc.py"
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}