{
  "skill": {
    "name": "SQLAlchemy 2.0+",
    "description": "Modern async ORM with type-safe models and efficient queries for building database backends, APIs, and data services with async support.",
    "summary": "Build type-safe async database operations with SQLAlchemy 2.0 ORM patterns and examples.",
    "icon": "üóÑÔ∏è",
    "version": "1.0.0",
    "author": "bossjones",
    "license": "MIT",
    "category": "data",
    "tags": ["sqlalchemy", "orm", "async", "database", "python"],
    "supported_tools": ["claude", "codex", "claude-code"]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This skill is a markdown documentation file containing SQLAlchemy 2.0 ORM examples. The static analyzer flagged 55 potential issues, but all are false positives. The scanner misinterpreted markdown code block backticks as shell execution, ORDER BY descending sorts (.desc()) as weak crypto, and standard SQL queries as reconnaissance. This is documentation-only content with no executable code.",
    "static_findings_evaluation": [
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:13",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 13 contains the opening ```python markdown code fence. Backticks in markdown denote code blocks, not shell execution. This is standard documentation syntax."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:35",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 35 contains the closing ``` markdown code fence. Backticks in markdown denote code blocks, not shell execution."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:39",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 39 contains the opening ```python markdown code fence for a new code block containing Python async function examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:60",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 60 contains the closing ``` markdown code fence. Backticks in markdown denote code blocks."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:68",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 68 contains the opening ```python markdown code fence for annotated type-safe model examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:89",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 89 contains the closing ``` markdown code fence for the annotated models code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:93",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 93 contains the opening ```python markdown code fence for classic style model examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:103",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 103 contains the closing ``` markdown code fence."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:109",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 109 contains the opening ```python markdown code fence for one-to-many relationship examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:125",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 125 contains the closing ``` markdown code fence for the relationships code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:129",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 129 contains the opening ```python markdown code fence for many-to-many relationship examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:155",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 155 contains the closing ``` markdown code fence for the many-to-many code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:161",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 161 contains the opening ```python markdown code fence for query examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:193",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 193 contains the closing ``` markdown code fence for the basic select queries code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:197",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 197 contains the opening ```python markdown code fence for relationship loading examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:216",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 216 contains the closing ``` markdown code fence for the relationship loading code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:220",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 220 contains the opening ```python markdown code fence for pagination examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:227",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 227 contains the closing ``` markdown code fence for the pagination code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:231",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 231 contains the opening ```python markdown code fence for aggregation examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:244",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 244 contains the closing ``` markdown code fence for the aggregations code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:250",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 250 contains the opening ```python markdown code fence for context manager pattern examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:257",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 257 contains the closing ``` markdown code fence."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:261",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 261 contains the opening ```python markdown code fence for FastAPI dependency injection examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:280",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 280 contains the closing ``` markdown code fence for the dependency injection code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:284",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 284 contains the opening ```python markdown code fence for scoped sessions examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:299",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 299 contains the closing ``` markdown code fence for the scoped sessions code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:305",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 305 contains the opening ```python markdown code fence for write-only relationship examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:323",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 323 contains the closing ``` markdown code fence for the write-only relationships code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:327",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 327 contains the opening ```python markdown code fence for custom session class examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:339",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 339 contains the closing ``` markdown code fence for the custom sessions code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:343",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 343 contains the opening ```python markdown code fence for connection routing examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:352",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 352 contains the closing ``` markdown code fence for the connection routing code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:356",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 356 contains the opening ```python markdown code fence for raw SQL examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:370",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 370 contains the closing ``` markdown code fence for the raw SQL code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:375",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 375 contains the opening ```python markdown code fence for streaming large results examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:378",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 378 contains text within the streaming code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:380",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 380 contains text within the streaming code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:388",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 388 contains the closing ``` markdown code fence for the streaming code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:392",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 392 contains the opening ```bash markdown code fence for requirements installation."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:399",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 399 contains the closing ``` markdown code fence for the requirements code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:403",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 403 contains text listing database URL formats, not executable code."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:404",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 404 contains the opening ```python markdown code fence for migration integration examples."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:405",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 405 contains text within the migration code block."
      },
      {
        "finding": "external_commands: Ruby/shell backtick execution at SKILL.md:411",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 411 contains the opening ```python markdown code fence for Alembic migration examples."
      },
      {
        "finding": "sensitive: SQLite database file at SKILL.md:404",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 404 documents the SQLite connection string format: sqlite+aiosqlite:///database.db. This is standard documentation about database configuration, not sensitive data exposure."
      },
      {
        "finding": "blocker: Weak cryptographic algorithm at SKILL.md:3",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 3 is the YAML frontmatter description field containing plain text about ORM features. No cryptographic algorithm is present."
      },
      {
        "finding": "blocker: Weak cryptographic algorithm at SKILL.md:224",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 224 contains .order_by(Post.created.desc()) which is a SQL ORDER BY clause using DESC (descending) for sorting query results. This is not cryptographic code."
      },
      {
        "finding": "blocker: Weak cryptographic algorithm at SKILL.md:240",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 240 contains .order_by(func.count(Post.id).desc()) which is a SQL ORDER BY clause using DESC (descending) to sort aggregation results. Not cryptographic code."
      },
      {
        "finding": "blocker: System reconnaissance at SKILL.md:50",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 50 contains await session.execute(select(User).where(User.id == user_id)) which is a standard database SELECT query with WHERE clause. Normal ORM operation, not reconnaissance."
      },
      {
        "finding": "blocker: System reconnaissance at SKILL.md:56",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 56 contains update(User).where(User.id == user_id).values(email=new_email) which is a standard SQL UPDATE query. Normal database operation."
      },
      {
        "finding": "blocker: System reconnaissance at SKILL.md:97",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 97 contains mapped_column(Integer, primary_key=True) which defines a database column. Normal ORM model definition."
      },
      {
        "finding": "blocker: System reconnaissance at SKILL.md:100",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 100 contains mapped_column(ForeignKey(\"users.id\")) which defines a foreign key relationship. Normal ORM model definition."
      },
      {
        "finding": "blocker: System reconnaissance at SKILL.md:213",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 213 contains .where(Post.id == post_id) which is a standard SQL WHERE clause. Normal query filtering."
      },
      {
        "finding": "blocker: System reconnaissance at SKILL.md:319",
        "verdict": "false_positive",
        "confidence": "high",
        "reasoning": "Line 319 contains .where(Post.author_id == user_id) which is a standard SQL WHERE clause for filtering posts by author. Normal query."
      }
    ],
    "risk_factor_evidence": [],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 418
  },
  "content": {
    "user_title": "Build async database operations with SQLAlchemy 2.0",
    "value_statement": "This skill provides ready-to-use SQLAlchemy 2.0+ patterns for async database operations. It includes type-safe models, CRUD operations, relationships, and performance optimizations for building robust data services.",
    "seo_keywords": [
      "sqlalchemy",
      "sqlalchemy 2.0",
      "async orm",
      "python database",
      "type-safe models",
      "async python",
      "claude code",
      "claude",
      "codex",
      "fastapi database"
    ],
    "actual_capabilities": [
      "Create async engine and session configuration for PostgreSQL, SQLite, and MySQL",
      "Define type-safe SQLAlchemy models with annotated column types",
      "Implement CRUD operations with async/await patterns",
      "Configure one-to-many and many-to-many relationships with cascade options",
      "Use selectinload and joinedload for efficient relationship loading",
      "Integrate with FastAPI using dependency injection for session management"
    ],
    "limitations": [
      "Does not include database migration setup (see Alembic skill for migrations)",
      "Does not provide connection pooling configuration examples",
      "Does not cover raw SQL migration strategies or schema management",
      "Does not include transaction retry logic or error handling patterns"
    ],
    "use_cases": [
      {
        "target_user": "Backend Python developers",
        "title": "Build async API backends",
        "description": "Create FastAPI endpoints with async SQLAlchemy sessions for high-concurrency web services."
      },
      {
        "target_user": "Data engineers",
        "title": "Design type-safe data models",
        "description": "Define validated ORM models with annotated columns for consistent database schemas."
      },
      {
        "target_user": "Full-stack developers",
        "title": "Optimize database queries",
        "description": "Use eager loading and streaming patterns to reduce N+1 queries and memory usage."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic model setup",
        "scenario": "Setting up async SQLAlchemy",
        "prompt": "Show me how to create an async SQLAlchemy 2.0 engine and session factory for PostgreSQL with a User model that has id, name, and email fields."
      },
      {
        "title": "Relationship queries",
        "scenario": "Fetching related data",
        "prompt": "Write a function that fetches a User with all their Posts loaded, using selectinload to avoid N+1 queries."
      },
      {
        "title": "FastAPI integration",
        "scenario": "Adding database to API",
        "prompt": "Create a FastAPI dependency that provides an async SQLAlchemy session, properly handling cleanup with try/finally."
      },
      {
        "title": "Custom session routing",
        "scenario": "Read-write splitting",
        "prompt": "Implement a custom AsyncRoutingSession that routes read-only models to a read replica database."
      }
    ],
    "output_examples": [
      {
        "input": "Create a User model with posts relationship and a function to get all users",
        "output": [
          "User model with posts relationship defined using List[Post] with cascade delete",
          "get_all_users() async function using session.execute(select(User))",
          "Result parsing with scalars().all() for efficient object loading"
        ]
      }
    ],
    "best_practices": [
      "Use expire_on_commit=False to avoid unnecessary reloads after commits",
      "Prefer selectinload over lazy loading for collections to prevent N+1 queries",
      "Always close sessions properly using async with context managers"
    ],
    "anti_patterns": [
      "Avoid lazy loading in async contexts as it can cause connection leaks",
      "Do not use sync sessions with async engines as this blocks the event loop",
      "Avoid committing transactions inside nested context managers without proper scoping"
    ],
    "faq": [
      {
        "question": "What databases support async SQLAlchemy?",
        "answer": "PostgreSQL with asyncpg, SQLite with aiosqlite, and MySQL with aiomysql are fully supported async drivers."
      },
      {
        "question": "How do I prevent N+1 queries with relationships?",
        "answer": "Use selectinload() or joinedload() in your query options to eagerly load related data in a single query."
      },
      {
        "question": "What is the difference between classic and annotated models?",
        "answer": "Annotated models use Python type hints with mapped_column for better IDE support and type checking."
      },
      {
        "question": "How do I handle sessions in FastAPI dependencies?",
        "answer": "Create an async generator function that yields the session and closes it in a finally block."
      },
      {
        "question": "Can I use raw SQL with async SQLAlchemy?",
        "answer": "Yes, use sqlalchemy.text() to execute raw SQL with proper parameterized queries for security."
      },
      {
        "question": "How do I stream large result sets?",
        "answer": "Use session.stream(select(Model)) and iterate with async for to process records without loading all into memory."
      }
    ]
  }
}
